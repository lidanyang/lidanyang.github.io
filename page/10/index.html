<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/09/749-Contain-Virus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/09/749-Contain-Virus/" itemprop="url">749. Contain Virus</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-09T22:57:00+08:00">2020-02-09</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-09T22:59:35+08:00">2020-02-09</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="749-contain-virus"><a class="header-anchor" href="#749-contain-virus">¶</a><a href="https://leetcode.com/problems/contain-virus/" target="_blank" rel="noopener">749. Contain Virus</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>A virus is spreading rapidly, and your task is to quarantine the infected area by installing walls.</p>
<p>The world is modeled as a 2-D array of cells, where <code>0</code> represents uninfected cells, and <code>1</code> represents cells contaminated with the virus. A wall (and only one wall) can be installed <strong>between any two 4-directionally adjacent cells</strong>, on the shared boundary.</p>
<p>Every night, the virus spreads to all neighboring cells in all four directions unless blocked by a wall. Resources are limited. Each day, you can install walls around only one region – the affected area (continuous block of infected cells) that threatens the most uninfected cells the following night. There will never be a tie.</p>
<p>Can you save the day? If so, what is the number of walls required? If not, and the world becomes fully infected, return the number of walls used.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Input: grid = </span><br><span class="line">[[0,1,0,0,0,0,0,1],</span><br><span class="line"> [0,1,0,0,0,0,0,1],</span><br><span class="line"> [0,0,0,0,0,0,0,1],</span><br><span class="line"> [0,0,0,0,0,0,0,0]]</span><br><span class="line">Output: 10</span><br><span class="line">Explanation:</span><br><span class="line">There are 2 contaminated regions.</span><br><span class="line">On the first day, add 5 walls to quarantine the viral region on the left. The board after the virus spreads is:</span><br><span class="line"></span><br><span class="line">[[0,1,0,0,0,0,1,1],</span><br><span class="line"> [0,1,0,0,0,0,1,1],</span><br><span class="line"> [0,0,0,0,0,0,1,1],</span><br><span class="line"> [0,0,0,0,0,0,0,1]]</span><br><span class="line"></span><br><span class="line">On the second day, add 5 walls to quarantine the viral region on the right. The virus is fully contained.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: grid = </span><br><span class="line">[[1,1,1],</span><br><span class="line"> [1,0,1],</span><br><span class="line"> [1,1,1]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: Even though there is only one cell saved, there are 4 walls built.</span><br><span class="line">Notice that walls are only built on the shared boundary of two different cells.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Input: grid = </span><br><span class="line">[[1,1,1,0,0,0,0,0,0],</span><br><span class="line"> [1,0,1,0,1,1,1,1,1],</span><br><span class="line"> [1,1,1,0,0,0,0,0,0]]</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: The region on the left only builds two new walls.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The number of rows and columns of <code>grid</code> will each be in the range <code>[1, 50]</code>.</li>
<li>Each <code>grid[i][j]</code> will be either <code>0</code> or <code>1</code>.</li>
<li>Throughout the described process, there is always a contiguous viral region that will infect <strong>strictly more</strong> uncontaminated squares in the next round.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-4ms"><a class="header-anchor" href="#法一-4ms">¶</a>法一 4ms</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> m, n;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; grid, infected_grid;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">containVirus</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;grid = grid, <span class="keyword">this</span>-&gt;infected_grid = grid;</span><br><span class="line">        <span class="keyword">this</span>-&gt;m = grid.size(), <span class="keyword">this</span>-&gt;n = grid.back().size();</span><br><span class="line">        <span class="keyword">while</span> (build_wall());</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> k, <span class="keyword">int</span>&amp; wall)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= m || j &lt; <span class="number">0</span> || j &gt;= n || grid[i][j] &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (grid[i][j] == k) &#123;</span><br><span class="line">            <span class="keyword">if</span> (infected_grid[i][j] &gt; <span class="number">0</span>) wall++; <span class="comment">// only build wall on boundary</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (grid[i][j] == <span class="number">1</span>) &#123;</span><br><span class="line">            grid[i][j] = k; <span class="comment">// grid[i][j] = 1 -&gt; k, not boundary, don't build wall</span></span><br><span class="line">            <span class="keyword">return</span> dfs(i+<span class="number">1</span>, j, k, wall) + dfs(i, j+<span class="number">1</span>, k, wall) + dfs(i<span class="number">-1</span>, j, k, wall) + dfs(i, j<span class="number">-1</span>, k, wall);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        grid[i][j] = k; <span class="comment">// grid[i][j] = 0 -&gt; k</span></span><br><span class="line">        infected_grid[i][j]++; <span class="comment">// record the boundary</span></span><br><span class="line">        wall++; <span class="comment">// only build wall on boundary</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">build_wall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">1</span>, max_infected = <span class="number">-1</span>, K = <span class="number">0</span>, add_wall = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; r : infected_grid) <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; val : r) val = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// tentatively flood for each 1 tile, and pick the would-be greatest affector</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) <span class="keyword">if</span> (grid[i][j] == <span class="number">1</span>) </span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">auto</span> wall = <span class="number">0</span>, infected = dfs(i, j, ++k, wall); max_infected &lt; infected) </span><br><span class="line">                max_infected = infected, add_wall = wall, K = k;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// no directly contacted area, stop</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// actually add the wall (set area to -1)</span></span><br><span class="line">        res += add_wall;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) <span class="keyword">if</span> (grid[i][j] &gt; <span class="number">0</span>) </span><br><span class="line">            grid[i][j] = (grid[i][j] == K &amp;&amp; infected_grid[i][j] &lt;= <span class="number">1</span>) ? infected_grid[i][j] - <span class="number">1</span> : <span class="number">1</span>; </span><br><span class="line">            <span class="comment">// set quarantined area as infected_grid[i][j]-1, else where as 1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-16ms"><a class="header-anchor" href="#法二-16ms">¶</a>法二 16ms</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> m, n, id, ans, mx_id, mx;</span><br><span class="line">    <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; vp&#123;&#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span> , <span class="number">0</span>&#125;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid, <span class="keyword">int</span> i, <span class="keyword">int</span> j, <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; <span class="number">0</span> || i &gt;= m|| j&lt; <span class="number">0</span>|| j&gt;= n|| grid[i][j] &lt;= <span class="number">0</span>|| grid[i][j] == id) <span class="keyword">return</span>;</span><br><span class="line">        grid[i][j] = id;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; vp.size(); ++k) dfs(grid, i + vp[k].first, j + vp[k].second, id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;n ; ++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(grid[i][j] == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt;&gt; border;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; wc;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">spread</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span></span>&#123;</span><br><span class="line">        id = <span class="number">2</span>, mx_id = <span class="number">-1</span>, mx = <span class="number">0</span>;</span><br><span class="line">        wc.clear();</span><br><span class="line">        border.clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;n ; ++j) <span class="keyword">if</span>(grid[i][j] == <span class="number">1</span>) dfs(grid, i, j, id++);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;n ; ++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(grid[i][j] == <span class="number">0</span>)&#123; </span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; vp.size(); ++k)&#123;</span><br><span class="line">                        <span class="keyword">int</span> ni = i + vp[k].first, nj = j + vp[k].second;</span><br><span class="line">                        <span class="keyword">if</span>(!(ni &lt; <span class="number">0</span> ||ni &gt;= m|| nj&lt; <span class="number">0</span>|| nj&gt;= n) &amp;&amp; grid[ni][nj] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                            wc[grid[ni][nj]]++;</span><br><span class="line">                            border[grid[ni][nj]].insert(i * <span class="number">51</span> + j);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : border) <span class="keyword">if</span>(x.second.size() &gt; mx) &#123; mx_id = x.first; mx = x.second.size(); &#125;</span><br><span class="line">        border.erase(mx_id);</span><br><span class="line">        ans += wc[mx_id];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x: border)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;y : x.second)&#123;</span><br><span class="line">                grid[y/<span class="number">51</span>][y%<span class="number">51</span>] = x.first;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(grid[i][j] == mx_id) grid[i][j] = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(grid[i][j] &gt; <span class="number">0</span>) grid[i][j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">containVirus</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        m = grid.size(), n= grid[<span class="number">0</span>].size(), ans = <span class="number">0</span>;</span><br><span class="line">        spread(grid);</span><br><span class="line">        <span class="keyword">while</span>(!check(grid) &amp;&amp; wc.size()&gt;<span class="number">1</span>) spread(grid);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-官方题解"><a class="header-anchor" href="#法三-官方题解">¶</a>法三 官方题解</h6>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    Set&lt;Integer&gt; seen;</span><br><span class="line">    List&lt;Set&lt;Integer&gt;&gt; regions;</span><br><span class="line">    List&lt;Set&lt;Integer&gt;&gt; frontiers;</span><br><span class="line">    List&lt;Integer&gt; perimeters;</span><br><span class="line">    <span class="keyword">int</span>[][] grid;</span><br><span class="line">    <span class="keyword">int</span> R, C;</span><br><span class="line">    <span class="keyword">int</span>[] dr = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span>[] dc = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">containVirus</span><span class="params">(<span class="keyword">int</span>[][] grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grid = grid;</span><br><span class="line">        R = grid.length;</span><br><span class="line">        C = grid[<span class="number">0</span>].length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            seen = <span class="keyword">new</span> HashSet();</span><br><span class="line">            regions = <span class="keyword">new</span> ArrayList();</span><br><span class="line">            frontiers = <span class="keyword">new</span> ArrayList();</span><br><span class="line">            perimeters = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; R; ++r) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; C; ++c) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (grid[r][c] == <span class="number">1</span> &amp;&amp; !seen.contains(r*C + c)) &#123;</span><br><span class="line">                        regions.add(<span class="keyword">new</span> HashSet());</span><br><span class="line">                        frontiers.add(<span class="keyword">new</span> HashSet());</span><br><span class="line">                        perimeters.add(<span class="number">0</span>);</span><br><span class="line">                        dfs(r, c);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (regions.isEmpty()) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">int</span> triageIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; frontiers.size(); ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (frontiers.get(triageIndex).size() &lt; frontiers.get(i).size())</span><br><span class="line">                    triageIndex = i;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += perimeters.get(triageIndex);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; regions.size(); ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == triageIndex) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> code: regions.get(i))</span><br><span class="line">                        grid[code / C][code % C] = -<span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> code: regions.get(i)) &#123;</span><br><span class="line">                        <span class="keyword">int</span> r = code / C, c = code % C;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">                            <span class="keyword">int</span> nr = r + dr[k], nc = c + dc[k];</span><br><span class="line">                            <span class="keyword">if</span> (nr &gt;= <span class="number">0</span> &amp;&amp; nr &lt; R &amp;&amp; nc &gt;= <span class="number">0</span> &amp;&amp; nc &lt; C &amp;&amp; grid[nr][nc] == <span class="number">0</span>)</span><br><span class="line">                                grid[nr][nc] = <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!seen.contains(r*C + c)) &#123;</span><br><span class="line">            seen.add(r*C + c);</span><br><span class="line">            <span class="keyword">int</span> N = regions.size()</span><br><span class="line">            regions.get(N - <span class="number">1</span>).add(r*C + c);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">                <span class="keyword">int</span> nr = r + dr[k], nc = c + dc[k];</span><br><span class="line">                <span class="keyword">if</span> (nr &gt;= <span class="number">0</span> &amp;&amp; nr &lt; R &amp;&amp; nc &gt;= <span class="number">0</span> &amp;&amp; nc &lt; C) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (grid[nr][nc] == <span class="number">1</span>) &#123;</span><br><span class="line">                        dfs(nr, nc);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (grid[nr][nc] == <span class="number">0</span>)&#123;</span><br><span class="line">                        frontiers.get(N - <span class="number">1</span>).add(nr*C + nc);</span><br><span class="line">                        perimeters.set(N - <span class="number">1</span>, perimeters.get(N - <span class="number">1</span>) + <span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/09/1349-Maximum-Students-Taking-Exam/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/09/1349-Maximum-Students-Taking-Exam/" itemprop="url">1349. Maximum Students Taking Exam</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-09T12:14:00+08:00">2020-02-09</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-09T14:04:45+08:00">2020-02-09</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1349-maximum-students-taking-exam"><a class="header-anchor" href="#1349-maximum-students-taking-exam">¶</a><a href="https://leetcode.com/problems/maximum-students-taking-exam/" target="_blank" rel="noopener">1349. Maximum Students Taking Exam</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a <code>m * n</code> matrix <code>seats</code>  that represent seats distributions in a classroom. If a seat is broken, it is denoted by <code>'#'</code> character otherwise it is denoted by a <code>'.'</code> character.</p>
<p>Students can see the answers of those sitting next to the left, right, upper left and upper right, but he cannot see the answers of the student sitting directly in front or behind him. Return the <strong>maximum</strong> number of students that can take the exam together without any cheating being possible…</p>
<p>Students must be placed in seats in good condition.</p>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2020/01/29/image.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: seats = [[&quot;#&quot;,&quot;.&quot;,&quot;#&quot;,&quot;#&quot;,&quot;.&quot;,&quot;#&quot;],</span><br><span class="line">                [&quot;.&quot;,&quot;#&quot;,&quot;#&quot;,&quot;#&quot;,&quot;#&quot;,&quot;.&quot;],</span><br><span class="line">                [&quot;#&quot;,&quot;.&quot;,&quot;#&quot;,&quot;#&quot;,&quot;.&quot;,&quot;#&quot;]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: Teacher can place 4 students in available seats so they don&apos;t cheat on the exam.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: seats = [[&quot;.&quot;,&quot;#&quot;],</span><br><span class="line">                [&quot;#&quot;,&quot;#&quot;],</span><br><span class="line">                [&quot;#&quot;,&quot;.&quot;],</span><br><span class="line">                [&quot;#&quot;,&quot;#&quot;],</span><br><span class="line">                [&quot;.&quot;,&quot;#&quot;]]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: Place all students in available seats.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: seats = [[&quot;#&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;#&quot;],</span><br><span class="line">                [&quot;.&quot;,&quot;#&quot;,&quot;.&quot;,&quot;#&quot;,&quot;.&quot;],</span><br><span class="line">                [&quot;.&quot;,&quot;.&quot;,&quot;#&quot;,&quot;.&quot;,&quot;.&quot;],</span><br><span class="line">                [&quot;.&quot;,&quot;#&quot;,&quot;.&quot;,&quot;#&quot;,&quot;.&quot;],</span><br><span class="line">                [&quot;#&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;#&quot;]]</span><br><span class="line">Output: 10</span><br><span class="line">Explanation: Place students in available seats in column 1, 3 and 5.</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>seats</code> contains only characters <code>'.'&lt;font face=&quot;sans-serif, Arial, Verdana, Trebuchet MS&quot; style=&quot;display: inline;&quot;&gt; and&lt;/font&gt;``'#'.</code></li>
<li><code>m == seats.length</code></li>
<li><code>n == seats[i].length</code></li>
<li><code>1 &lt;= m &lt;= 8</code></li>
<li><code>1 &lt;= n &lt;= 8</code></li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  <code>f[i][j]中， i代表行数（此处的i是从1开始编号）， j代表该行入座情况的位图， f[i][j]代表第i行入座位图为j时已经之前行入坐的最大的学生数</code>，用<code>f[i-1][j]</code>去推每个<code>f[i-1][k]</code>即可。注意初始化是置<code>f[0][0]</code>为<code>0</code>，<code>f[0][j], j!= 0</code>为<code>-INF</code>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> o[<span class="number">256</span>],f[<span class="number">9</span>][<span class="number">256</span>],a[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//状态压缩dp</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxStudents</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt;&amp; seats)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=seats.size(),m=seats[<span class="number">0</span>].size(),i,j,k,ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">256</span>;i++)</span><br><span class="line">            o[i]=o[i&gt;&gt;<span class="number">1</span>]+(i&amp;<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">128</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;m;j++)</span><br><span class="line">                <span class="keyword">if</span>(seats[i][j]==<span class="string">'#'</span>)</span><br><span class="line">                    a[i]|=<span class="number">1</span>&lt;&lt;j;</span><br><span class="line">        <span class="keyword">for</span>(i=f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">1</span>&lt;&lt;m;j++)</span><br><span class="line">                <span class="keyword">if</span>(!(j&amp;a[i])&amp;&amp;!(j&amp;j&gt;&gt;<span class="number">1</span>)&amp;&amp;!(j&amp;j&lt;&lt;<span class="number">1</span>))</span><br><span class="line">                    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">1</span>&lt;&lt;m;k++)</span><br><span class="line">                        <span class="keyword">if</span>(!(j&amp;k&gt;&gt;<span class="number">1</span>)&amp;&amp;!(j&amp;k&lt;&lt;<span class="number">1</span>))</span><br><span class="line">                            f[i+<span class="number">1</span>][j]=max(f[i+<span class="number">1</span>][j],f[i][k]+o[j]);</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;m;i++)</span><br><span class="line">            ans=max(ans,f[n][i]);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/08/187-Make-Array-Strictly-Increasing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/08/187-Make-Array-Strictly-Increasing/" itemprop="url">1187. Make Array Strictly Increasing</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-08T23:27:00+08:00">2020-02-08</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-09T16:44:10+08:00">2020-02-09</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1187-make-array-strictly-increasing"><a class="header-anchor" href="#1187-make-array-strictly-increasing">¶</a><a href="https://leetcode.com/problems/make-array-strictly-increasing/" target="_blank" rel="noopener">1187. Make Array Strictly Increasing</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given two integer arrays <code>arr1</code> and <code>arr2</code>, return the minimum number of operations (possibly zero) needed to make <code>arr1</code> strictly increasing.</p>
<p>In one operation, you can choose two indices <code>0 &lt;= i &lt; arr1.length</code> and <code>0 &lt;= j &lt; arr2.length</code> and do the assignment <code>arr1[i] = arr2[j]</code>.</p>
<p>If there is no way to make <code>arr1</code> strictly increasing, return <code>-1</code>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr1 = [1,5,3,6,7], arr2 = [1,3,2,4]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: Replace 5 with 2, then arr1 = [1, 2, 3, 6, 7].</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr1 = [1,5,3,6,7], arr2 = [4,3,1]</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: Replace 5 with 3 and then replace 3 with 4\. arr1 = [1, 3, 4, 6, 7].</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr1 = [1,5,3,6,7], arr2 = [1,6,3,3]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: You can&apos;t make arr1 strictly increasing.</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= arr1.length, arr2.length &lt;= 2000</code></li>
<li><code>0 &lt;= arr1[i], arr2[i] &lt;= 10^9</code></li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-4ms"><a class="header-anchor" href="#法一-4ms">¶</a>法一 4ms</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">            </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;top;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(flag &amp;&amp; answer[j].val&gt;=arr1[i])&#123;</span><br><span class="line">                    <span class="keyword">if</span>(j==<span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(answer[j].next&lt;n) temp[cur_top++].<span class="built_in">set</span>(arr2[answer[j].next],answer[j].n+<span class="number">1</span>,answer[j].next+<span class="number">1</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">auto</span> it = <span class="built_in">std</span>::upper_bound(arr2.begin(),arr2.end(),arr1[i]);</span><br><span class="line">                        node x = &#123;arr1[i],answer[j<span class="number">-1</span>].n,it-arr2.begin()&#125;;</span><br><span class="line">                        <span class="keyword">while</span>(cur_top&gt;<span class="number">0</span> &amp;&amp; temp[cur_top<span class="number">-1</span>].val&gt;=x.val) cur_top--;</span><br><span class="line">                        temp[cur_top++] = x;</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">if</span>(answer[j].next&lt;n &amp;&amp; answer[j].n+<span class="number">1</span>&lt;x.n) temp[cur_top++].<span class="built_in">set</span>(arr2[answer[j].next],answer[j].n+<span class="number">1</span>,answer[j].next+<span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    flag = <span class="literal">false</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(answer[j].next&gt;=n) <span class="keyword">continue</span>;</span><br><span class="line">                    temp[cur_top++].<span class="built_in">set</span>(arr2[answer[j].next],answer[j].n+<span class="number">1</span>,answer[j].next+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">                <span class="keyword">auto</span> it = <span class="built_in">std</span>::upper_bound(arr2.begin(),arr2.end(),arr1[i]);</span><br><span class="line">                node x = &#123;arr1[i],answer[top<span class="number">-1</span>].n,it-arr2.begin()&#125;;</span><br><span class="line">                <span class="keyword">while</span>(cur_top&gt;<span class="number">0</span> &amp;&amp; temp[cur_top<span class="number">-1</span>].val&gt;=x.val) cur_top--;</span><br><span class="line">                temp[cur_top++] = x;                </span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">​</span><br><span class="line">            top = cur_top;</span><br><span class="line">            <span class="built_in">std</span>::swap(answer,temp);</span><br><span class="line">            <span class="keyword">if</span>(top==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">​</span><br><span class="line">        <span class="keyword">return</span> answer[top<span class="number">-1</span>].n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-16ms"><a class="header-anchor" href="#法二-16ms">¶</a>法二 16ms</h6>
<p>  交换的次数越多，最后一个数的最小值就越小。可以利用这个单调性维护一个类似于队列的结构。每次转移到下一个数时，要按照最小高度的大小顺序有序的求。下面代码中<code>pm</code>,<code>px</code>存放的是次数和最后数最小值的数对，存放的顺序是按次数从小到大存放，交换次数越小对应最小高度就越高，所以高度是从大到小的。<code>pm</code>,<code>px</code>的最后一个数的值是使子数组严格递增的最后一个高度能取到的最小值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">makeArrayIncreasing</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr2)</span> </span>&#123;</span><br><span class="line">        sort(arr2.begin(), arr2.end());</span><br><span class="line">        arr2.erase(unique(arr2.begin(), arr2.end()), arr2.end());</span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; vp, vp1;</span><br><span class="line">        vp.push_back(&#123;<span class="number">0</span>, <span class="number">-1</span>&#125;);</span><br><span class="line">        <span class="keyword">auto</span> itl = arr2.cbegin();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : arr1)&#123;</span><br><span class="line">            itl = upper_bound(itl, arr2.cend(), vp.back().second);</span><br><span class="line">            <span class="keyword">auto</span> itu = arr2.cend();</span><br><span class="line">            <span class="keyword">bool</span> f = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> [i ,n] : vp)&#123;</span><br><span class="line">                <span class="keyword">if</span>(f &amp;&amp; n &lt; x)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(vp1.empty()|| vp1.back().first &lt; i) vp1.push_back(&#123;i, x&#125;);</span><br><span class="line">                    <span class="keyword">else</span> vp1.back().second = x;</span><br><span class="line">                    f = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">auto</span> it = upper_bound(itl, itu, n);</span><br><span class="line">                <span class="keyword">if</span>(it != itu &amp;&amp; (*it &lt; x ||n &gt;= x)) vp1.push_back(&#123;i+<span class="number">1</span>, *it&#125;);</span><br><span class="line">                itu = it;</span><br><span class="line">            &#125;</span><br><span class="line">            swap(vp, vp1);</span><br><span class="line">            vp1.clear();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> vp.empty()?<span class="number">-1</span>:vp.front().first;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-32ms-dp"><a class="header-anchor" href="#法三-32ms-dp">¶</a>法三 32ms dp</h6>
<p>   <code>dp[i]</code>代表交换<code>i</code>次使子数组成为严格递增的最后一个数的最小值。</p>
<ol>
<li>unordered_map版</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">makeArrayIncreasing</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr2)</span> </span>&#123;</span><br><span class="line">        sort(arr2.begin(),arr2.end());</span><br><span class="line">        arr2.erase(unique(arr2.begin(), arr2.end()), arr2.end());</span><br><span class="line">        <span class="keyword">int</span> N1 = arr1.size(), N2 = arr2.size();</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">        m[<span class="number">0</span>] = arr1[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(arr2[<span class="number">0</span>] &lt; arr1[<span class="number">0</span>]) m[<span class="number">1</span>] = arr2[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr1.size(); ++i)&#123;</span><br><span class="line">            <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; m1;</span><br><span class="line">            <span class="keyword">int</span> x = arr1[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m)&#123;</span><br><span class="line">                <span class="keyword">auto</span> it = upper_bound(arr2.begin(), arr2.end(), p.second);</span><br><span class="line">                <span class="keyword">if</span>(it != arr2.end())&#123;</span><br><span class="line">                    <span class="keyword">if</span>(m1.count(p.first + <span class="number">1</span>) == <span class="number">0</span>) m1[p.first + <span class="number">1</span>] = *it;</span><br><span class="line">                    <span class="keyword">else</span> m1[p.first + <span class="number">1</span>] = min(m1[p.first + <span class="number">1</span>], *it);    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(p.second &lt; x) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(m1.count(p.first) == <span class="number">0</span>) m1[p.first] = x;</span><br><span class="line">                    <span class="keyword">else</span> m1[p.first] = min(m1[p.first], x);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            swap(m1, m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m)&#123;</span><br><span class="line">            ans = min(ans, p.first);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans == INT_MAX?<span class="number">-1</span>:ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>数组版</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">makeArrayIncreasing</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = arr1.size();</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; B(<span class="number">2</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>, INT_MAX));</span><br><span class="line">        <span class="built_in">std</span>::sort(arr2.begin(), arr2.end());</span><br><span class="line">        arr2.resize(<span class="built_in">std</span>::unique(arr2.begin(), arr2.end()) - arr2.begin());</span><br><span class="line">        </span><br><span class="line">        B[<span class="number">0</span>][<span class="number">0</span>] = arr1[<span class="number">0</span>];</span><br><span class="line">        B[<span class="number">0</span>][<span class="number">1</span>] = arr2[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> last = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> this_last = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=last; j&gt;=<span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="keyword">int</span> &amp;u = B[(i<span class="number">-1</span>)%<span class="number">2</span>][j];</span><br><span class="line">                <span class="keyword">if</span> (u == INT_MAX)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span> (u &lt; arr1[i]) &#123;</span><br><span class="line">                    B[i%<span class="number">2</span>][j] = min(B[i%<span class="number">2</span>][j], arr1[i]);</span><br><span class="line">                    this_last = max(this_last, j);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">auto</span> it = upper_bound(arr2.begin(), arr2.end(), u);</span><br><span class="line">                <span class="keyword">if</span> (it != arr2.end()) &#123;</span><br><span class="line">                    <span class="keyword">int</span> v = *it;</span><br><span class="line">                    B[i%<span class="number">2</span>][j+<span class="number">1</span>] = min(B[i%<span class="number">2</span>][j+<span class="number">1</span>], v);</span><br><span class="line">                    this_last = max(this_last, j+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                u = INT_MAX;</span><br><span class="line">            &#125;</span><br><span class="line">            last = this_last;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;=n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (B[(n<span class="number">-1</span>)%<span class="number">2</span>][j] != INT_MAX) &#123;</span><br><span class="line">                ans = j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/05/1106-Parsing-A-Boolean-Expression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/05/1106-Parsing-A-Boolean-Expression/" itemprop="url">1106. Parsing A Boolean Expression</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-05T14:07:00+08:00">2020-02-05</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-05T14:11:19+08:00">2020-02-05</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1106-parsing-a-boolean-expression"><a class="header-anchor" href="#1106-parsing-a-boolean-expression">¶</a><a href="https://leetcode.com/problems/parsing-a-boolean-expression/" target="_blank" rel="noopener">1106. Parsing A Boolean Expression</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Return the result of evaluating a given boolean <code>expression</code>, represented as a string.</p>
<p>An expression can either be:</p>
<ul>
<li><code>&quot;t&quot;</code>, evaluating to <code>True</code>;</li>
<li><code>&quot;f&quot;</code>, evaluating to <code>False</code>;</li>
<li><code>&quot;!(expr)&quot;</code>, evaluating to the logical NOT of the inner expression <code>expr</code>;</li>
<li><code>&quot;&amp;(expr1,expr2,...)&quot;</code>, evaluating to the logical AND of 2 or more inner expressions <code>expr1, expr2, ...</code>;</li>
<li><code>&quot;|(expr1,expr2,...)&quot;</code>, evaluating to the logical OR of 2 or more inner expressions <code>expr1, expr2, ...</code></li>
</ul>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: expression = &quot;!(f)&quot;</span><br><span class="line">Output: true</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: expression = &quot;|(f,t)&quot;</span><br><span class="line">Output: true</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: expression = &quot;&amp;(t,f)&quot;</span><br><span class="line">Output: false</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: expression = &quot;|(&amp;(t,f,t),!(t))&quot;</span><br><span class="line">Output: false</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= expression.length &lt;= 20000</code></li>
<li><code>expression[i]</code> consists of characters in <code>{'(', ')', '&amp;', '|', '!', 't', 'f', ','}</code>.</li>
<li><code>expression</code> is a valid expression representing a boolean, as given in the description.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>Language: <strong>C++</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">parse</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s, <span class="keyword">int</span> &amp;i)</span></span>&#123;</span><br><span class="line">        <span class="keyword">char</span> op = s[i++];</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="string">'f'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="string">'t'</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="string">'!'</span>) &#123;</span><br><span class="line">            <span class="keyword">bool</span> ans = !parse(s, ++i);</span><br><span class="line">            ++i;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> is_and = (op==<span class="string">'&amp;'</span>);</span><br><span class="line">        <span class="keyword">bool</span> ans = is_and ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">while</span>(s[i++] != <span class="string">')'</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(is_and) ans &amp;= parse(s, i);</span><br><span class="line">            <span class="keyword">else</span> ans |= parse(s, i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">parseBoolExpr</span><span class="params">(<span class="built_in">string</span> expression)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> parse(expression, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/04/761-Special-Binary-String/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/04/761-Special-Binary-String/" itemprop="url">761. Special Binary String</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-04T14:26:25+08:00">2020-02-04</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-04T15:05:23+08:00">2020-02-04</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="761-special-binary-string"><a class="header-anchor" href="#761-special-binary-string">¶</a><a href="https://leetcode.com/problems/special-binary-string/" target="_blank" rel="noopener">761. Special Binary String</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p><em>Special</em> binary strings are binary strings with the following two properties:</p>
<ul>
<li>The number of 0’s is equal to the number of 1’s.*   Every prefix of the binary string has at least as many 1’s as 0’s.</li>
</ul>
<p>Given a special string <code>S</code>, a <em>move</em> consists of choosing two consecutive, non-empty, special substrings of <code>S</code>, and swapping them. <em>(Two strings are consecutive if the last character of the first string is exactly one index before the first character of the second string.)</em></p>
<p>At the end of any number of moves, what is the lexicographically largest resulting string possible?</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: S = &quot;11011000&quot;</span><br><span class="line">Output: &quot;11100100&quot;</span><br><span class="line">Explanation:</span><br><span class="line">The strings &quot;10&quot; [occuring at S[1]] and &quot;1100&quot; [at S[3]] are swapped.</span><br><span class="line">This is the lexicographically largest string possible after some number of swaps.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>S</code> has length at most <code>50</code>.</li>
<li><code>S</code> is guaranteed to be a <em>special</em> binary string as defined above.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  把1看做上升，0看做下降，可以在二维平面画一条折线。把起终点相同且中间所有点都在它们之上这样的折线段看成是一座“山”。原题的要求可以等价于移动这些山，由于高度小的山肯定在高度较高的山上，不可能存在一个山横跨在两个山之间。所以可以先移动高度较大的山，然后在高度较大的山上移动高度较小的山。注意，原串其实也可以看作一座山。递归搬山，直到遇见不包含小山的山为止。每次递归把高度相同的山在子串内排个序返回。</p>
<p>  这个题有个技巧在于如何分解“山”。由于特殊二进制序列的起点一定是1，终点一定是0，每次去掉起点一个1和终点一个0，可以看成把山的高度降低一个单位。直到有超过一个小山碰到“地面”，这样可以刚好把该序列分成几个小山，还原字符串时就不用考虑第一个小山之前和最后一个小山之后的“尾巴”。如果不用这个技巧，有一种笨办法就是按高度统计点，从低到高遍历高度，第一个有两个点以上存在的高度即为小山的底部，代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">helper</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;S)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>, i = <span class="number">0</span> , j = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; m(S.size());</span><br><span class="line">        <span class="keyword">for</span>(;i &lt; S.size(); ++i)&#123;</span><br><span class="line">            m[j].push_back(i);</span><br><span class="line">            <span class="keyword">if</span>(S[i] == <span class="string">'1'</span>) ++j; <span class="keyword">else</span> --j;</span><br><span class="line">        &#125;</span><br><span class="line">        m[j].push_back(S.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p.size() &gt; <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="keyword">auto</span> &amp;v = p;</span><br><span class="line">                <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; vs;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size() - <span class="number">1</span>; ++i)&#123;</span><br><span class="line">                    vs.push_back(helper(S.substr(v[i], v[i+<span class="number">1</span>] - v[i])));</span><br><span class="line">                &#125;</span><br><span class="line">                sort(vs.begin(), vs.end(), [](<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;s2)&#123;<span class="keyword">return</span> s1 &gt; s2; &#125;);</span><br><span class="line">                <span class="built_in">string</span> t= <span class="string">""</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;s : vs) t += s;</span><br><span class="line">                <span class="keyword">return</span> S.substr(<span class="number">0</span>, v[<span class="number">0</span>]) + t + S.substr(v[v.size() - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> S;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">makeLargestSpecial</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> helper(S);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  还有一个细节需要注意。cnt为0的时候，小山的终点是当前点的下一个点，即<code>j+1</code>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">makeLargestSpecial</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">cnt</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; strs;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>),j(<span class="number">0</span>); i &lt; S.size(); ++j) &#123;</span><br><span class="line">            cnt += S[j] == <span class="string">'1'</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">                strs.push_back(<span class="string">"1"</span>+makeLargestSpecial(S.substr(i+<span class="number">1</span>,j-i<span class="number">-1</span>))+<span class="string">"0"</span>);</span><br><span class="line">                i = j+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(strs.begin(),strs.end());</span><br><span class="line">        <span class="built_in">string</span> res;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i(strs.size()); i &gt; <span class="number">0</span>; ) res += strs[--i];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/02/745-Prefix-and-Suffix-Search/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/02/745-Prefix-and-Suffix-Search/" itemprop="url">745. Prefix and Suffix Search</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-02T23:59:52+08:00">2020-02-02</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-03T00:29:34+08:00">2020-02-03</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="745-prefix-and-suffix-search"><a class="header-anchor" href="#745-prefix-and-suffix-search">¶</a><a href="https://leetcode.com/problems/prefix-and-suffix-search/" target="_blank" rel="noopener">745. Prefix and Suffix Search</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given many <code>words</code>, <code>words[i]</code> has weight <code>i</code>.</p>
<p>Design a class <code>WordFilter</code> that supports one function, <code>WordFilter.f(String prefix, String suffix)</code>. It will return the word with given <code>prefix</code> and <code>suffix</code> with maximum weight. If no word exists, return -1.</p>
<p><strong>Examples:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">WordFilter([&quot;apple&quot;])</span><br><span class="line">WordFilter.f(&quot;a&quot;, &quot;e&quot;) // returns 0</span><br><span class="line">WordFilter.f(&quot;b&quot;, &quot;&quot;) // returns -1</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>words</code> has length in range <code>[1, 15000]</code>.</li>
<li>For each test case, up to <code>words.length</code> queries <code>WordFilter.f</code> may be made.</li>
<li><code>words[i]</code> has length in range <code>[1, 10]</code>.</li>
<li><code>prefix, suffix</code> have lengths in range <code>[0, 10]</code>.</li>
<li><code>words[i]</code> and <code>prefix, suffix</code> queries consist of lowercase letters only.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-双字典树"><a class="header-anchor" href="#法一-双字典树">¶</a>法一 双字典树</h6>
<p>  活用字典树。向字典树添加字符串时，每遇到一个结点就把当前字符串编号存入结点中，代表当前字符串含有该结点代表的前缀。后缀和前缀类似，建立两个字典树。然后搜索前后缀，取出结点存放的字符串编号，用双指针找最大的公共值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordFilter</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        Node* child[<span class="number">26</span>] = &#123;&#125;;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;words;</span><br><span class="line">        Node() &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    Node *preRoot;</span><br><span class="line">    Node *sufRoot;</span><br><span class="line">    WordFilter(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words) &#123;</span><br><span class="line">        preRoot = <span class="keyword">new</span> Node();</span><br><span class="line">        sufRoot = <span class="keyword">new</span> Node();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.size(); i++) &#123;</span><br><span class="line">            preRoot-&gt;words.push_back(i);</span><br><span class="line">            sufRoot-&gt;words.push_back(i);</span><br><span class="line">            constructNode(preRoot, words[i], <span class="number">0</span>, i, <span class="literal">false</span>);</span><br><span class="line">            constructNode(sufRoot, words[i], words[i].size()<span class="number">-1</span>, i, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">constructNode</span><span class="params">(Node *node, <span class="built_in">string</span>&amp; word, <span class="keyword">int</span> k, <span class="keyword">int</span> weight, <span class="keyword">bool</span> reverse)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( (!reverse &amp;&amp; k == word.size() || (reverse &amp;&amp; k == <span class="number">-1</span>)) ) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> pos = word[k] - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;child[pos] == <span class="literal">NULL</span>) node-&gt;child[pos] = <span class="keyword">new</span> Node();</span><br><span class="line">        node-&gt;child[pos]-&gt;words.push_back(weight);</span><br><span class="line">        constructNode(node-&gt;child[pos], word, k + (reverse ? <span class="number">-1</span> : <span class="number">1</span>), weight, reverse);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="built_in">string</span> prefix, <span class="built_in">string</span> suffix)</span> </span>&#123;</span><br><span class="line">        Node *p = search(preRoot, prefix, <span class="number">0</span>);</span><br><span class="line">        reverse(suffix.begin(), suffix.end());</span><br><span class="line">        Node *s = search(sufRoot, suffix, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (!p || !s) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">int</span> pI = p-&gt;words.size()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> sI = s-&gt;words.size()<span class="number">-1</span>;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">while</span> (pI &gt;= <span class="number">0</span> &amp;&amp; sI &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> pW = p-&gt;words[pI];</span><br><span class="line">            <span class="keyword">int</span> sW = s-&gt;words[sI];</span><br><span class="line">            <span class="keyword">if</span> (pW == sW) <span class="keyword">return</span> pW;</span><br><span class="line">            <span class="keyword">if</span> (pW &gt; sW) pI--;</span><br><span class="line">            <span class="keyword">else</span> sI--;</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Node *<span class="title">search</span><span class="params">(Node *node, <span class="built_in">string</span>&amp; word, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (word.size() == k) <span class="keyword">return</span> node;</span><br><span class="line">        <span class="keyword">int</span> pos = word[k] - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">return</span> !node-&gt;child[pos] ? <span class="literal">NULL</span> : search(node-&gt;child[pos], word, k+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-paired-tree"><a class="header-anchor" href="#法二-paired-tree">¶</a>法二 paired tree</h6>
<p><a href="https://leetcode.com/articles/prefix-and-suffix-search/" target="_blank" rel="noopener">https://leetcode.com/articles/prefix-and-suffix-search/</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordFilter</span> </span>&#123;</span><br><span class="line">    TrieNode trie;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordFilter</span><span class="params">(String[] words)</span> </span>&#123;</span><br><span class="line">        trie = <span class="keyword">new</span> TrieNode();</span><br><span class="line">        <span class="keyword">int</span> wt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (String word: words) &#123;</span><br><span class="line">            TrieNode cur = trie;</span><br><span class="line">            cur.weight = wt;</span><br><span class="line">            <span class="keyword">int</span> L = word.length();</span><br><span class="line">            <span class="keyword">char</span>[] chars = word.toCharArray();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; L; ++i) &#123;</span><br><span class="line"></span><br><span class="line">                TrieNode tmp = cur;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; L; ++j) &#123;</span><br><span class="line">                    <span class="keyword">int</span> code = (chars[j] - <span class="string">'`'</span>) * <span class="number">27</span>;</span><br><span class="line">                    <span class="keyword">if</span> (tmp.children.get(code) == <span class="keyword">null</span>)</span><br><span class="line">                        tmp.children.put(code, <span class="keyword">new</span> TrieNode());</span><br><span class="line">                    tmp = tmp.children.get(code);</span><br><span class="line">                    tmp.weight = wt;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                tmp = cur;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = L - <span class="number">1</span> - i; k &gt;= <span class="number">0</span>; --k) &#123;</span><br><span class="line">                    <span class="keyword">int</span> code = (chars[k] - <span class="string">'`'</span>);</span><br><span class="line">                    <span class="keyword">if</span> (tmp.children.get(code) == <span class="keyword">null</span>)</span><br><span class="line">                        tmp.children.put(code, <span class="keyword">new</span> TrieNode());</span><br><span class="line">                    tmp = tmp.children.get(code);</span><br><span class="line">                    tmp.weight = wt;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> code = (chars[i] - <span class="string">'`'</span>) * <span class="number">27</span> + (chars[L - <span class="number">1</span> - i] - <span class="string">'`'</span>);</span><br><span class="line">                <span class="keyword">if</span> (cur.children.get(code) == <span class="keyword">null</span>)</span><br><span class="line">                    cur.children.put(code, <span class="keyword">new</span> TrieNode());</span><br><span class="line">                cur = cur.children.get(code);</span><br><span class="line">                cur.weight = wt;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            wt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">f</span><span class="params">(String prefix, String suffix)</span> </span>&#123;</span><br><span class="line">        TrieNode cur = trie;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = suffix.length() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; prefix.length() || j &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">char</span> c1 = i &lt; prefix.length() ? prefix.charAt(i) : <span class="string">'`'</span>;</span><br><span class="line">            <span class="keyword">char</span> c2 = j &gt;= <span class="number">0</span> ? suffix.charAt(j) : <span class="string">'`'</span>;</span><br><span class="line">            <span class="keyword">int</span> code = (c1 - <span class="string">'`'</span>) * <span class="number">27</span> + (c2 - <span class="string">'`'</span>);</span><br><span class="line">            cur = cur.children.get(code);</span><br><span class="line">            <span class="keyword">if</span> (cur == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            i++; j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur.weight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span> </span>&#123;</span><br><span class="line">    Map&lt;Integer, TrieNode&gt; children;</span><br><span class="line">    <span class="keyword">int</span> weight;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TrieNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        children = <span class="keyword">new</span> HashMap();</span><br><span class="line">        weight = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="法三-trie-of-suffix-wrapped-words"><a class="header-anchor" href="#法三-trie-of-suffix-wrapped-words">¶</a>法三 Trie of Suffix Wrapped Words</h6>
<p>  将后缀和前缀组合成一个字符串。比如&quot;apple&quot;，可以得到&quot;#apple&quot;,“e#apple”,“le#apple”,“ple#apple”,“pple#apple”,“apple#apple&quot;这几个字符串，将他们插入字典树，同时更新权重。查询的时候，只需在字典树中查找suffix+”#&quot;+prefix这个字符串。因为查询是查询一个字符串，并不需要分别对前后缀查询然后求权重交集，所以建立字典树时遇到大的权重直接替换即可，不用vector<int>保存权重。注意，此解法成立是因为，如果prefix和suffix是合法的输入，那么一定能在字典树中找到结点；如果prefix和suffix不合法，在字典树中一定找不到。</int></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordFilter</span> </span>&#123;</span><br><span class="line">    TrieNode trie;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordFilter</span><span class="params">(String[] words)</span> </span>&#123;</span><br><span class="line">        trie = <span class="keyword">new</span> TrieNode();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> weight = <span class="number">0</span>; weight &lt; words.length; ++weight) &#123;</span><br><span class="line">            String word = words[weight] + <span class="string">"&#123;"</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; word.length(); ++i) &#123;</span><br><span class="line">                TrieNode cur = trie;</span><br><span class="line">                cur.weight = weight;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; <span class="number">2</span> * word.length() - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">                    <span class="keyword">int</span> k = word.charAt(j % word.length()) - <span class="string">'a'</span>;</span><br><span class="line">                    <span class="keyword">if</span> (cur.children[k] == <span class="keyword">null</span>)</span><br><span class="line">                        cur.children[k] = <span class="keyword">new</span> TrieNode();</span><br><span class="line">                    cur = cur.children[k];</span><br><span class="line">                    cur.weight = weight;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">f</span><span class="params">(String prefix, String suffix)</span> </span>&#123;</span><br><span class="line">        TrieNode cur = trie;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> letter: (suffix + <span class="string">'&#123;'</span> + prefix).toCharArray()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.children[letter - <span class="string">'a'</span>] == <span class="keyword">null</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            cur = cur.children[letter - <span class="string">'a'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur.weight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span> </span>&#123;</span><br><span class="line">    TrieNode[] children;</span><br><span class="line">    <span class="keyword">int</span> weight;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TrieNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        children = <span class="keyword">new</span> TrieNode[<span class="number">27</span>];</span><br><span class="line">        weight = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="法四-字符串hash"><a class="header-anchor" href="#法四-字符串hash">¶</a>法四 字符串hash</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordFilter</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;&gt; m1, m2;</span><br><span class="line">    WordFilter(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; w) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; w.size(); ++j)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= w[j].size(); ++i)&#123;</span><br><span class="line">                m1[w[j].substr(<span class="number">0</span>, i)].insert(-j);</span><br><span class="line">                m2[w[j].substr(i)].insert(-j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="built_in">string</span> prefix, <span class="built_in">string</span> suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> iter1 = m1.find(prefix), iter2 = m2.find(suffix);</span><br><span class="line">        <span class="keyword">if</span>(iter2 == m2.end() || iter1 == m1.end())  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">auto</span> &amp;s1 = iter1-&gt;second, &amp;s2 = iter2-&gt;second;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it1 = s1.begin(); it1 != s1.end(); it1++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s2.count(*it1) != <span class="number">0</span>) <span class="keyword">return</span> -(*it1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your WordFilter object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * WordFilter* obj = new WordFilter(words);</span></span><br><span class="line"><span class="comment"> * int param_1 = obj-&gt;f(prefix,suffix);</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/02/730-Count-Different-Palindromic-Subsequences/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/02/730-Count-Different-Palindromic-Subsequences/" itemprop="url">730. Count Different Palindromic Subsequences</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-02T18:32:00+08:00">2020-02-02</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-02T22:24:36+08:00">2020-02-02</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="730-count-different-palindromic-subsequences"><a class="header-anchor" href="#730-count-different-palindromic-subsequences">¶</a><a href="https://leetcode.com/problems/count-different-palindromic-subsequences/" target="_blank" rel="noopener">730. Count Different Palindromic Subsequences</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a string S, find the number of different non-empty palindromic subsequences in S, and <strong>return that number modulo <code>10^9 + 7</code>.</strong></p>
<p>A subsequence of a string S is obtained by deleting 0 or more characters from S.</p>
<p>A sequence is palindromic if it is equal to the sequence reversed.</p>
<p>Two sequences <code>A_1, A_2, ...</code> and <code>B_1, B_2, ...</code> are different if there is some <code>i</code> for which <code>A_i != B_i</code>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">S = &apos;bccb&apos;</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: </span><br><span class="line">The 6 different non-empty palindromic subsequences are &apos;b&apos;, &apos;c&apos;, &apos;bb&apos;, &apos;cc&apos;, &apos;bcb&apos;, &apos;bccb&apos;.</span><br><span class="line">Note that &apos;bcb&apos; is counted only once, even though it occurs twice.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">S = &apos;abcdabcdabcdabcdabcdabcdabcdabcddcbadcbadcbadcbadcbadcbadcbadcba&apos;</span><br><span class="line">Output: 104860361</span><br><span class="line">Explanation: </span><br><span class="line">There are 3104860382 different non-empty palindromic subsequences, which is 104860361 modulo 10^9 + 7.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li>The length of <code>S</code> will be in the range <code>[1, 1000]</code>.*   Each character <code>S[i]</code> will be in the set <code>{'a', 'b', 'c', 'd'}</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dp-top-down"><a class="header-anchor" href="#法一-dp-top-down">¶</a>法一 dp top-down</h6>
<p><code>dp[i][j]</code>代表<code>S[i:j+1]</code>的包含空串的不同回文串的数目。则<code>dp(i, i) = 1</code>，<code>dp(i,j) = (number of unique characters in T) + dp(next('a',i)+1, prev('a',j)-1) + dp(next('b',i)+1, prev('b',j)-1) + dp(next('c',i)+1, prev('c',j)-1)+ dp(next('d',i)+1, prev('d',j)-1)</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp, nxt, prv;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">string</span> &amp;S, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l &gt; r+<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//"a"</span></span><br><span class="line">        <span class="keyword">if</span>(l == r+<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//"aa"</span></span><br><span class="line">        <span class="keyword">if</span>(dp[l][r] != <span class="number">-1</span>) <span class="keyword">return</span> dp[l][r];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nxt[l][i] != <span class="number">-1</span> &amp;&amp; prv[r][i] != <span class="number">-1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nxt[l][i] &lt;= prv[r][i]) ret++;</span><br><span class="line">                ret = (ret + dfs(S, nxt[l][i] + <span class="number">1</span>, prv[r][i] - <span class="number">1</span>)) % p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  dp[l][r] = ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countPalindromicSubsequences</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = S.size(); </span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line">        dp.resize(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">-1</span>));</span><br><span class="line">        nxt.resize(n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">4</span>, <span class="number">-1</span>));</span><br><span class="line">        prv.resize(n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">4</span>, <span class="number">-1</span>));</span><br><span class="line">        nxt[n - <span class="number">1</span>][S[n - <span class="number">1</span>] - <span class="string">'a'</span>] = n - <span class="number">1</span>;</span><br><span class="line">        prv[<span class="number">0</span>][S[<span class="number">0</span>] - <span class="string">'a'</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span>, j = <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i, ++j)&#123;</span><br><span class="line">            nxt[i] = nxt[i + <span class="number">1</span>]; nxt[i][S[i] - <span class="string">'a'</span>] = i;</span><br><span class="line">            prv[j] = prv[j - <span class="number">1</span>]; prv[j][S[j] - <span class="string">'a'</span>] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dfs(S, <span class="number">0</span>, n - <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-dp-top-down"><a class="header-anchor" href="#法二-dp-top-down">¶</a>法二 dp top-down</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; memo, prv, nxt;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; A;</span><br><span class="line">    <span class="keyword">int</span> MOD = <span class="number">1000000007</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countPalindromicSubsequences</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = S.length();</span><br><span class="line">        memo.resize(N, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(N));</span><br><span class="line">        prv.resize(N, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">4</span>, <span class="number">-1</span>));</span><br><span class="line">        nxt.resize(N, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">4</span>, <span class="number">-1</span>));</span><br><span class="line">        </span><br><span class="line">        A.resize(N);</span><br><span class="line">        <span class="keyword">int</span> ix = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : S)</span><br><span class="line">            A[ix++] = c - <span class="string">'a'</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; last(<span class="number">4</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            last[A[i]] = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                prv[i][k] = last[k];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        last.assign(<span class="number">4</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            last[A[i]] = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                nxt[i][k] = last[k];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dp(<span class="number">0</span>, N - <span class="number">1</span>) - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (memo[i][j] &gt; <span class="number">0</span>) <span class="keyword">return</span> memo[i][j];</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) &#123;</span><br><span class="line">                <span class="keyword">int</span> i0 = nxt[i][k];</span><br><span class="line">                <span class="keyword">int</span> j0 = prv[j][k];</span><br><span class="line">                <span class="keyword">if</span> (i &lt;= i0 &amp;&amp; i0 &lt;= j) ans++;</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">0</span> &lt;= i0 &amp;&amp; i0 &lt; j0) ans += dp(i0 + <span class="number">1</span>, j0 - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (ans &gt;= MOD) ans -= MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        memo[i][j] = ans;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-dp-bottom-up"><a class="header-anchor" href="#法三-dp-bottom-up">¶</a>法三 dp bottom-up</h6>
<p>  基于去重的dp，<code>afterJToI</code>是<code>j</code>之后的回文串的数目，<code>startingAtJToI</code>是从<code>j</code>开始的回文串的数目(长度至少为2)，<code>newEndingAtI</code>是新的以<code>i</code>为结尾的回文串的数目。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countPalindromicSubsequences</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> c = <span class="number">1000000007</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> n = S.size();</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; afterJToI(n, <span class="number">0</span>), startingAtJToI(n, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> newEndingAtI = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">                <span class="keyword">if</span>(S[j] == S[i]) &#123;</span><br><span class="line">                    <span class="keyword">int</span> temp = (afterJToI[j] + <span class="number">1</span>) % c;</span><br><span class="line">                    afterJToI[j] = (afterJToI[j] + newEndingAtI) % c;</span><br><span class="line">                    newEndingAtI = temp - startingAtJToI[j];</span><br><span class="line">                    <span class="keyword">if</span>(newEndingAtI &lt; <span class="number">0</span>) newEndingAtI += c;</span><br><span class="line">                    startingAtJToI[j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    afterJToI[j] = (afterJToI[j] + newEndingAtI) % c;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//             cout &lt;&lt; "afterj:";</span></span><br><span class="line"><span class="comment">//             for(auto &amp;x : afterJToI)&#123;</span></span><br><span class="line"><span class="comment">//                 cout &lt;&lt; x &lt;&lt; " ";</span></span><br><span class="line"><span class="comment">//             &#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//             cout &lt;&lt; "  startatj:";</span></span><br><span class="line"><span class="comment">//             for(auto &amp;x : startingAtJToI)&#123;</span></span><br><span class="line"><span class="comment">//                 cout &lt;&lt; x &lt;&lt; " ";</span></span><br><span class="line"><span class="comment">//             &#125;</span></span><br><span class="line"><span class="comment">//             cout &lt;&lt; endl;</span></span><br><span class="line">            res = (res + newEndingAtI) % c;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; newEndingAtI &lt;&lt; endl;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法四-bottom-up"><a class="header-anchor" href="#法四-bottom-up">¶</a>法四 bottom-up</h6>
<p><a href="https://leetcode-cn.com/problems/count-different-palindromic-subsequences/solution/tong-ji-bu-tong-hui-wen-zi-zi-fu-chuan-by-leetcode/" target="_blank" rel="noopener">https://leetcode-cn.com/problems/count-different-palindromic-subsequences/solution/tong-ji-bu-tong-hui-wen-zi-zi-fu-chuan-by-leetcode/</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">countPalindromicSubsequences</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = S.size();</span><br><span class="line">    <span class="keyword">int</span> mod = <span class="number">1000000007</span>;</span><br><span class="line">    <span class="keyword">auto</span> dp_ptr = <span class="keyword">new</span> <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&gt;(<span class="number">4</span>, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;(n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n)));</span><br><span class="line">    <span class="keyword">auto</span>&amp; dp = *dp_ptr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">          <span class="keyword">char</span> c = <span class="string">'a'</span> + k;</span><br><span class="line">          <span class="keyword">if</span> (j == i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (S[i] == c) dp[k][i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> dp[k][i][j] = <span class="number">0</span>;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123; <span class="comment">// j &gt; i</span></span><br><span class="line">            <span class="keyword">if</span> (S[i] != c) dp[k][i][j] = dp[k][i+<span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (S[j] != c) dp[k][i][j] = dp[k][i][j<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">else</span> &#123; <span class="comment">// S[i] == S[j] == c</span></span><br><span class="line">              <span class="keyword">if</span> (j == i+<span class="number">1</span>) dp[k][i][j] = <span class="number">2</span>; <span class="comment">// "aa" : &#123;"a", "aa"&#125;</span></span><br><span class="line">              <span class="keyword">else</span> &#123; <span class="comment">// length is &gt; 2</span></span><br><span class="line">                dp[k][i][j] = <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; <span class="number">4</span>; ++m) &#123; <span class="comment">// count each one within subwindows [i+1][j-1]</span></span><br><span class="line">                  dp[k][i][j] += dp[m][i+<span class="number">1</span>][j<span class="number">-1</span>];</span><br><span class="line">                  dp[k][i][j] %= mod;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">      ans += dp[k][<span class="number">0</span>][n<span class="number">-1</span>];</span><br><span class="line">      ans %= mod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/02/序列自动机的nxt数组/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/02/序列自动机的nxt数组/" itemprop="url">序列自动机的nxt数组</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-02T17:51:26+08:00">2020-02-02</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-02T18:01:54+08:00">2020-02-02</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="问题："><a class="header-anchor" href="#问题：">¶</a>问题：</h3>
<p>  求一个字符串S某个位置i左边或者右边第一个某字符j的位置</p>
<h3 id="代码"><a class="header-anchor" href="#代码">¶</a>代码:</h3>
<p>求next数组：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//string S</span></span><br><span class="line"><span class="keyword">int</span> n = S.size(); </span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; nl(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">26</span>, <span class="number">-1</span>));<span class="comment">//比字符串大小多1，要考虑-1位置（第一个字符之前的那个位置）,S的i对应nl的i+1。</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)&#123;</span><br><span class="line">	nl[i] = nl[i + <span class="number">1</span>]; nl[i][S[i] - <span class="string">'a'</span>] = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; nr(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">26</span>, <span class="number">-1</span>)); <span class="comment">//S的i对应nr的i。</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)&#123;</span><br><span class="line">	nr[j] = nr[j - <span class="number">1</span>]; nr[j][S[j - <span class="number">1</span>] - <span class="string">'a'</span>] = j - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>则<code>i</code>从左到右的第一个<code>j</code>的位置为<code>nl[i+1][j]</code>，则<code>i</code>从右到左的第一个<code>j</code>的位置为<code>nr[i][j]</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/01/20-Short-Encoding-of-Words/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/01/20-Short-Encoding-of-Words/" itemprop="url">820. Short Encoding of Words</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-01T23:03:15+08:00">2020-02-01</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-01T23:26:50+08:00">2020-02-01</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="820-short-encoding-of-words"><a class="header-anchor" href="#820-short-encoding-of-words">¶</a><a href="https://leetcode.com/problems/short-encoding-of-words/" target="_blank" rel="noopener">820. Short Encoding of Words</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given a list of words, we may encode it by writing a reference string <code>S</code> and a list of indexes <code>A</code>.</p>
<p>For example, if the list of words is <code>[&quot;time&quot;, &quot;me&quot;, &quot;bell&quot;]</code>, we can write it as <code>S = &quot;time#bell#&quot;</code> and <code>indexes = [0, 2, 5]</code>.</p>
<p>Then for each index, we will recover the word by reading from the reference string from that index until we reach a <code>&quot;#&quot;</code> character.</p>
<p>What is the length of the shortest reference string S possible that encodes the given words?</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: words = [&quot;time&quot;, &quot;me&quot;, &quot;bell&quot;]</span><br><span class="line">Output: 10</span><br><span class="line">Explanation: S = &quot;time#bell#&quot; and indexes = [0, 2, 5].</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= words.length &lt;= 2000</code>.</li>
<li><code>1 &lt;= words[i].length &lt;= 7</code>.</li>
<li>Each word has only lowercase letters.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-排序"><a class="header-anchor" href="#法一-排序">¶</a>法一 排序</h5>
<p>翻转字符串排序</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPrefix</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;s2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span> ; i &lt; s1.size() &amp;&amp; j &lt; s2.size(); ++i , ++j )&#123;</span><br><span class="line">            <span class="keyword">if</span>(s1[i] != s2[j])  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minimumLengthEncoding</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; w;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;s : words)&#123;</span><br><span class="line">            reverse(s.begin(), s.end());</span><br><span class="line">            w.push_back(s);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sort(w.begin(), w.end());</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; w.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i &lt; w.size() <span class="number">-1</span> &amp;&amp; isPrefix(w[i] , w[i + <span class="number">1</span>])) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                ans += <span class="number">1</span> + w[i].size();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-移除所有后缀"><a class="header-anchor" href="#法二-移除所有后缀">¶</a>法二 移除所有后缀</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumLengthEncoding</span><span class="params">(String[] words)</span> </span>&#123;</span><br><span class="line">        Set&lt;String&gt; good = <span class="keyword">new</span> HashSet(Arrays.asList(words));</span><br><span class="line">        <span class="keyword">for</span> (String word: words) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; word.length(); ++k)</span><br><span class="line">                good.remove(word.substring(k));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (String word: good)</span><br><span class="line">            ans += word.length() + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="法三-字典树"><a class="header-anchor" href="#法三-字典树">¶</a>法三 字典树</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TrieNode</span>&#123;</span></span><br><span class="line">        TrieNode *nxt[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">bool</span> f;</span><br><span class="line">        TrieNode()&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i) nxt[i] = <span class="literal">nullptr</span>;</span><br><span class="line">            f = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">TrieNode *<span class="title">get</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(nxt[c - <span class="string">'a'</span>] == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                nxt[c - <span class="string">'a'</span>] = <span class="keyword">new</span> TrieNode();</span><br><span class="line">                f = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> nxt[c - <span class="string">'a'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minimumLengthEncoding</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;TrieNode*, <span class="keyword">int</span>&gt; m;</span><br><span class="line">        TrieNode *trie = <span class="keyword">new</span> TrieNode();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">auto</span> &amp;s = words[i];</span><br><span class="line">            <span class="keyword">auto</span> cur = trie;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = s.size() - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)&#123;</span><br><span class="line">                cur = cur-&gt;get(s[j]);</span><br><span class="line">            &#125;</span><br><span class="line">            m[cur] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;node : m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!node.first-&gt;f)</span><br><span class="line">                ans += <span class="number">1</span> + words[m[node.first]].size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/01/1186-Maximum-Subarray-Sum-with-One-Deletion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/01/1186-Maximum-Subarray-Sum-with-One-Deletion/" itemprop="url">1186. Maximum Subarray Sum with One Deletion</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-01T15:50:00+08:00">2020-02-01</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-01T22:43:00+08:00">2020-02-01</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1186-maximum-subarray-sum-with-one-deletion"><a class="header-anchor" href="#1186-maximum-subarray-sum-with-one-deletion">¶</a><a href="https://leetcode.com/problems/maximum-subarray-sum-with-one-deletion/" target="_blank" rel="noopener">1186. Maximum Subarray Sum with One Deletion</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given an array of integers, return the maximum sum for a <strong>non-empty</strong> subarray (contiguous elements) with at most one element deletion. In other words, you want to choose a subarray and optionally delete one element from it so that there is still at least one element left and the sum of the remaining elements is maximum possible.</p>
<p>Note that the subarray needs to be <strong>non-empty</strong> after deleting one element.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr = [1,-2,0,3]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: Because we can choose [1, -2, 0, 3] and drop -2, thus the subarray [1, 0, 3] becomes the maximum value.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr = [1,-2,-2,3]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: We just choose [3] and it&apos;s the maximum sum.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: arr = [-1,-1,-1,-1]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: The final subarray needs to be non-empty. You can&apos;t choose [-1] and delete -1 from it, then get an empty subarray to make the sum equals to 0.</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= arr.length &lt;= 10^5</code></li>
<li><code>-10^4 &lt;= arr[i] &lt;= 10^4</code></li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dp-one-pass"><a class="header-anchor" href="#法一-dp-one-pass">¶</a>法一 dp one pass</h6>
<p>  dp1是&quot;中间有个洞&quot;的以当前元素结尾的子数组的最大和，dp2是连续子数组的最大和。注意从第二个元素开始，如果从第一个元素就不能保证dp1有意义（因为题目要求非空子数组）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maximumSum</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp1 = arr[<span class="number">0</span>], dp2 = arr[<span class="number">0</span>], ans = arr[<span class="number">0</span>];<span class="comment">//也可以将dp2初值设置为-1e9</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.size(); ++i)&#123;</span><br><span class="line">            dp1 = max(dp1 + arr[i], dp2); </span><br><span class="line">            dp2 = max(dp2 + arr[i], arr[i]);</span><br><span class="line">            ans = max(ans, max(dp1, dp2));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dp-two-pass"><a class="header-anchor" href="#法二-dp-two-pass">¶</a>法二 dp two pass</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maximumSum</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = arr.size(), ans = INT_MIN;</span><br><span class="line">        <span class="keyword">int</span> dp_l[n]&#123;&#125;, dp_r[n]&#123;&#125;;</span><br><span class="line">        dp_l[<span class="number">0</span>] = arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) dp_l[i] = max(dp_l[i<span class="number">-1</span>] + arr[i], arr[i]);</span><br><span class="line">        </span><br><span class="line">        dp_r[n<span class="number">-1</span>] = arr[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) dp_r[i] = max(dp_r[i+<span class="number">1</span>] + arr[i], arr[i]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">2</span>; ++i)&#123;</span><br><span class="line">            ans = max(ans, dp_l[i]);</span><br><span class="line">            ans = max(ans, dp_l[i<span class="number">-1</span>]+dp_r[i+<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max(&#123;ans, dp_l[<span class="number">0</span>], dp_l[n<span class="number">-1</span>]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">441</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
