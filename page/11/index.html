<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/31/726-Number-of-Atoms/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/31/726-Number-of-Atoms/" itemprop="url">726. Number of Atoms</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-31T00:31:35+08:00">2020-01-31</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-31T17:10:02+08:00">2020-01-31</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="726-number-of-atoms"><a class="header-anchor" href="#726-number-of-atoms">¶</a><a href="https://leetcode.com/problems/number-of-atoms/" target="_blank" rel="noopener">726. Number of Atoms</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a chemical <code>formula</code> (given as a string), return the count of each atom.</p>
<p>An atomic element always starts with an uppercase character, then zero or more lowercase letters, representing the name.</p>
<p>1 or more digits representing the count of that element may follow if the count is greater than 1. If the count is 1, no digits will follow. For example, H2O and H2O2 are possible, but H1O2 is impossible.</p>
<p>Two formulas concatenated together produce another formula. For example, H2O2He3Mg4 is also a formula.</p>
<p>A formula placed in parentheses, and a count (optionally added) is also a formula. For example, (H2O2) and (H2O2)3 are formulas.</p>
<p>Given a formula, output the count of all elements as a string in the following form: the first name (in sorted order), followed by its count (if that count is more than 1), followed by the second name (in sorted order), followed by its count (if that count is more than 1), and so on.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">formula = &quot;H2O&quot;</span><br><span class="line">Output: &quot;H2O&quot;</span><br><span class="line">Explanation: </span><br><span class="line">The count of elements are &#123;&apos;H&apos;: 2, &apos;O&apos;: 1&#125;.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">formula = &quot;Mg(OH)2&quot;</span><br><span class="line">Output: &quot;H2MgO2&quot;</span><br><span class="line">Explanation: </span><br><span class="line">The count of elements are &#123;&apos;H&apos;: 2, &apos;Mg&apos;: 1, &apos;O&apos;: 2&#125;.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">formula = &quot;K4(ON(SO3)2)2&quot;</span><br><span class="line">Output: &quot;K4N2O14S4&quot;</span><br><span class="line">Explanation: </span><br><span class="line">The count of elements are &#123;&apos;K&apos;: 4, &apos;N&apos;: 2, &apos;O&apos;: 14, &apos;S&apos;: 4&#125;.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li>All atom names consist of lowercase letters, except for the first character which is uppercase.*   The length of <code>formula</code> will be in the range <code>[1, 1000]</code>.*   <code>formula</code> will only consist of letters, digits, and round parentheses, and is a valid formula as defined in the problem.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>官方java/python解法:<a href="https://leetcode.com/articles/number-of-atoms/" target="_blank" rel="noopener">https://leetcode.com/articles/number-of-atoms/</a></p>
<h5 id="法一-stack"><a class="header-anchor" href="#法一-stack">¶</a>法一 stack</h5>
<p>C++ 解法 :</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getCount</span><span class="params">(<span class="built_in">string</span> &amp;s, <span class="keyword">int</span> &amp;i)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;s.size()&amp;&amp;<span class="built_in">isdigit</span>(s[i]))&#123;</span><br><span class="line">            cnt = cnt * <span class="number">10</span> + s[i] - <span class="string">'0'</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt == <span class="number">0</span>?<span class="number">1</span>: cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">countOfAtoms</span><span class="params">(<span class="built_in">string</span> formula)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt;&gt; st;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; m_cur;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ;i &lt; formula.size();)&#123;</span><br><span class="line">            <span class="keyword">if</span>(formula[i]==<span class="string">'('</span>)&#123;</span><br><span class="line">                i++;</span><br><span class="line">                st.push(m_cur);</span><br><span class="line">                m_cur = <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(formula[i] == <span class="string">')'</span>)&#123;</span><br><span class="line">                i++;</span><br><span class="line">                <span class="keyword">int</span> cnt = getCount(formula, i);</span><br><span class="line">                <span class="keyword">if</span>(!st.empty())&#123;</span><br><span class="line">                    <span class="keyword">auto</span> &amp;m_bef = st.top();</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m_cur) m_bef[p.first] += p.second * cnt;</span><br><span class="line">                    m_cur = m_bef;</span><br><span class="line">                    st.pop();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m_cur) p.second *= cnt;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">string</span> key(<span class="number">1</span>, formula[i++]);</span><br><span class="line">                <span class="keyword">while</span>(i &lt; formula.size() &amp;&amp; <span class="built_in">islower</span>(formula[i]))&#123;</span><br><span class="line">                    key += formula[i];</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                m_cur[key] += getCount(formula, i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; m(m_cur.begin(), m_cur.end());</span><br><span class="line">        <span class="built_in">string</span> ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:m) ans += x.first + (x.second==<span class="number">1</span>?<span class="string">""</span>:to_string(x.second));</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-递归"><a class="header-anchor" href="#法二-递归">¶</a>法二 递归</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; parse(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s, <span class="keyword">int</span> &amp;i)&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; count;</span><br><span class="line">        <span class="keyword">int</span> N = s.size();</span><br><span class="line">        <span class="keyword">while</span>(i &lt; N &amp;&amp; s[i] != <span class="string">')'</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="string">'('</span>)&#123;</span><br><span class="line">                ++i;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : parse(s, i))&#123;</span><br><span class="line">                    count[p.first] += p.second;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">string</span> ele(<span class="number">1</span>, s[i++]);</span><br><span class="line">                <span class="keyword">int</span> val = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span>(i &lt; N &amp;&amp; <span class="built_in">islower</span>(s[i])) &#123;</span><br><span class="line">                    ele += s[i];</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span>(i &lt; N &amp;&amp; <span class="built_in">isdigit</span>(s[i]))&#123;</span><br><span class="line">                    val = val * <span class="number">10</span> + s[i] - <span class="string">'0'</span>;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                count[ele] += (val == <span class="number">0</span> ? <span class="number">1</span> : val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">int</span> mul = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; N &amp;&amp; <span class="built_in">isdigit</span>(s[i]))&#123;</span><br><span class="line">            mul = mul * <span class="number">10</span> + s[i] - <span class="string">'0'</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(mul == <span class="number">0</span>) mul = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : count)&#123;</span><br><span class="line">            x.second *= mul;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">countOfAtoms</span><span class="params">(<span class="built_in">string</span> formula)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i =<span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;count = parse(formula, i);</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; ord_map(count.begin(), count.end());</span><br><span class="line">        <span class="built_in">string</span> ans = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x: ord_map)&#123;</span><br><span class="line">            ans += x.first + (x.second == <span class="number">1</span> ? <span class="string">""</span> : to_string(x.second));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-正则表达式"><a class="header-anchor" href="#法三-正则表达式">¶</a>法三 正则表达式</h5>
<p>java 解法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.regex.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">countOfAtoms</span><span class="params">(String formula)</span> </span>&#123;</span><br><span class="line">        Matcher matcher = Pattern.compile(<span class="string">"([A-Z][a-z]*)(\\d*)|(\\()|(\\))(\\d*)"</span>).matcher(formula);</span><br><span class="line">        Stack&lt;Map&lt;String, Integer&gt;&gt; stack = <span class="keyword">new</span> Stack();</span><br><span class="line">        stack.push(<span class="keyword">new</span> TreeMap());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            String match = matcher.group();</span><br><span class="line">            <span class="keyword">if</span> (match.equals(<span class="string">"("</span>)) &#123;</span><br><span class="line">                stack.push(<span class="keyword">new</span> TreeMap());</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (match.startsWith(<span class="string">")"</span>)) &#123;</span><br><span class="line">                Map&lt;String, Integer&gt; top = stack.pop();</span><br><span class="line">                <span class="keyword">int</span> multiplicity = match.length() &gt; <span class="number">1</span> ? Integer.parseInt(match.substring(<span class="number">1</span>, match.length())) : <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (String name: top.keySet()) &#123;</span><br><span class="line">                    stack.peek().put(name, stack.peek().getOrDefault(name, <span class="number">0</span>) + top.get(name) * multiplicity);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (i &lt; match.length() &amp;&amp; Character.isLowerCase(match.charAt(i))) &#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                String name = match.substring(<span class="number">0</span>, i);</span><br><span class="line">                <span class="keyword">int</span> multiplicity = i &lt; match.length() ? Integer.parseInt(match.substring(i, match.length())) : <span class="number">1</span>;</span><br><span class="line">                stack.peek().put(name, stack.peek().getOrDefault(name, <span class="number">0</span>) + multiplicity);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        StringBuilder ans = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (String name: stack.peek().keySet()) &#123;</span><br><span class="line">            ans.append(name);</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> count = stack.peek().get(name);</span><br><span class="line">            <span class="keyword">if</span> (count &gt; <span class="number">1</span>) ans.append(String.valueOf(count));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>python 解法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countOfAtoms</span><span class="params">(self, formula)</span>:</span></span><br><span class="line">        parse = re.findall(<span class="string">r"([A-Z][a-z]*)(\d*)|(\()|(\))(\d*)"</span>, formula)</span><br><span class="line">        stack = [collections.Counter()]</span><br><span class="line">        <span class="keyword">for</span> name, m1, left_open, right_open, m2 <span class="keyword">in</span> parse:</span><br><span class="line">            <span class="keyword">if</span> name:</span><br><span class="line">              stack[<span class="number">-1</span>][name] += int(m1 <span class="keyword">or</span> <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> left_open:</span><br><span class="line">              stack.append(collections.Counter())</span><br><span class="line">            <span class="keyword">if</span> right_open:</span><br><span class="line">                top = stack.pop()</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> top:</span><br><span class="line">                  stack[<span class="number">-1</span>][k] += top[k] * int(m2 <span class="keyword">or</span> <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join(name + (str(stack[<span class="number">-1</span>][name]) <span class="keyword">if</span> stack[<span class="number">-1</span>][name] &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">''</span>)</span><br><span class="line">                       <span class="keyword">for</span> name <span class="keyword">in</span> sorted(stack[<span class="number">-1</span>]))</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/29/956-Tallest-Billboard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/29/956-Tallest-Billboard/" itemprop="url">956. Tallest Billboard</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-29T17:46:01+08:00">2020-01-29</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-29T18:00:02+08:00">2020-01-29</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="956-tallest-billboard"><a class="header-anchor" href="#956-tallest-billboard">¶</a><a href="https://leetcode.com/problems/tallest-billboard/" target="_blank" rel="noopener">956. Tallest Billboard</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>You are installing a billboard and want it to have the largest height.  The billboard will have two steel supports, one on each side.  Each steel support must be an equal height.</p>
<p>You have a collection of <code>rods</code> which can be welded together.  For example, if you have rods of lengths 1, 2, and 3, you can weld them together to make a support of length 6.</p>
<p>Return the largest possible height of your billboard installation.  If you cannot support the billboard, return 0.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2,3,6]</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: We have two disjoint subsets &#123;1,2,3&#125; and &#123;6&#125;, which have the same sum = 6.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2,3,4,5,6]</span><br><span class="line">Output: 10</span><br><span class="line">Explanation: We have two disjoint subsets &#123;2,3,5&#125; and &#123;4,6&#125;, which have the same sum = 10.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: The billboard cannot be supported, so we return 0.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>0 &lt;= rods.length &lt;= 20</code></li>
<li><code>1 &lt;= rods[i] &lt;= 1000</code></li>
<li><code>The sum of rods is at most 5000.</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-dp"><a class="header-anchor" href="#法一-dp">¶</a>法一 dp</h5>
<p>  <code>dp[i]</code>代表l，r差值为i时，较小的那个值的最大值，更详细的见注释。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// - DP solution:</span></span><br><span class="line"><span class="comment">//  (0) 3 ways for each rod: ignore / support left / support right</span></span><br><span class="line"><span class="comment">//  (1) DP[diff] = b  </span></span><br><span class="line"><span class="comment">//      =&gt; 2 supports: (diff + b, b)</span></span><br><span class="line"><span class="comment">//  (2) There will be 2 ways to add support</span></span><br><span class="line"><span class="comment">//    1. add to bigger one</span></span><br><span class="line"><span class="comment">//    2. add to smaller one</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">tallestBillboard</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rods)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> sum = accumulate(begin(rods), end(rods), <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(sum+<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> rod : rods) &#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cur(dp);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= sum; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cur[i] &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                dp[i+rod] = max(dp[i+rod], cur[i]);</span><br><span class="line">                dp[<span class="built_in">abs</span>(i-rod)] = max(dp[<span class="built_in">abs</span>(i-rod)], cur[i]+min(rod, i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-记忆化dp"><a class="header-anchor" href="#法二-记忆化dp">¶</a>法二 记忆化dp</h5>
<p>  <code>dp[i][s]</code>代表i右边和为s时，最大的正得分。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; r;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;dp, <span class="keyword">int</span> i, <span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==N)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s==<span class="number">5000</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> INT_MIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dp[i][s]!=<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> dp[i][s];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[i][s] = max(&#123;dfs(dp,i+<span class="number">1</span>, s), dfs(dp,i+<span class="number">1</span>, s-r[i])+r[i], dfs(dp,i+<span class="number">1</span>, s+r[i])&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">tallestBillboard</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rods)</span> </span>&#123;</span><br><span class="line">        N = rods.size();</span><br><span class="line">        r = rods;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(N, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">10001</span>, <span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">return</span> dfs(dp, <span class="number">0</span>, <span class="number">5000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-dfs剪枝"><a class="header-anchor" href="#法三-dfs剪枝">¶</a>法三 dfs剪枝</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span></span><br><span class="line"><span class="keyword">namespace</span> leetcode8ms</span><br><span class="line">&#123;</span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">a_solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; values;</span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> S;</span><br><span class="line">  <span class="keyword">int</span> M = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  a_solution (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; values)</span><br><span class="line">  : values&#123;values&#125;, S(accumulate(begin(values),end(values),<span class="number">0</span>))</span><br><span class="line">  &#123;</span><br><span class="line">   sort(begin(values),end(values),greater&lt;<span class="keyword">int</span>&gt;&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   dfs(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,S);</span><br><span class="line">   <span class="keyword">return</span> M;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// i points to next rod.</span></span><br><span class="line">  <span class="comment">// [l,r] is billboard height of each side.</span></span><br><span class="line">  <span class="comment">// R is max rod size remained.</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">dfs</span> <span class="params">(<span class="keyword">int</span> <span class="keyword">const</span> i, <span class="keyword">int</span> <span class="keyword">const</span> l, <span class="keyword">int</span> <span class="keyword">const</span> r, <span class="keyword">int</span> <span class="keyword">const</span> R)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="built_in">abs</span>(l-r) &gt; R || l+r+R &lt;= <span class="number">2</span>*M) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">   <span class="keyword">if</span> (l == r &amp;&amp; M &lt; l) &#123; M = l; &#125;</span><br><span class="line">   <span class="keyword">if</span> (i == values.size()) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">   <span class="keyword">auto</span> <span class="keyword">const</span> v = values[i];</span><br><span class="line">   dfs(i+<span class="number">1</span>,l+v,r,R-v);</span><br><span class="line">   dfs(i+<span class="number">1</span>,l,r+v,R-v);</span><br><span class="line">   dfs(i+<span class="number">1</span>,l,r,  R-v);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">tallestBillboard</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rods)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> a_solution&#123;rods&#125;.solve();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="法四-分治"><a class="header-anchor" href="#法四-分治">¶</a>法四 分治</h5>
<p>  分两半，找到每一半中l,r各种组合，并且算出d=l-r对应的最大的l，最后将两边的结果综合即可得出结果。综合的过程是左边取d，右边取-d，然后算出它们对应的值的和。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.Point;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">tallestBillboard</span><span class="params">(<span class="keyword">int</span>[] rods)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = rods.length;</span><br><span class="line">        Map&lt;Integer, Integer&gt; Ldelta = make(Arrays.copyOfRange(rods, <span class="number">0</span>, N/<span class="number">2</span>));</span><br><span class="line">        Map&lt;Integer, Integer&gt; Rdelta = make(Arrays.copyOfRange(rods, N/<span class="number">2</span>, N));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> d: Ldelta.keySet())</span><br><span class="line">            <span class="keyword">if</span> (Rdelta.containsKey(-d))</span><br><span class="line">                ans = Math.max(ans, Ldelta.get(d) + Rdelta.get(-d));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;Integer, Integer&gt; <span class="title">make</span><span class="params">(<span class="keyword">int</span>[] A)</span> </span>&#123;</span><br><span class="line">        Point[] dp = <span class="keyword">new</span> Point[<span class="number">60000</span>];</span><br><span class="line">        <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">        dp[t++] = <span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> v: A) &#123;</span><br><span class="line">            <span class="keyword">int</span> stop = t;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stop; ++i) &#123;</span><br><span class="line">                Point p = dp[i];</span><br><span class="line">                dp[t++] = <span class="keyword">new</span> Point(p.x + v, p.y);</span><br><span class="line">                dp[t++] = <span class="keyword">new</span> Point(p.x, p.y + v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Map&lt;Integer, Integer&gt; ans = <span class="keyword">new</span> HashMap();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> a = dp[i].x;</span><br><span class="line">            <span class="keyword">int</span> b = dp[i].y;</span><br><span class="line">            ans.put(a-b, Math.max(ans.getOrDefault(a-b, <span class="number">0</span>), a));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/29/691-Stickers-to-Spell-Word/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/29/691-Stickers-to-Spell-Word/" itemprop="url">691. Stickers to Spell Word</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-29T00:50:00+08:00">2020-01-29</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-29T01:28:53+08:00">2020-01-29</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="691-stickers-to-spell-word"><a class="header-anchor" href="#691-stickers-to-spell-word">¶</a><a href="https://leetcode.com/problems/stickers-to-spell-word/" target="_blank" rel="noopener">691. Stickers to Spell Word</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>We are given N different types of stickers. Each sticker has a lowercase English word on it.</p>
<p>You would like to spell out the given <code>target</code> string by cutting individual letters from your collection of stickers and rearranging them.</p>
<p>You can use each sticker more than once if you want, and you have infinite quantities of each sticker.</p>
<p>What is the minimum number of stickers that you need to spell out the <code>target</code>? If the task is impossible, return -1.</p>
<p><strong>Example 1:</strong></p>
<p>Input:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;with&quot;, &quot;example&quot;, &quot;science&quot;], &quot;thehat&quot;</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>
<p>Explanation:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We can use 2 &quot;with&quot; stickers, and 1 &quot;example&quot; sticker.</span><br><span class="line">After cutting and rearrange the letters of those stickers, we can form the target &quot;thehat&quot;.</span><br><span class="line">Also, this is the minimum number of stickers necessary to form the target string.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<p>Input:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;notice&quot;, &quot;possible&quot;], &quot;basicbasic&quot;</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1</span><br></pre></td></tr></table></figure>
<p>Explanation:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We can&apos;t form the target &quot;basicbasic&quot; from cutting letters from the given stickers.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li><code>stickers</code> has length in the range <code>[1, 50]</code>.*   <code>stickers</code> consists of lowercase English words (without apostrophes).*   <code>target</code> has length in the range <code>[1, 15]</code>, and consists of lowercase English letters.*   In all test cases, all words were chosen <u style="display: inline;">randomly</u> from the 1000 most common US English words, and the target was chosen as a concatenation of two random words.*   The time limit may be more challenging than usual. It is expected that a 50 sticker test case can be solved within 35ms on average.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-状态压缩-bfs"><a class="header-anchor" href="#法一-状态压缩-bfs">¶</a>法一 状态压缩 BFS</h5>
<p>  BFS搜索，状态压缩，用整数的位代表对应字符位置上的字符是否消去。每次用一张贴纸，改变状态后入队，直到状态值为0（代表所有的字符都已经消去）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minStickers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; stickers, <span class="built_in">string</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; <span class="built_in">map</span>&#123;stickers.size(), <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">26</span>, <span class="number">0</span>)&#125;; <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sum(<span class="number">26</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=stickers.size()<span class="number">-1</span>; i++) <span class="keyword">for</span> (<span class="keyword">auto</span> c: stickers[i]) &#123;<span class="built_in">map</span>[i][c-<span class="string">'a'</span>]++; sum[c-<span class="string">'a'</span>]++; &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=target.size()<span class="number">-1</span>; i++) &#123;<span class="keyword">if</span> (!sum[target[i]-<span class="string">'a'</span>]) <span class="keyword">return</span> <span class="number">-1</span>;&#125;</span><br><span class="line">​</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; vis;</span><br><span class="line">​</span><br><span class="line">        <span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">        q.push( &#123;(<span class="number">1</span>&lt;&lt;target.size())<span class="number">-1</span>, <span class="number">0</span>&#125; );</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mypair = q.front(); q.pop();</span><br><span class="line">            <span class="keyword">auto</span> tar_ = mypair.first; <span class="keyword">auto</span> level = mypair.second; <span class="keyword">int</span> start=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(!vis[tar_]) vis[tar_]=<span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">while</span>(start&lt;=target.size()<span class="number">-1</span>) <span class="keyword">if</span>(!(tar_&gt;&gt;start &amp; <span class="number">1</span>)) start++; <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span> (start == target.size()) <span class="keyword">return</span> level;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=stickers.size()<span class="number">-1</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">map</span>[i][target[target.size()<span class="number">-1</span>-start]-<span class="string">'a'</span>]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="function"><span class="keyword">auto</span> <span class="title">target_cp</span><span class="params">(tar_)</span></span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;=stickers[i].size()<span class="number">-1</span>; j++)</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> r=start; r&lt;=target.size()<span class="number">-1</span>; r++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (target[target.size()<span class="number">-1</span>-r] == stickers[i][j] &amp;&amp; ((target_cp &gt;&gt; r) &amp; <span class="number">1</span>)) &#123; <span class="comment">//could apply 只消去一个字符，因为每次只用一张贴纸</span></span><br><span class="line">                            target_cp ^= (<span class="number">1</span> &lt;&lt; r);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                q.push(&#123;target_cp, level+<span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dfs-优化"><a class="header-anchor" href="#法二-dfs-优化">¶</a>法二 dfs + 优化</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> best;</span><br><span class="line">    <span class="keyword">int</span>[][] stickersCount;</span><br><span class="line">    <span class="keyword">int</span>[] targetCount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> ans, <span class="keyword">int</span> row)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ans &gt;= best) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (row == stickersCount.length) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> c: targetCount) <span class="keyword">if</span> (c &gt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">            best = ans;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> used = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stickersCount[row].length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (targetCount[i] &gt; <span class="number">0</span> &amp;&amp; stickersCount[row][i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                used = Math.max(used, (targetCount[i] - <span class="number">1</span>) / stickersCount[row][i] + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stickersCount[row].length; i++) &#123;</span><br><span class="line">            targetCount[i] -= used * stickersCount[row][i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        search(ans + used, row + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (used &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stickersCount[row].length; i++) &#123;</span><br><span class="line">                targetCount[i] += stickersCount[row][i];</span><br><span class="line">            &#125;</span><br><span class="line">            used--;</span><br><span class="line">            search(ans + used, row + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minStickers</span><span class="params">(String[] stickers, String target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] targetNaiveCount = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c: target.toCharArray()) targetNaiveCount[c - <span class="string">'a'</span>]++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] index = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (targetNaiveCount[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                index[i] = t++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                index[i] = -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        targetCount = <span class="keyword">new</span> <span class="keyword">int</span>[t];</span><br><span class="line">        t = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c: targetNaiveCount) <span class="keyword">if</span> (c &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            targetCount[t++] = c;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stickersCount = <span class="keyword">new</span> <span class="keyword">int</span>[stickers.length][t];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stickers.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">char</span> c: stickers[i].toCharArray()) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = index[c - <span class="string">'a'</span>];</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= <span class="number">0</span>) stickersCount[i][j]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> anchor = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stickers.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = anchor; j &lt; stickers.length; j++) <span class="keyword">if</span> (j != i) &#123;</span><br><span class="line">                <span class="keyword">boolean</span> dominated = <span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; t; k++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (stickersCount[i][k] &gt; stickersCount[j][k]) &#123;</span><br><span class="line">                        dominated = <span class="keyword">false</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (dominated) &#123;</span><br><span class="line">                    <span class="keyword">int</span>[] tmp = stickersCount[i];</span><br><span class="line">                    stickersCount[i] = stickersCount[anchor];</span><br><span class="line">                    stickersCount[anchor++] = tmp;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        best = target.length() + <span class="number">1</span>;</span><br><span class="line">        search(<span class="number">0</span>, anchor);</span><br><span class="line">        <span class="keyword">return</span> best &lt;= target.length() ? best : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="法三-状态压缩-dp"><a class="header-anchor" href="#法三-状态压缩-dp">¶</a>法三 状态压缩 dp</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minStickers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; stickers, <span class="built_in">string</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">1</span>&lt;&lt;target.size()];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span> ; i &lt; (<span class="number">1</span>&lt;&lt;target.size()); ++i) dp[i] = <span class="number">-1</span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span>&lt;&lt;target.size()); ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[i] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">string</span> &amp; s : stickers)&#123;</span><br><span class="line">                <span class="keyword">int</span> now = i;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; s.size(); ++j)&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;target.size(); ++k)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(!((<span class="number">1</span>&lt;&lt;k)&amp;now) &amp;&amp; target[k] == s[j])&#123;</span><br><span class="line">                            now |= <span class="number">1</span>&lt;&lt;k;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(dp[now]==<span class="number">-1</span>||dp[now] &gt; dp[i] + <span class="number">1</span>) dp[now] = dp[i] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[(<span class="number">1</span>&lt;&lt;target.size()) <span class="number">-1</span> ] ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法四-dfs"><a class="header-anchor" href="#法四-dfs">¶</a>法四 dfs</h5>
<p>  因为使用贴纸的顺序随意，所以可以人为规定顺序，比如从前往后消除字符以减小搜索空间，比如<code>if (m[i][target[0] - 'a'] == 0) continue;</code>这一句，就表示如果不能消除字符串的第一个字符就跳过当前贴纸，这样并不影响最终找到最小的贴纸数，因为只要是能消去所有字符的贴纸的组合，都可以调整使用贴纸的顺序使得满足从前往后消除这个顺序。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">array</span>&lt;<span class="keyword">int</span>,26&gt;&gt; m;</span><br><span class="line">    <span class="comment">// key thinking: cache technique!</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// why use remaining target string as value key instead of current histogram?</span></span><br><span class="line">    <span class="comment">// because eventually the result count is decided by what remains,</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// not what we have accumulated. eg, if we have 1000 a for one histogram and 999 a for another</span></span><br><span class="line">    <span class="comment">// and the target only requires 3a, this twos count will be the same</span></span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; dp;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(target.empty()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (dp.count(target)) <span class="keyword">return</span> dp[target];</span><br><span class="line">		<span class="keyword">auto</span> res = INT_MAX;</span><br><span class="line">        <span class="built_in">array</span>&lt;<span class="keyword">int</span>,26&gt; hist&#123;&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> c : target) ++hist[c - <span class="string">'a'</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (m[i][target[<span class="number">0</span>] - <span class="string">'a'</span>] == <span class="number">0</span>) <span class="keyword">continue</span>; <span class="comment">// progression guarantee!</span></span><br><span class="line">            <span class="comment">// we just use first char as progression guarantee, it's fine if we cannot totally</span></span><br><span class="line">            <span class="comment">// eliminate this round, but this ensures we will progress for each turn</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// construct the histogram after elimination</span></span><br><span class="line">			<span class="built_in">string</span> next;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; ++j) </span><br><span class="line">				<span class="keyword">if</span> (hist[j] - m[i][j] &gt; <span class="number">0</span>)</span><br><span class="line">                    next += <span class="built_in">string</span>(hist[j] - m[i][j], <span class="string">'a'</span> + j); </span><br><span class="line">            <span class="comment">// get count using new histogram</span></span><br><span class="line">            <span class="keyword">int</span> cnt = dfs(next);</span><br><span class="line">			<span class="keyword">if</span> ( cnt != <span class="number">-1</span>) res = min(res, cnt + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		dp[target] = res == INT_MAX ? <span class="number">-1</span> : res;</span><br><span class="line">		<span class="keyword">return</span> dp[target];</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minStickers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; stickers, <span class="built_in">string</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = stickers.size();</span><br><span class="line">        </span><br><span class="line">        m.resize(n, &#123;&#123;&#125;&#125;);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> c : stickers[i]) </span><br><span class="line">				++m[i][c - <span class="string">'a'</span>];</span><br><span class="line">		<span class="keyword">return</span> dfs(target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h2>
<p>  每次遇到这种能<strong>压缩状态</strong>的搜索问题都反应不过来，以后做题要先看好数据量，只要是小于32都要看看是否能用位运算来表示状态。另外这道题我上来就想着直接在字符计数数组上操作（终止条件是所有字符计数值都为0，每次需要判断应用一个贴纸后计数值有没有变化和是否已经消除完所有字符），却没想到将计数数组转换为字符串作为dfs的参数，并且也没想到可以通过规定消除字符的顺序来剪枝。下面是我的代码，代码量大，效率也低。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; chr;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minStickers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; stickers, <span class="built_in">string</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; sti_cnt;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tg_cnt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> cnt[<span class="number">26</span>]&#123;&#125;, idx[<span class="number">26</span>]&#123;&#125;;</span><br><span class="line"></span><br><span class="line">        fill(idx, idx+<span class="number">26</span>, <span class="number">-1</span>);</span><br><span class="line">        </span><br><span class="line">        ans = INT_MAX; </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">bool</span> f1 = <span class="literal">false</span>;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;c:target)&#123;</span><br><span class="line">            cnt[c - <span class="string">'a'</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;i &lt; <span class="number">26</span>;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                idx[i]=j++;</span><br><span class="line">                tg_cnt.push_back(cnt[i]);</span><br><span class="line">                chr.push_back(<span class="string">'a'</span>+i);</span><br><span class="line">                cnt[i] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;s : stickers) &#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cnt_(tg_cnt.size());</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;c : s)&#123;</span><br><span class="line">                <span class="keyword">if</span>(idx[c - <span class="string">'a'</span>] == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                cnt[idx[c - <span class="string">'a'</span>]]++;</span><br><span class="line">                cnt_[idx[c -<span class="string">'a'</span>]]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">bool</span> f=<span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tg_cnt.size(); ++i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(tg_cnt[i] != <span class="number">0</span> &amp;&amp; cnt_[i] != <span class="number">0</span>) </span><br><span class="line">                    f=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!f) <span class="keyword">continue</span>;</span><br><span class="line">            f=<span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;sti_cnt.size();++i)&#123;</span><br><span class="line">                f=<span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; tg_cnt.size(); ++j)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(cnt_[j] &lt; sti_cnt[i][j])&#123;</span><br><span class="line">                        f=<span class="literal">false</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(f) &#123;</span><br><span class="line">                    sti_cnt[i] = cnt_;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!f) sti_cnt.push_back(cnt_);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tg_cnt.size();++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt[i] == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; sti_cnt.size() &lt;&lt; endl;</span></span><br><span class="line">        </span><br><span class="line">        m[<span class="string">""</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> dfs(sti_cnt, tg_cnt, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;sti_cnt, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;tg_cnt, <span class="keyword">int</span> cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rec[tg_cnt.size()]&#123;&#125;, ret = INT_MAX;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">bool</span> f = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">string</span> k = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tg_cnt.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tg_cnt[i] != <span class="number">0</span>)&#123;</span><br><span class="line">                f=<span class="literal">true</span>;</span><br><span class="line">                k.append(tg_cnt[i], chr[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// if(cnt &gt;= ans) return ret;</span></span><br><span class="line">        <span class="keyword">if</span>(!f) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> it = m.find(k);</span><br><span class="line">        <span class="keyword">if</span>(it != m.end()) <span class="keyword">return</span> it-&gt;second;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sti_cnt.size(); ++i)&#123;</span><br><span class="line">            f = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; tg_cnt.size(); ++j)&#123;</span><br><span class="line">                rec[j] = tg_cnt[j];</span><br><span class="line">                <span class="keyword">if</span>(tg_cnt[j] != <span class="number">0</span> &amp;&amp; sti_cnt[i][j] != <span class="number">0</span>)</span><br><span class="line">                    f = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!f) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; tg_cnt.size(); ++j)&#123;</span><br><span class="line">                tg_cnt[j] = max(<span class="number">0</span>, tg_cnt[j] - sti_cnt[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> t = dfs(sti_cnt, tg_cnt, cnt + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(t != INT_MAX)&#123;</span><br><span class="line">                ret = min(ret, t + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(cnt == <span class="number">0</span>) ans = ret;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; tg_cnt.size(); ++j)&#123;</span><br><span class="line">                tg_cnt[j] = rec[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m[k]=ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  对于涉及搜索的题目，解题关键在于:</p>
<ol>
<li>如何保存中间状态的值（用的key是什么，比如这一题用的key可以是状态state，也可以是字符串）。</li>
<li>是否搜索顺序是否影响结果（不影响的话认为规定顺序这样比较方便剪枝）。</li>
<li>如何表示状态更高效（数据量是否适合状态压缩）。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/28/675-Cut-Off-Trees-for-Golf-Event-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/28/675-Cut-Off-Trees-for-Golf-Event-1/" itemprop="url">675. Cut Off Trees for Golf Event</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-28T15:04:02+08:00">2020-01-28</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-28T17:50:33+08:00">2020-01-28</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="675-cut-off-trees-for-golf-event"><a class="header-anchor" href="#675-cut-off-trees-for-golf-event">¶</a><a href="https://leetcode.com/problems/cut-off-trees-for-golf-event/" target="_blank" rel="noopener">675. Cut Off Trees for Golf Event</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>You are asked to cut off trees in a forest for a golf event. The forest is represented as a non-negative 2D map, in this map:</p>
<ol>
<li><code>0</code> represents the <code>obstacle</code> can’t be reached.</li>
<li><code>1</code> represents the <code>ground</code> can be walked through.</li>
<li><code>The place with number bigger than 1</code> represents a <code>tree</code> can be walked through, and this positive number represents the tree’s height.</li>
</ol>
<p>You are asked to cut off <strong>all</strong> the trees in this forest in the order of tree’s height - always cut off the tree with lowest height first. And after cutting, the original place has the tree will become a grass (value 1).</p>
<p>You will start from the point (0, 0) and you should output the minimum steps <strong>you need to walk</strong> to cut off all the trees. If you can’t cut off all the trees, output -1 in that situation.</p>
<p>You are guaranteed that no two <code>trees</code> have the same height and there is at least one tree needs to be cut off.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">[</span><br><span class="line"> [1,2,3],</span><br><span class="line"> [0,0,4],</span><br><span class="line"> [7,6,5]</span><br><span class="line">]</span><br><span class="line">Output: 6</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">[</span><br><span class="line"> [1,2,3],</span><br><span class="line"> [0,0,0],</span><br><span class="line"> [7,6,5]</span><br><span class="line">]</span><br><span class="line">Output: -1</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Input: </span><br><span class="line">[</span><br><span class="line"> [2,3,4],</span><br><span class="line"> [0,0,5],</span><br><span class="line"> [8,7,6]</span><br><span class="line">]</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: You started from the point (0,0) and you can cut off the tree in (0,0) directly without walking.</span><br></pre></td></tr></table></figure>
<p><strong>Hint</strong>: size of the given matrix will not exceed 50x50.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-hadlock算法"><a class="header-anchor" href="#法一-hadlock算法">¶</a>法一 hadlock算法</h5>
<p>  按照哈夫曼距离来进行bfs，每次都朝着target的方向bfs，先把所有可能的不折返的路径搜索完，如果还没找到终点，说明至少要进行一次折返，一旦进行了折返就会导致最终的距离增加2。注意，一个点可能多次访问（因为可能折返回到该点，但是一旦从该点折返过，以后就不能再从该点折返过了，不卖两次后悔药），所以只有在该点扩展时才标记为visited，而不是该点入队时标记。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;, dy[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y, h;</span><br><span class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Node &amp;n)&#123;</span><br><span class="line">            <span class="keyword">return</span> h &lt; n.h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">hadlock</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; forest, <span class="keyword">int</span> sx, <span class="keyword">int</span> sy, <span class="keyword">int</span> tx, <span class="keyword">int</span> ty)</span></span>&#123;</span><br><span class="line">        <span class="built_in">deque</span>&lt;tuple&lt;<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        <span class="keyword">int</span> r = forest.size(), c= forest.back().size();</span><br><span class="line">        <span class="keyword">int</span> vis[r * c]&#123;&#125;;</span><br><span class="line">        </span><br><span class="line">        q.push_front(&#123;sx, sy, <span class="built_in">abs</span>(tx-sx)+<span class="built_in">abs</span>(ty-sy)&#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// vis[sx * c + sy] = 1;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> [x, y, d] = q.front(); q.pop_front();</span><br><span class="line">            <span class="keyword">if</span>(vis[x*c+y]) <span class="keyword">continue</span>;</span><br><span class="line">            vis[x*c+y]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(x == tx &amp;&amp; y == ty) <span class="keyword">return</span> d;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ;i &lt; <span class="number">4</span>; ++i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(x+dx[i] &gt;= <span class="number">0</span>&amp;&amp; x + dx[i] &lt;r &amp;&amp;</span><br><span class="line">                  y+dy[i] &gt;= <span class="number">0</span>&amp;&amp; y+dy[i] &lt; c&amp;&amp;forest[x+dx[i]][y+dy[i]])&#123;</span><br><span class="line">                    <span class="keyword">bool</span> closer = </span><br><span class="line">                        <span class="built_in">abs</span>(x+dx[i] - tx)+<span class="built_in">abs</span>(y+dy[i] - ty) &lt; <span class="built_in">abs</span>(x - tx)+<span class="built_in">abs</span>(y - ty);</span><br><span class="line">                    <span class="keyword">if</span>(closer)&#123;</span><br><span class="line">                        q.push_front(&#123;x+dx[i], y+dy[i], d&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        q.push_back(&#123;x+dx[i], y+dy[i], d+<span class="number">2</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">cutOffTree</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; forest)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Node&gt; tr;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ;i &lt; forest.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>;j &lt; forest.back().size();++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(forest[i][j]&gt;<span class="number">1</span>)</span><br><span class="line">                    tr.push_back(&#123;i, j, forest[i][j]&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sort(tr.begin(), tr.end());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>, sx = <span class="number">0</span>, sy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tr.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> t = hadlock(forest, sx, sy, tr[i].x, tr[i].y);</span><br><span class="line">            <span class="comment">// cout &lt;&lt; t &lt;&lt; " ";</span></span><br><span class="line">            <span class="keyword">if</span>(t == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            ans += t;</span><br><span class="line">            sx = tr[i].x, sy = tr[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-普通bfs"><a class="header-anchor" href="#法二-普通bfs">¶</a>法二 普通BFS</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">cutOffTree</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; forest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rows = forest.size();</span><br><span class="line">        <span class="keyword">int</span> cols = rows ? forest[<span class="number">0</span>].size() : <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!rows || !cols) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Start location is blocked</span></span><br><span class="line">        <span class="keyword">if</span> (forest[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Min queue of trees based on height</span></span><br><span class="line">         priority_queue&lt;pair&lt;<span class="keyword">int</span>, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;, <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&gt;, greater&lt;pair&lt;<span class="keyword">int</span>, pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&gt;&gt; trees;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; rows; ++r) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; cols; ++c) &#123;</span><br><span class="line">                <span class="keyword">if</span> (forest[r][c] &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                   trees.push(&#123;forest[r][c], &#123;r, c&#125;&#125;); </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Legal moves</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; moves = &#123;&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Track visited</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; visited(rows, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(cols, <span class="number">-1</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Total distance</span></span><br><span class="line">        <span class="keyword">int</span> totalDist = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Start location</span></span><br><span class="line">        pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; start = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Tree ID</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Iterate through trees in increasing height order</span></span><br><span class="line">        <span class="keyword">while</span> (!trees.empty()) &#123;</span><br><span class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; to = trees.top().second;</span><br><span class="line">            trees.pop();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Level order traversal</span></span><br><span class="line">            <span class="keyword">bool</span> found = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">int</span> dist = <span class="number">-1</span>;  </span><br><span class="line">            <span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; qu;</span><br><span class="line">            </span><br><span class="line">            qu.push(&#123;start.first, start.second&#125;);</span><br><span class="line">            visited[start.first][start.second] = i;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> (!qu.empty() &amp;&amp; !found) &#123;</span><br><span class="line">                ++dist;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, r, c, size = qu.size(); j &lt; size &amp;&amp; !found; ++j) &#123;</span><br><span class="line">                    tie(r, c) = qu.front();</span><br><span class="line">                    qu.pop();</span><br><span class="line">                </span><br><span class="line">                    <span class="comment">// Break if target location found</span></span><br><span class="line">                    <span class="keyword">if</span> (r == to.first &amp;&amp; c == to.second) &#123;</span><br><span class="line">                        found = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                </span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>, nr, nc; m &lt; <span class="number">4</span>; ++m) &#123;</span><br><span class="line">                        <span class="comment">// New location</span></span><br><span class="line">                        nr = r + moves[m].first;</span><br><span class="line">                        nc = c + moves[m].second;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// Skip out of bound, blockages and already scheduled</span></span><br><span class="line">                        <span class="keyword">if</span> (nr &lt; <span class="number">0</span> || nr &gt;= rows || nc &lt; <span class="number">0</span> || nc &gt;= cols || visited[nr][nc] == i || forest[nr][nc] == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                            </span><br><span class="line">                        <span class="comment">// Mark visited asap otherwise it will be scheduled mutiple times</span></span><br><span class="line">                        visited[nr][nc] = i;</span><br><span class="line">                        qu.push(&#123;nr, nc&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Return if not found</span></span><br><span class="line">            <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Update total distance</span></span><br><span class="line">            totalDist += dist;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Update start</span></span><br><span class="line">            start = to;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// Update id</span></span><br><span class="line">            ++i;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> totalDist;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-a-star算法"><a class="header-anchor" href="#法三-a-star算法">¶</a>法三 A star算法</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> dx[<span class="number">4</span>]=&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>&#125;, dy[<span class="number">4</span>]=&#123;<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> x, y, h;</span><br><span class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Tree &amp;t)&#123;</span><br><span class="line">            <span class="keyword">return</span> h &lt; t.h;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">cutOffTree</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; forest)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> r = forest.size(), c= forest.back().size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;Tree&gt; tree;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">0</span>;i &lt; r;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">0</span>; j &lt; c; ++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(forest[i][j] &gt; <span class="number">1</span>)</span><br><span class="line">                    tree.push_back(&#123;i, j, forest[i][j]&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(tree.begin(), tree.end());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>, sx = <span class="number">0</span>, sy= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ;i &lt; tree.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> ret = aStar(forest, sx, sy, tree[i].x, tree[i].y);</span><br><span class="line">            <span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            ans += ret;</span><br><span class="line">            sx = tree[i].x, sy= tree[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">aStar</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;forest, <span class="keyword">int</span> sx, <span class="keyword">int</span> sy, <span class="keyword">int</span> tx, <span class="keyword">int</span> ty)</span></span>&#123;</span><br><span class="line">        priority_queue&lt;tuple&lt;<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        q.push(&#123; -(<span class="built_in">abs</span>(tx - sx)+<span class="built_in">abs</span>(ty - sy)), <span class="number">0</span>, sx, sy&#125;);</span><br><span class="line">        <span class="keyword">int</span> r = forest.size(), c= forest[<span class="number">0</span>].size();</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; cost;</span><br><span class="line">        cost[sx * c + sy] = <span class="built_in">abs</span>(tx - sx)+<span class="built_in">abs</span>(ty - sy);</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> [f, d, x, y] = q.top(); q.pop();</span><br><span class="line">            f = -f;</span><br><span class="line">            <span class="keyword">if</span>(x == tx &amp;&amp; y == ty) <span class="keyword">return</span> d;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)&#123;</span><br><span class="line">                <span class="keyword">int</span> nx = x +dx[i];</span><br><span class="line">                <span class="keyword">int</span> ny = y +dy[i];</span><br><span class="line">                <span class="keyword">if</span>(nx &lt; <span class="number">0</span>||nx&gt;= r || ny &lt; <span class="number">0</span> || ny &gt;= c|| !forest[nx][ny])&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> ncost = <span class="built_in">abs</span>(nx - tx) + <span class="built_in">abs</span>(ny - ty) + d + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(cost.find(nx * c + ny) == cost.end() || cost[nx *c + ny] &gt; ncost)&#123;</span><br><span class="line">                    cost[nx *c + ny] = ncost;</span><br><span class="line">                    q.push(&#123;-ncost, d+<span class="number">1</span>, nx, ny &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/28/1028-Recover-a-Tree-From-Preorder-Traversal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/28/1028-Recover-a-Tree-From-Preorder-Traversal/" itemprop="url">1028. Recover a Tree From Preorder Traversal</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-28T00:29:13+08:00">2020-01-28</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-28T00:52:09+08:00">2020-01-28</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1028-recover-a-tree-from-preorder-traversal"><a class="header-anchor" href="#1028-recover-a-tree-from-preorder-traversal">¶</a><a href="https://leetcode.com/problems/recover-a-tree-from-preorder-traversal/" target="_blank" rel="noopener">1028. Recover a Tree From Preorder Traversal</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>We run a preorder depth first search on the <code>root</code> of a binary tree.</p>
<p>At each node in this traversal, we output <code>D</code> dashes (where <code>D</code> is the <em>depth</em> of this node), then we output the value of this node.  <em>(If the depth of a node is <code>D</code>, the depth of its immediate child is <code>D+1</code>.  The depth of the root node is <code>0</code>.)</em></p>
<p>If a node has only one child, that child is guaranteed to be the left child.</p>
<p>Given the output <code>S</code> of this traversal, recover the tree and return its <code>root</code>.</p>
<p><strong>Example 1:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/04/08/recover-a-tree-from-preorder-traversal.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;1-2--3--4-5--6--7&quot;</span><br><span class="line">Output: [1,2,5,3,4,6,7]</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/04/11/screen-shot-2019-04-10-at-114101-pm.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;1-2--3---4-5--6---7&quot;</span><br><span class="line">Output: [1,2,5,3,null,6,null,4,null,7]</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2019/04/11/screen-shot-2019-04-10-at-114955-pm.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;1-401--349---90--88&quot;</span><br><span class="line">Output: [1,401,null,349,88,90]</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li>The number of nodes in the original tree is between <code>1</code> and <code>1000</code>.</li>
<li>Each node will have a value between <code>1</code> and <code>10^9</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-栈"><a class="header-anchor" href="#法一-栈">¶</a>法一 栈</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        TreeNode *node;</span><br><span class="line">        <span class="keyword">int</span> depth;</span><br><span class="line">        Node(TreeNode *x, <span class="keyword">int</span> d): node(x), depth(d)&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">recoverFromPreorder</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = S.size();</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j, k;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        TreeNode *root;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; n &amp;&amp; S[i] != <span class="string">'-'</span>) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        root = <span class="keyword">new</span> TreeNode(stoi(S.substr(<span class="number">0</span>, i)));</span><br><span class="line">        <span class="function">Node <span class="title">n1</span><span class="params">(root, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="built_in">stack</span>&lt;Node&gt; st;</span><br><span class="line">        st.push(n1);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(!st.empty() &amp;&amp; i &lt; n) &#123;</span><br><span class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(i &lt; n &amp;&amp; S[i] == <span class="string">'-'</span>) &#123;</span><br><span class="line">                i++;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">           j = i; k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(i &lt; n &amp;&amp; S[i] != <span class="string">'-'</span>) &#123;</span><br><span class="line">                i++;</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">            val = stoi(S.substr(j, k));</span><br><span class="line">            <span class="comment">// Node n1;</span></span><br><span class="line">            <span class="keyword">while</span>(!st.empty()) &#123;</span><br><span class="line">                n1 = st.top();</span><br><span class="line">                <span class="keyword">if</span>(n1.depth &gt;= count) &#123;</span><br><span class="line">                    st.pop();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            TreeNode *temp = <span class="keyword">new</span> TreeNode(val);</span><br><span class="line">            <span class="keyword">if</span>(n1.node-&gt;left == <span class="literal">NULL</span>) &#123;</span><br><span class="line">                n1.node-&gt;left = temp;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                n1.node-&gt;right = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function">Node <span class="title">n2</span><span class="params">(temp, count)</span></span>;</span><br><span class="line">            st.push(n2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dfs"><a class="header-anchor" href="#法二-dfs">¶</a>法二 dfs</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorder_traversal</span><span class="params">(TreeNode* cur, <span class="keyword">const</span> <span class="built_in">string</span>&amp; S, <span class="keyword">int</span>&amp; index, <span class="keyword">const</span> <span class="keyword">int</span> cur_depth, <span class="keyword">int</span>&amp; elem_depth, <span class="keyword">int</span>&amp; elem_val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur_depth == elem_depth)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(index == S.length()) </span><br><span class="line">            &#123;</span><br><span class="line">                elem_depth = <span class="number">-1</span>;   </span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            elem_depth = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(S[index] == <span class="string">'-'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                elem_depth++;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> begin_sub = index;</span><br><span class="line">            <span class="keyword">while</span>(index != S.length() &amp;&amp; S[index] != <span class="string">'-'</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">            elem_val = stoi(S.substr(begin_sub, index - begin_sub));</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> (cur_depth == elem_depth - <span class="number">1</span> &amp;&amp; cur-&gt;left == <span class="literal">NULL</span> )    </span><br><span class="line">        &#123;</span><br><span class="line">            cur-&gt;left   = <span class="keyword">new</span> TreeNode(elem_val);</span><br><span class="line">            preorder_traversal(cur-&gt;left, S, index, cur_depth + <span class="number">1</span>, elem_depth, elem_val);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cur_depth == elem_depth - <span class="number">1</span> &amp;&amp; cur-&gt;right == <span class="literal">NULL</span>)                       </span><br><span class="line">        &#123;</span><br><span class="line">            cur-&gt;right  = <span class="keyword">new</span> TreeNode(elem_val);</span><br><span class="line">            preorder_traversal(cur-&gt;right, S, index, cur_depth + <span class="number">1</span>, elem_depth, elem_val);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(cur_depth &gt; elem_depth) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">recoverFromPreorder</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(index != S.length() &amp;&amp; S[index] != <span class="string">'-'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> elem_val = stoi(S.substr(<span class="number">0</span>, index));</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> TreeNode(elem_val);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> elem_depth = <span class="number">0</span>;</span><br><span class="line">        preorder_traversal(root, S, index, <span class="number">0</span>, elem_depth, elem_val);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>简化版:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> val, dep, i;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">helper</span><span class="params">(TreeNode *root, <span class="keyword">const</span> <span class="built_in">string</span> &amp;S, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(d==dep)&#123;</span><br><span class="line">            <span class="keyword">int</span> j, k;</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="built_in">string</span>::npos)&#123;</span><br><span class="line">                dep = <span class="number">-2</span>;</span><br><span class="line">                <span class="keyword">return</span>;    </span><br><span class="line">            &#125; </span><br><span class="line">            j = S.find_first_not_of(<span class="string">"-"</span>, i); </span><br><span class="line">            dep = j-i;</span><br><span class="line">            k = S.find_first_of(<span class="string">"-"</span>,j); </span><br><span class="line">            val = stol(S.substr(j, k-j));</span><br><span class="line">            i = k;    </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(dep==d+<span class="number">1</span>&amp;&amp;!root-&gt;left)&#123;</span><br><span class="line">            root-&gt;left=<span class="keyword">new</span> TreeNode(val);</span><br><span class="line">            helper(root-&gt;left, S, d+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(dep==d+<span class="number">1</span>&amp;&amp;!root-&gt;right) &#123;</span><br><span class="line">            root-&gt;right=<span class="keyword">new</span> TreeNode(val);</span><br><span class="line">            helper(root-&gt;right, S, d+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">recoverFromPreorder</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        TreeNode *root=<span class="keyword">new</span> TreeNode(<span class="number">0</span>);</span><br><span class="line">        i=<span class="number">0</span>;</span><br><span class="line">        dep=<span class="number">-1</span>;</span><br><span class="line">        helper(root, S, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> root-&gt;left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/28/502-IPO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/28/502-IPO/" itemprop="url">502. IPO</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-28T00:07:41+08:00">2020-01-28</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-28T00:19:40+08:00">2020-01-28</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="502-ipo"><a class="header-anchor" href="#502-ipo">¶</a><a href="https://leetcode.com/problems/ipo/" target="_blank" rel="noopener">502. IPO</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Suppose LeetCode will start its IPO soon. In order to sell a good price of its shares to Venture Capital, LeetCode would like to work on some projects to increase its capital before the IPO. Since it has limited resources, it can only finish at most <strong>k</strong> distinct projects before the IPO. Help LeetCode design the best way to maximize its total capital after finishing at most <strong>k</strong> distinct projects.</p>
<p>You are given several projects. For each project <strong>i</strong>, it has a pure profit <strong>P<sub style="display: inline;">i</sub></strong> and a minimum capital of <strong>C<sub style="display: inline;">i</sub></strong> is needed to start the corresponding project. Initially, you have <strong>W</strong> capital. When you finish a project, you will obtain its pure profit and the profit will be added to your total capital.</p>
<p>To sum up, pick a list of at most <strong>k</strong> distinct projects from given projects to maximize your final capital, and output your final maximized capital.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input: k=2, W=0, Profits=[1,2,3], Capital=[0,1,1].</span><br><span class="line"></span><br><span class="line">Output: 4</span><br><span class="line"></span><br><span class="line">Explanation: Since your initial capital is 0, you can only start the project indexed 0.</span><br><span class="line">             After finishing it you will obtain profit 1 and your capital becomes 1.</span><br><span class="line">             With capital 1, you can either start the project indexed 1 or the project indexed 2.</span><br><span class="line">             Since you can choose at most 2 projects, you need to finish the project indexed 2 to get the maximum capital.</span><br><span class="line">             Therefore, output the final maximized capital, which is 0 + 1 + 3 = 4.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>You may assume all numbers in the input are non-negative integers.</li>
<li>The length of Profits array and Capital array will not exceed 50,000.</li>
<li>The answer is guaranteed to fit in a 32-bit signed integer.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-贪心"><a class="header-anchor" href="#法一-贪心">¶</a>法一 贪心</h5>
<p>  每次选取利润最大的可行工程，然后将其capital改为INT_MAX，代表该工程执行完被丢弃。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMaximizedCapital</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> W, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Profits, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Capital)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// to speed up: if all projects are available</span></span><br><span class="line">        <span class="keyword">bool</span> speedUp = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c: Capital) <span class="keyword">if</span> (W &lt; c) speedUp = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (speedUp) &#123;</span><br><span class="line">            priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; heap;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p: Profits) &#123;</span><br><span class="line">                heap.push(p);</span><br><span class="line">                <span class="keyword">if</span> (heap.size() &gt; k) heap.pop();    </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(!heap.empty()) &#123;</span><br><span class="line">                W += heap.top(); </span><br><span class="line">                heap.pop();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> W;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> idx;</span><br><span class="line">        <span class="keyword">int</span> n = Profits.size();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; min(k, n); ++i) &#123;</span><br><span class="line">            idx = <span class="number">-1</span>; </span><br><span class="line">            <span class="comment">// if there are available projects,</span></span><br><span class="line">            <span class="comment">// pick the most profitable one</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123; </span><br><span class="line">                <span class="keyword">if</span> (W &gt;= Capital[j]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (idx == <span class="number">-1</span> ) idx = j;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (Profits[idx] &lt; Profits[j]) idx = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// not enough capital to start any project</span></span><br><span class="line">            <span class="keyword">if</span>(idx == <span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// add the profit from chosen project</span></span><br><span class="line">            <span class="comment">// and remove the project from further consideration</span></span><br><span class="line">            W += Profits[idx];</span><br><span class="line">            Capital[idx] = INT_MAX;                </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  W;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-优先级队列"><a class="header-anchor" href="#法二-优先级队列">¶</a>法二 优先级队列</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMaximizedCapital</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> W, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Profits, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Capital)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// to speed up: if all projects are available</span></span><br><span class="line">        <span class="keyword">bool</span> speedUp = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c: Capital) <span class="keyword">if</span> (W &lt; c) speedUp = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (speedUp) &#123;</span><br><span class="line">          priority_queue&lt;<span class="keyword">int</span> ,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; heap;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> p: Profits) &#123;</span><br><span class="line">            heap.push(p);</span><br><span class="line">            <span class="keyword">if</span> (heap.size() &gt; k) heap.pop();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span>(!heap.empty()) &#123;</span><br><span class="line">              W += heap.top();</span><br><span class="line">              heap.pop();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> W;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n = Profits.size();</span><br><span class="line">        <span class="comment">// sort the projects</span></span><br><span class="line">        <span class="comment">// the most available (= the smallest capital) is the head of the heap</span></span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; projects;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">          projects.push(&#123;-Capital[i], Profits[i]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// max heap</span></span><br><span class="line">        priority_queue&lt;<span class="keyword">int</span>&gt; available;</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="comment">// update available projects</span></span><br><span class="line">          <span class="keyword">while</span> (!projects.empty() &amp;&amp; -projects.top().first &lt;= W)&#123;</span><br><span class="line">              available.push(projects.top().second);</span><br><span class="line">              projects.pop();</span><br><span class="line">          &#125;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">          <span class="comment">// if there are available projects,</span></span><br><span class="line">          <span class="comment">// pick the most profitable one</span></span><br><span class="line">          <span class="keyword">if</span> (!available.empty()) &#123;</span><br><span class="line">              W += available.top();</span><br><span class="line">              available.pop();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// not enough capital to start any project</span></span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">          --k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> W;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-大小堆"><a class="header-anchor" href="#法三-大小堆">¶</a>法三 大小堆</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMaximizedCapital</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> W, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; P, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; C)</span> </span>&#123;</span><br><span class="line">      priority_queue&lt;<span class="keyword">int</span>&gt; low;      <span class="comment">// P[i]'s within current W</span></span><br><span class="line">      <span class="built_in">multiset</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; high; <span class="comment">// (C[i],P[i])'s' outside current W</span></span><br><span class="line">      </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; P.size(); ++i) <span class="comment">// initialize low and high</span></span><br><span class="line">        <span class="keyword">if</span>(P[i] &gt; <span class="number">0</span>) <span class="keyword">if</span> (C[i] &lt;= W) low.push(P[i]); <span class="keyword">else</span> high.emplace(C[i], P[i]);</span><br><span class="line">    </span><br><span class="line">      <span class="keyword">while</span> (k-- &amp;&amp; low.size()) &#123; </span><br><span class="line">        W += low.top(), low.pop(); <span class="comment">// greedy to work on most profitable first</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = high.begin(); high.size() &amp;&amp; i-&gt;first &lt;= W; i = high.erase(i)) low.push(i-&gt;second);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> W;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法四-按capital排序-按profits构建大顶堆"><a class="header-anchor" href="#法四-按capital排序-按profits构建大顶堆">¶</a>法四 按capital排序，按profits构建大顶堆</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ar[<span class="number">50009</span>];</span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>&gt; pq;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMaximizedCapital</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> W, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Profits, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; Capital)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">0</span>, taken = <span class="number">0</span>, n = Profits.size(), capital = W, topProfit;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            ar[i] = make_pair(Capital[i],Profits[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sort(ar, ar + n);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(; cur &lt; n &amp;&amp; ar[cur].first &lt;= capital; cur++)&#123;</span><br><span class="line">                pq.push(ar[cur].second);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!pq.empty())&#123;</span><br><span class="line">                topProfit = pq.top();</span><br><span class="line">                pq.pop();</span><br><span class="line">                capital += topProfit;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> capital;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/27/786-K-th-Smallest-Prime-Fraction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/27/786-K-th-Smallest-Prime-Fraction/" itemprop="url">786. K-th Smallest Prime Fraction</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-27T23:13:13+08:00">2020-01-27</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-27T23:29:37+08:00">2020-01-27</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="786-k-th-smallest-prime-fraction"><a class="header-anchor" href="#786-k-th-smallest-prime-fraction">¶</a><a href="https://leetcode.com/problems/k-th-smallest-prime-fraction/" target="_blank" rel="noopener">786. K-th Smallest Prime Fraction</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>A sorted list <code>A</code> contains 1, plus some number of primes.  Then, for every p &lt; q in the list, we consider the fraction p/q.</p>
<p>What is the <code>K</code>-th smallest fraction considered?  Return your answer as an array of ints, where <code>answer[0] = p</code> and <code>answer[1] = q</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Examples:</span><br><span class="line">Input: A = [1, 2, 3, 5], K = 3</span><br><span class="line">Output: [2, 5]</span><br><span class="line">Explanation:</span><br><span class="line">The fractions to be considered in sorted order are:</span><br><span class="line">1/5, 1/3, 2/5, 1/2, 3/5, 2/3.</span><br><span class="line">The third fraction is 2/5.</span><br><span class="line"></span><br><span class="line">Input: A = [1, 7], K = 1</span><br><span class="line">Output: [1, 7]</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li><code>A</code> will have length between <code>2</code> and <code>2000</code>.</li>
<li>Each <code>A[i]</code> will be between <code>1</code> and <code>30000</code>.</li>
<li><code>K</code> will be between <code>1</code> and <code>A.length * (A.length - 1) / 2</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  用double类型做区间端点进行二分搜索，因为最大值为30000，所以精度足够。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; kthSmallestPrimeFraction(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="keyword">int</span> K) &#123;</span><br><span class="line">        <span class="keyword">double</span> l = <span class="number">0</span>, r=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> n = A.size();</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> total=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">double</span> max_f = <span class="number">0.0</span>;</span><br><span class="line">            <span class="keyword">int</span> q, p;</span><br><span class="line">            <span class="keyword">int</span> j = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">double</span> m = (l+r)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">while</span>(j &lt; n &amp;&amp; A[i] &gt; A[j] * m) ++j;</span><br><span class="line">                <span class="keyword">if</span>(n == j) <span class="keyword">break</span>;</span><br><span class="line">                total += n - j;</span><br><span class="line">                <span class="keyword">double</span> t = <span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(A[i])/A[j];</span><br><span class="line">                <span class="keyword">if</span>(max_f &lt; t) &#123;</span><br><span class="line">                    max_f = t;</span><br><span class="line">                    p = A[i];</span><br><span class="line">                    q = A[j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(total == K) <span class="keyword">return</span> &#123;p, q&#125;;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>( total &gt; K )  r = m;</span><br><span class="line">            <span class="keyword">else</span> l = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>带注释版:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; kthSmallestPrimeFraction(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; vec, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = vec.size();</span><br><span class="line">        <span class="keyword">double</span> left = <span class="number">0</span>, right = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">double</span> mid = (left + right)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> j = <span class="number">1</span>;<span class="comment">//对角线不考虑，j一定大于i</span></span><br><span class="line">            <span class="keyword">double</span> imax = <span class="number">0</span>, jmax = <span class="number">1</span>, fmax = <span class="number">0</span>;<span class="comment">//未必开头的数每一次都能超过，当作初始化的值不行</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                <span class="keyword">for</span> (; j &lt; n &amp;&amp; vec[i] &gt; mid*vec[j]; ++j);</span><br><span class="line">                <span class="keyword">if</span> (j == n) <span class="keyword">break</span>;<span class="comment">//当前这一行没找到，下面更不会有&lt;=m的，因为下面递增，想找小的数，定格于此</span></span><br><span class="line">                total += (n - j);<span class="comment">//n - 1 - j + 1 = n - j//最大值出现在每一行的第一个可能的数</span></span><br><span class="line">                <span class="keyword">double</span> curval = <span class="keyword">double</span>(vec[i])/vec[j];</span><br><span class="line">                <span class="keyword">if</span> (curval &gt; fmax) &#123;<span class="comment">//不知道是不是k，上面就要记录,又遇到了问题，</span></span><br><span class="line">                    imax = i, jmax = j, fmax = curval;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="comment">//所有的都遍历完才能进行统计总数</span></span><br><span class="line">            <span class="keyword">if</span> (total == k) &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;vec[imax], vec[jmax]&#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (total &lt; k) left = mid;<span class="comment">//找的数太小了，&lt;=mid的数量不够</span></span><br><span class="line">            <span class="keyword">else</span> right = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/27/801-Minimum-Swaps-To-Make-Sequences-Increasing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/27/801-Minimum-Swaps-To-Make-Sequences-Increasing/" itemprop="url">801. Minimum Swaps To Make Sequences Increasing</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-27T02:01:59+08:00">2020-01-27</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-27T02:12:06+08:00">2020-01-27</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="801-minimum-swaps-to-make-sequences-increasing"><a class="header-anchor" href="#801-minimum-swaps-to-make-sequences-increasing">¶</a><a href="https://leetcode.com/problems/minimum-swaps-to-make-sequences-increasing/" target="_blank" rel="noopener">801. Minimum Swaps To Make Sequences Increasing</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>We have two integer sequences <code>A</code> and <code>B</code> of the same non-zero length.</p>
<p>We are allowed to swap elements <code>A[i]</code> and <code>B[i]</code>.  Note that both elements are in the same index position in their respective sequences.</p>
<p>At the end of some number of swaps, <code>A</code> and <code>B</code> are both strictly increasing.  (A sequence is <em>strictly increasing</em> if and only if <code>A[0] &lt; A[1] &lt; A[2] &lt; ... &lt; A[A.length - 1]</code>.)</p>
<p>Given A and B, return the minimum number of swaps to make both sequences strictly increasing.  It is guaranteed that the given input always makes it possible.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Example:</span><br><span class="line">Input: A = [1,3,5,4], B = [1,2,3,7]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: </span><br><span class="line">Swap A[3] and B[3].  Then the sequences are:</span><br><span class="line">A = [1, 3, 5, 7] and B = [1, 2, 3, 4]</span><br><span class="line">which are both strictly increasing.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li><code>A, B</code> are arrays with the same length, and that length will be in the range <code>[1, 1000]</code>.</li>
<li><code>A[i], B[i]</code> are integer values in the range <code>[0, 2000]</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-dp"><a class="header-anchor" href="#法一-dp">¶</a>法一 dp</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minSwap</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; B)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp0=<span class="number">0</span>, dp1=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> dp_0=INT_MAX, dp_1=INT_MAX;</span><br><span class="line">            <span class="keyword">if</span>(B[i]&gt;A[i<span class="number">-1</span>]&amp;&amp;A[i]&gt;B[i<span class="number">-1</span>])&#123;</span><br><span class="line">                dp_0=min(dp_0, dp1);</span><br><span class="line">                dp_1=min(dp_1, dp0+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(B[i]&gt;B[i<span class="number">-1</span>]&amp;&amp;A[i]&gt;A[i<span class="number">-1</span>])&#123;</span><br><span class="line">                dp_0=min(dp_0, dp0);</span><br><span class="line">                dp_1=min(dp_1, dp1+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            dp0=dp_0, dp1=dp_1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min(dp0, dp1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-贪心"><a class="header-anchor" href="#法二-贪心">¶</a>法二 贪心</h5>
<p>  如果<code>max(A[i-1],B[i-1])&lt;min(A[i],B[i])</code>，不管交不交换，前后肯定满足递增关系；如果<code>max(A[i-1],B[i-1])&gt;=min(A[i],B[i])</code>，那么交换之后必须满<code>max(A[i-1]，B[i-1])</code>和<code>max(A[i], B[i])</code>在同一个数组且<code>min(A[i-1]，B[i-1])</code>和<code>min(A[i], B[i])</code>在同一个数组，此时<code>A[i]&gt;B[i]&amp;&amp;A[i-1]&gt;B[i-1]</code>或者<code>A[i]&lt;B[i]&amp;&amp;A[i-1]&lt;B[i-1]</code>，即上面的全大于下面的或者相反。注意，当<code>A[i]==B[i]</code>时，一定有<code>max(A[i-1],B[i-1])&lt;min(A[i],B[i])</code>，此时肯定会重置up和down计数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minSwap</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; B)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> swaps = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> up = <span class="number">0</span>, down = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[i] &gt; B[i])</span><br><span class="line">                up += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span>  <span class="keyword">if</span>(A[i] &gt; B[i])</span><br><span class="line">                down += <span class="number">1</span>;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> (i == A.size() - <span class="number">1</span> || <span class="built_in">std</span>::max(A[i], B[i]) &lt; <span class="built_in">std</span>::min(A[i + <span class="number">1</span>], B[i + <span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="comment">// free node</span></span><br><span class="line">                swaps += <span class="built_in">std</span>::min(up, down);</span><br><span class="line">                up = down = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> swaps;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/27/1171-Remove-Zero-Sum-Consecutive-Nodes-from-Linked-List/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/27/1171-Remove-Zero-Sum-Consecutive-Nodes-from-Linked-List/" itemprop="url">1171. Remove Zero Sum Consecutive Nodes from Linked List</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-27T01:49:52+08:00">2020-01-27</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-27T01:50:05+08:00">2020-01-27</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1171-remove-zero-sum-consecutive-nodes-from-linked-list"><a class="header-anchor" href="#1171-remove-zero-sum-consecutive-nodes-from-linked-list">¶</a><a href="https://leetcode.com/problems/remove-zero-sum-consecutive-nodes-from-linked-list/" target="_blank" rel="noopener">1171. Remove Zero Sum Consecutive Nodes from Linked List</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given the <code>head</code> of a linked list, we repeatedly delete consecutive sequences of nodes that sum to <code>0</code> until there are no such sequences.</p>
<p>After doing so, return the head of the final linked list.  You may return any such answer.</p>
<p>(Note that in the examples below, all sequences are serializations of <code>ListNode</code> objects.)</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: head = [1,2,-3,3,1]</span><br><span class="line">Output: [3,1]</span><br><span class="line">Note: The answer [1,2,1] would also be accepted.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: head = [1,2,3,-3,4]</span><br><span class="line">Output: [1,2,4]</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: head = [1,2,3,-3,-2]</span><br><span class="line">Output: [1]</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li>The given linked list will contain between <code>1</code> and <code>1000</code> nodes.</li>
<li>Each node in the linked list has <code>-1000 &lt;= node.val &lt;= 1000</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>Language: <strong>C++</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeZeroSumSublists</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, ListNode*&gt; prefixMap;</span><br><span class="line">        <span class="keyword">int</span> prefix = <span class="number">0</span>;</span><br><span class="line">        ListNode* newHead = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">        newHead-&gt;next = head;</span><br><span class="line">        ListNode* curr = newHead;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//add prefix sum into map</span></span><br><span class="line">        <span class="keyword">while</span>(curr)</span><br><span class="line">        &#123;</span><br><span class="line">            prefix += curr-&gt;val;</span><br><span class="line">            prefixMap[prefix] = curr;</span><br><span class="line">            curr = curr-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        curr = newHead;</span><br><span class="line">        prefix = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(curr)</span><br><span class="line">        &#123;</span><br><span class="line">            prefix += curr-&gt;val;</span><br><span class="line">            curr-&gt;next = prefixMap[prefix]-&gt;next;</span><br><span class="line">            curr = curr-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> newHead-&gt;next;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/27/802-Find-Eventual-Safe-States/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/27/802-Find-Eventual-Safe-States/" itemprop="url">802. Find Eventual Safe States</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-27T00:09:00+08:00">2020-01-27</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-27T01:49:38+08:00">2020-01-27</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="802-find-eventual-safe-states"><a class="header-anchor" href="#802-find-eventual-safe-states">¶</a><a href="https://leetcode.com/problems/find-eventual-safe-states/" target="_blank" rel="noopener">802. Find Eventual Safe States</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>In a directed graph, we start at some node and every turn, walk along a directed edge of the graph.  If we reach a node that is terminal (that is, it has no outgoing directed edges), we stop.</p>
<p>Now, say our starting node is _eventually safe _if and only if we must eventually walk to a terminal node.  More specifically, there exists a natural number <code>K</code> so that for any choice of where to walk, we must have stopped at a terminal node in less than <code>K</code> steps.</p>
<p>Which nodes are eventually safe?  Return them as an array in sorted order.</p>
<p>The directed graph has <code>N</code> nodes with labels <code>0, 1, ..., N-1</code>, where <code>N</code> is the length of <code>graph</code>.  The graph is given in the following form: <code>graph[i]</code> is a list of labels <code>j</code> such that <code>(i, j)</code> is a directed edge of the graph.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Example:</span><br><span class="line">Input: graph = [[1,2],[2,3],[5],[0],[5],[],[]]</span><br><span class="line">Output: [2,4,5,6]</span><br><span class="line">Here is a diagram of the above graph.</span><br></pre></td></tr></table></figure>
<p><img src="https://s3-lc-upload.s3.amazonaws.com/uploads/2018/03/17/picture1.png" alt="Illustration of graph"></p>
<p><strong>Note:</strong></p>
<ul>
<li><code>graph</code> will have length at most <code>10000</code>.</li>
<li>The number of edges in the graph will not exceed <code>32000</code>.</li>
<li>Each <code>graph[i]</code> will be a sorted list of different integers, chosen within the range <code>[0, graph.length - 1]</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-拓扑排序"><a class="header-anchor" href="#法一-拓扑排序">¶</a>法一 拓扑排序</h6>
<p>  把所有边倒过来，然后拓扑排序，所有被删掉的点都是safe的，留下来的点都不是safe的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; eventualSafeNodes(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; rgraph(graph.size());</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ind(graph.size()), safe(graph.size()), ans;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;graph.size();++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;n:graph[i])&#123;</span><br><span class="line">                rgraph[n].push_back(i);</span><br><span class="line">                ind[i]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(graph[i].empty()) q.push(i), safe[i]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> x=q.front();q.pop();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;n:rgraph[x])&#123;</span><br><span class="line">                <span class="keyword">if</span>(--ind[n]==<span class="number">0</span>) q.push(n), safe[n]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;graph.size();++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(safe[i]==<span class="number">1</span>)</span><br><span class="line">                ans.push_back(i);   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-染色法"><a class="header-anchor" href="#法二-染色法">¶</a>法二 染色法</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; eventualSafeNodes(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = graph.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; color(n,<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(dfs(i,color,graph)) ans.push_back(i); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> node,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; color, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(color[node] &gt; <span class="number">0</span>) <span class="keyword">return</span> color[node] == <span class="number">2</span>;</span><br><span class="line">        color[node] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> n : graph[node]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(color[n] == <span class="number">2</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(color[n] == <span class="number">1</span> || !dfs(n,color,graph)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        color[node] = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">441</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
