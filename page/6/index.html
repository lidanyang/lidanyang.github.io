<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/24/单调栈例题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/24/单调栈例题/" itemprop="url">单调栈例题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-24T17:29:00+08:00">2020-02-24</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-26T17:37:12+08:00">2020-02-26</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><a href="https://ac.nowcoder.com/acm/problem/15815" target="_blank" rel="noopener">https://ac.nowcoder.com/acm/problem/15815</a></li>
</ol>
<p>  用单调栈对每个数求以其为最大或最小值的最大区间。一开始以为重复数字需要特殊处理，结果其实就按普通的严格单调的单调栈的操作来就行，可以证明这样处理是正确的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> N;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; N)&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; h(N);</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">long</span>&gt; st;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; l(N), r(N);</span><br><span class="line">        <span class="keyword">long</span> MA = <span class="number">0</span>, MI = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="built_in">cin</span>&gt;&gt;h[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</span><br><span class="line">            <span class="keyword">while</span>(!st.empty() &amp;&amp; h[st.top()] &lt; h[i] ) r[st.top()] = i, st.pop();</span><br><span class="line">            <span class="keyword">if</span>(st.empty()) l[i] = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">else</span> l[i] = st.top();</span><br><span class="line">            st.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!st.empty())&#123; r[st.top()] = N; st.pop(); &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i  =<span class="number">0</span> ;i &lt; N; ++i) &#123;</span><br><span class="line">            MA += (r[i] -i)*(i- l[i])*h[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</span><br><span class="line">            <span class="keyword">while</span>(!st.empty() &amp;&amp; h[st.top()] &gt; h[i] ) r[st.top()] = i, st.pop();</span><br><span class="line">            <span class="keyword">if</span>(st.empty()) l[i] = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">else</span> l[i] = st.top();</span><br><span class="line">            st.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!st.empty())&#123; r[st.top()] = N; st.pop(); &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i  =<span class="number">0</span> ;i &lt; N; ++i)&#123;</span><br><span class="line">            MI += (r[i] -i)*(i- l[i])*h[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; MA - MI &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/23/75-Odd-Even-Jump/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/23/75-Odd-Even-Jump/" itemprop="url">975. Odd Even Jump</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-23T22:06:17+08:00">2020-02-23</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-24T21:18:18+08:00">2020-02-24</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="975-odd-even-jump"><a class="header-anchor" href="#975-odd-even-jump">¶</a><a href="https://leetcode.com/problems/odd-even-jump/" target="_blank" rel="noopener">975. Odd Even Jump</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>You are given an integer array <code>A</code>.  From some starting index, you can make a series of jumps.  The (1st, 3rd, 5th, …) jumps in the series are called <em>odd numbered jumps</em>, and the (2nd, 4th, 6th, …) jumps in the series are called <em>even numbered jumps</em>.</p>
<p>You may from index <code>i</code> jump forward to index <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;j&lt;/font&gt;</code> (with <code>i &lt; j</code>) in the following way:</p>
<ul>
<li>During odd numbered jumps (ie. jumps 1, 3, 5, …), you jump to the index <font face="monospace" style="display: inline;">j</font> such that <code>A[i] &lt;= A[j]</code> and <code>A[j]</code> is the smallest possible value.  If there are multiple such indexes <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;j&lt;/font&gt;</code>, you can only jump to the <strong>smallest</strong> such index <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;j&lt;/font&gt;</code>.</li>
<li>During even numbered jumps (ie. jumps 2, 4, 6, …), you jump to the index <font face="monospace" style="display: inline;">j</font> such that <code>A[i] &gt;= A[j]</code> and <code>A[j]</code> is the largest possible value.  If there are multiple such indexes <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;j&lt;/font&gt;</code>, you can only jump to the <strong>smallest</strong> such index <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;j&lt;/font&gt;</code>.</li>
<li>(It may be the case that for some index <code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;i&lt;/font&gt;,</code> there are no legal jumps.)</li>
</ul>
<p>A starting index is <em>good</em> if, starting from that index, you can reach the end of the array (index <code>A.length - 1</code>) by jumping some number of times (possibly 0 or more than once.)</p>
<p>Return the number of good starting indexes.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Input: [10,13,12,14,15]</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: </span><br><span class="line">From starting index i = 0, we can jump to i = 2 (since A[2] is the smallest among A[1], A[2], A[3], A[4] that is greater or equal to A[0]), then we can&apos;t jump any more.</span><br><span class="line">From starting index i = 1 and i = 2, we can jump to i = 3, then we can&apos;t jump any more.</span><br><span class="line">From starting index i = 3, we can jump to i = 4, so we&apos;ve reached the end.</span><br><span class="line">From starting index i = 4, we&apos;ve reached the end already.</span><br><span class="line">In total, there are 2 different starting indexes (i = 3, i = 4) where we can reach the end with some number of jumps.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Input: [2,3,1,1,4]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: </span><br><span class="line">From starting index i = 0, we make jumps to i = 1, i = 2, i = 3:</span><br><span class="line"></span><br><span class="line">During our 1st jump (odd numbered), we first jump to i = 1 because A[1] is the smallest value in (A[1], A[2], A[3], A[4]) that is greater than or equal to A[0].</span><br><span class="line"></span><br><span class="line">During our 2nd jump (even numbered), we jump from i = 1 to i = 2 because A[2] is the largest value in (A[2], A[3], A[4]) that is less than or equal to A[1].  A[3] is also the largest value, but 2 is a smaller index, so we can only jump to i = 2 and not i = 3.</span><br><span class="line"></span><br><span class="line">During our 3rd jump (odd numbered), we jump from i = 2 to i = 3 because A[3] is the smallest value in (A[3], A[4]) that is greater than or equal to A[2].</span><br><span class="line"></span><br><span class="line">We can&apos;t jump from i = 3 to i = 4, so the starting index i = 0 is not good.</span><br><span class="line"></span><br><span class="line">In a similar manner, we can deduce that:</span><br><span class="line">From starting index i = 1, we jump to i = 4, so we reach the end.</span><br><span class="line">From starting index i = 2, we jump to i = 3, and then we can&apos;t jump anymore.</span><br><span class="line">From starting index i = 3, we jump to i = 4, so we reach the end.</span><br><span class="line">From starting index i = 4, we are already at the end.</span><br><span class="line">In total, there are 3 different starting indexes (i = 1, i = 3, i = 4) where we can reach the end with some number of jumps.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [5,1,3,4,2]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: </span><br><span class="line">We can reach the end from starting indexes 1, 2, and 4.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= A.length &lt;= 20000</code></li>
<li><code>0 &lt;= A[i] &lt; 100000</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  这道题有个陷阱，步数是从第1步开始的，没有第0步这一说。</p>
<h6 id="法一-ordered-map-dp"><a class="header-anchor" href="#法一-ordered-map-dp">¶</a>法一 ordered_map + dp</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">oddEvenJumps</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N =  A.size();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> dp[N][<span class="number">2</span>]&#123;&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; m;</span><br><span class="line">        </span><br><span class="line">        dp[N<span class="number">-1</span>][<span class="number">0</span>] = dp[N<span class="number">-1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = N<span class="number">-1</span>;i &gt;= <span class="number">0</span>; --i)&#123;</span><br><span class="line">            <span class="keyword">auto</span> it = m.lower_bound(A[i]);</span><br><span class="line">            <span class="keyword">if</span>(it != m.end()) dp[i][<span class="number">1</span>] = dp[it-&gt;second][<span class="number">0</span>];</span><br><span class="line">            it = m.upper_bound(A[i]);</span><br><span class="line">            <span class="keyword">if</span>(it!=m.begin()) dp[i][<span class="number">0</span>] = dp[(--it)-&gt;second][<span class="number">1</span>];</span><br><span class="line">            m[A[i]]= i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="keyword">if</span>(dp[i][<span class="number">1</span>]) ++ans;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-单调栈"><a class="header-anchor" href="#法二-单调栈">¶</a>法二 单调栈</h6>
<p>  数组右边大于等于某个数的最小值可以换个角度来看，首先是值大于等于当前值的最小值，其次是对应索引大于当前索引，如果将整个数组按大小给下标排序，那么数组右边大于等于某个数的最小值就相当于这个排序后的数组中找对应下标右边第一个大于当前下标的下标，这是单调栈的经典用法。代码中用stale_sort是因为题目要求如果有多个相同的大于等于当前数的最小值选其中下标小的一个。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; odd_next;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; even_next;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">make_next</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;idx, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; next)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; _stack;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> j : idx) &#123;</span><br><span class="line">            <span class="keyword">while</span>(_stack.size() &amp;&amp; _stack.top() &lt; j) &#123;</span><br><span class="line">                <span class="keyword">int</span> i = _stack.top(); _stack.pop();</span><br><span class="line">                next[i] = j;</span><br><span class="line">            &#125;</span><br><span class="line">            _stack.push(j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(_stack.size()) &#123;</span><br><span class="line">            <span class="keyword">int</span> i = _stack.top(); _stack.pop();</span><br><span class="line">            next[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init_next_array</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = A.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; idx(n);</span><br><span class="line">        </span><br><span class="line">        odd_next.resize(n);</span><br><span class="line">        even_next.resize(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i= <span class="number">0</span>; i&lt; n; i++) &#123;</span><br><span class="line">            idx[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        stable_sort(idx.begin(), idx.end(),</span><br><span class="line">        [&amp;A](<span class="keyword">int</span> i1, <span class="keyword">int</span> i2) &#123;<span class="keyword">return</span> A[i1] &lt; A[i2];&#125;);</span><br><span class="line">        make_next(idx, odd_next);</span><br><span class="line">        </span><br><span class="line">        stable_sort(idx.begin(), idx.end(),</span><br><span class="line">        [&amp;A](<span class="keyword">int</span> i1, <span class="keyword">int</span> i2) &#123;<span class="keyword">return</span> A[i1] &gt; A[i2];&#125;);</span><br><span class="line"></span><br><span class="line">        make_next(idx, even_next);</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">oddEvenJumps</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = A.size();</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; odd(n, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; even(n, <span class="number">0</span>);</span><br><span class="line">        odd[n<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">        even[n<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">        init_next_array(A);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = n<span class="number">-2</span>; j &gt;=<span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">auto</span> next = odd_next[j];</span><br><span class="line">            <span class="keyword">if</span> (next != j &amp;&amp; even[next] == <span class="number">1</span>) &#123;</span><br><span class="line">                odd[j] = <span class="number">1</span>;</span><br><span class="line">                result++;</span><br><span class="line">            &#125;</span><br><span class="line">            next = even_next[j];</span><br><span class="line">            <span class="keyword">if</span> (next != j &amp;&amp; odd[next] == <span class="number">1</span>) &#123;</span><br><span class="line">                even[j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-bst"><a class="header-anchor" href="#法三-bst">¶</a>法三 BST</h6>
<p>  这个解法有点惊艳，可以从中学到怎么在二叉搜索树中找到第一个大于等于或小于等于要插入的值的值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	Node* left = <span class="literal">NULL</span>, * right = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">bool</span> oddJump, evenJump;</span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line">	Node(<span class="keyword">int</span> _val) : val(_val) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findUsingBST</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="keyword">const</span> &amp; A)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = A.size() - <span class="number">1</span>, res = <span class="number">1</span>, num;</span><br><span class="line">	Node root(A[n]), * t;</span><br><span class="line">	root.oddJump = <span class="literal">true</span>, root.evenJump = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">bool</span> oddJump, evenJump;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (n--) </span><br><span class="line">	&#123;</span><br><span class="line">		t = &amp;root, oddJump = evenJump = <span class="literal">false</span>, num = A[n];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>) </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (num &lt; t-&gt;val) </span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (!t-&gt;left) </span><br><span class="line">				&#123;</span><br><span class="line">					t-&gt;left = <span class="keyword">new</span> Node(num);</span><br><span class="line">					t-&gt;left-&gt;oddJump = t-&gt;evenJump;</span><br><span class="line">					t-&gt;left-&gt;evenJump = oddJump;</span><br><span class="line">					<span class="keyword">if</span> (t-&gt;left-&gt;oddJump) res++;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				evenJump = t-&gt;evenJump;</span><br><span class="line">				t = t-&gt;left;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (num &gt; t-&gt;val) </span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (!t-&gt;right)</span><br><span class="line">				&#123;</span><br><span class="line">					t-&gt;right = <span class="keyword">new</span> Node(num);</span><br><span class="line">					t-&gt;right-&gt;oddJump = evenJump;</span><br><span class="line">					t-&gt;right-&gt;evenJump = t-&gt;oddJump;</span><br><span class="line">					<span class="keyword">if</span> (t-&gt;right-&gt;oddJump) res++;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				oddJump = t-&gt;oddJump;</span><br><span class="line">				t = t-&gt;right;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">std</span>::swap(t-&gt;oddJump, t-&gt;evenJump);</span><br><span class="line">				<span class="keyword">if</span> (t-&gt;oddJump) res++;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">oddEvenJumps</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="keyword">const</span> &amp; A)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> findUsingBST(A);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/23/903-Valid-Permutations-for-DI-Sequence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/23/903-Valid-Permutations-for-DI-Sequence/" itemprop="url">903. Valid Permutations for DI Sequence</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-23T15:34:33+08:00">2020-02-23</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-23T15:50:29+08:00">2020-02-23</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="903-valid-permutations-for-di-sequence"><a class="header-anchor" href="#903-valid-permutations-for-di-sequence">¶</a><a href="https://leetcode.com/problems/valid-permutations-for-di-sequence/" target="_blank" rel="noopener">903. Valid Permutations for DI Sequence</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>We are given <code>S</code>, a length <code>n</code> string of characters from the set <code>{'D', 'I'}</code>. (These letters stand for “decreasing” and “increasing”.)</p>
<p>A <em>valid permutation</em> is a permutation <code>P[0], P[1], ..., P[n]</code> of integers <code>{0, 1, ..., n}</code>, such that for all <code>i</code>:</p>
<ul>
<li>If <code>S[i] == 'D'</code>, then <code>P[i] &gt; P[i+1]</code>, and;</li>
<li>If <code>S[i] == 'I'</code>, then <code>P[i] &lt; P[i+1]</code>.</li>
</ul>
<p>How many valid permutations are there?  Since the answer may be large, <strong>return your answer modulo <code>10^9 + 7</code></strong>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;DID&quot;</span><br><span class="line">Output: 5</span><br><span class="line">Explanation: </span><br><span class="line">The 5 valid permutations of (0, 1, 2, 3) are:</span><br><span class="line">(1, 0, 3, 2)</span><br><span class="line">(2, 0, 3, 1)</span><br><span class="line">(2, 1, 3, 0)</span><br><span class="line">(3, 0, 2, 1)</span><br><span class="line">(3, 1, 2, 0)</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= S.length &lt;= 200</code></li>
<li><code>S</code> consists only of characters from the set <code>{'D', 'I'}</code>.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dp-分治"><a class="header-anchor" href="#法一-dp-分治">¶</a>法一 dp+分治</h6>
<p>  比如0，1，2，3，4，5。5附近的序列肯定是&quot;ID&quot;，然后从剩余的元素中选几个放左边，然后别的放右边，左右的更短的序列和所选数字的组合对应子问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keyword">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="keyword">long</span> c[<span class="number">201</span>][<span class="number">201</span>]&#123;&#125;, dp[<span class="number">201</span>][<span class="number">201</span>]&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">C</span><span class="params">(<span class="keyword">long</span> N, <span class="keyword">long</span> k)</span></span>&#123;<span class="comment">//用dp算组合数</span></span><br><span class="line">        <span class="keyword">if</span>(c[N][k] != <span class="number">0</span>) <span class="keyword">return</span> c[N][k];</span><br><span class="line">        <span class="keyword">if</span>(k == <span class="number">0</span> || k==N) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(k == <span class="number">1</span> || k == N<span class="number">-1</span>) <span class="keyword">return</span> N;</span><br><span class="line">        c[N][k] = (C(N<span class="number">-1</span>, k<span class="number">-1</span>)+C(N<span class="number">-1</span>,k))%p;</span><br><span class="line">        <span class="keyword">return</span> c[N][k]; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">DP</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;S, <span class="keyword">int</span> s, <span class="keyword">int</span> e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s&gt;=e) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(dp[s][e] != <span class="number">0</span>) <span class="keyword">return</span> dp[s][e];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">long</span> ans = <span class="number">0</span>, l = e-s+<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(S[s] == <span class="string">'D'</span>) ans = (ans + DP(S, s+<span class="number">1</span>, e))%p;</span><br><span class="line">        <span class="keyword">if</span>(S[e] == <span class="string">'I'</span>) ans = (ans + DP(S, s, e<span class="number">-1</span>))%p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = s; i &lt; e; ++i) <span class="keyword">if</span>(S[i] == <span class="string">'I'</span>&amp;&amp;S[i+<span class="number">1</span>] == <span class="string">'D'</span>) ans = (ans + C(l<span class="number">-1</span>, i-s+<span class="number">1</span>)%p * DP(S, s, i<span class="number">-1</span>)%p * DP(S, i+<span class="number">2</span>, e)%p)%p;</span><br><span class="line">        <span class="keyword">return</span> dp[s][e] = ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numPermsDISequence</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DP(S, <span class="number">0</span>, S.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>官方的解法求组合数是用阶乘和逆元求的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from functools import lru_cache</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    def numPermsDISequence(self, S):</span><br><span class="line">        MOD = 10**9 + 7</span><br><span class="line"></span><br><span class="line">        fac = [1, 1]</span><br><span class="line">        for x in range(2, 201):</span><br><span class="line">            fac.append(fac[-1] * x % MOD)</span><br><span class="line">        facinv = [pow(f, MOD-2, MOD) for f in fac]</span><br><span class="line"></span><br><span class="line">        def binom(n, k):</span><br><span class="line">            return fac[n] * facinv[n-k] % MOD * facinv[k] % MOD</span><br><span class="line"></span><br><span class="line">        @lru_cache(None)</span><br><span class="line">        def dp(i, j):</span><br><span class="line">            if i &gt;= j: return 1</span><br><span class="line">            ans = 0</span><br><span class="line">            n = j - i + 2</span><br><span class="line">            if S[i] == &apos;I&apos;: ans += dp(i+1, j)</span><br><span class="line">            if S[j] == &apos;D&apos;: ans += dp(i, j-1)</span><br><span class="line"></span><br><span class="line">            for k in range(i+1, j+1):</span><br><span class="line">                if S[k-1:k+1] == &apos;DI&apos;:</span><br><span class="line">                    ans += binom(n-1, k-i) * dp(i, k-2) % MOD * dp(k+1, j) % MOD</span><br><span class="line">                    ans %= MOD</span><br><span class="line">            return ans</span><br><span class="line"></span><br><span class="line">        return dp(0, len(S) - 1)</span><br></pre></td></tr></table></figure>
<h6 id="法一-dp"><a class="header-anchor" href="#法一-dp">¶</a>法一 dp</h6>
<p><a href="https://leetcode-cn.com/problems/valid-permutations-for-di-sequence/solution/n2-c-solution-by-georgeljc/" target="_blank" rel="noopener">https://leetcode-cn.com/problems/valid-permutations-for-di-sequence/solution/n2-c-solution-by-georgeljc/</a></p>
<p>  dp的索引维护<strong>相对大小</strong>的信息，意识到从相对大小的角度思考也是本题的一个关键。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numPermsDISequence</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">205</span>][<span class="number">205</span>],n=S.size(),mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">        <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) dp[<span class="number">0</span>][i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(S.at(i<span class="number">-1</span>)==<span class="string">'D'</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> suf=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=n-i;j&gt;=<span class="number">0</span>;--j)&#123;</span><br><span class="line">                    dp[i][j]=(suf+dp[i<span class="number">-1</span>][j+<span class="number">1</span>])%mod;</span><br><span class="line">                    suf=dp[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> pre=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n-i;++j)&#123;</span><br><span class="line">                    dp[i][j]=(pre+dp[i<span class="number">-1</span>][j])%mod;</span><br><span class="line">                    pre=dp[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//作者：georgeljc</span></span><br><span class="line"><span class="comment">//链接：https://leetcode-cn.com/problems/valid-permutations-for-di-sequence/solution/n2-c-solution-by-georgeljc/</span></span><br><span class="line"><span class="comment">//来源：力扣（LeetCode）</span></span><br><span class="line"><span class="comment">//著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</span></span><br></pre></td></tr></table></figure>
<p>官方的优化解:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from functools import lru_cache</span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    def numPermsDISequence(self, S):</span><br><span class="line">        MOD = 10**9 + 7</span><br><span class="line">        N = len(S)</span><br><span class="line"></span><br><span class="line">        @lru_cache(None)</span><br><span class="line">        def dp(i, j):</span><br><span class="line">            # How many ways to place P_i with relative rank j?</span><br><span class="line">            if not(0 &lt;= j &lt;= i):</span><br><span class="line">                return 0</span><br><span class="line">            if i == 0:</span><br><span class="line">                return 1</span><br><span class="line">            elif S[i-1] == &apos;D&apos;:</span><br><span class="line">                return (dp(i, j+1) + dp(i-1, j)) % MOD</span><br><span class="line">            else:</span><br><span class="line">                return (dp(i, j-1) + dp(i-1, j-1)) % MOD</span><br><span class="line"></span><br><span class="line">        return sum(dp(N, j) for j in range(N+1)) % MOD</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/23/1360-Number-of-Days-Between-Two-Dates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/23/1360-Number-of-Days-Between-Two-Dates/" itemprop="url">1360. Number of Days Between Two Dates</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-23T14:04:12+08:00">2020-02-23</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-23T14:06:47+08:00">2020-02-23</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1360-number-of-days-between-two-dates"><a class="header-anchor" href="#1360-number-of-days-between-two-dates">¶</a><a href="https://leetcode.com/problems/number-of-days-between-two-dates/" target="_blank" rel="noopener">1360. Number of Days Between Two Dates</a></h3>
<p>Difficulty: <strong>Easy</strong></p>
<p>Write a program to count the number of days between two dates.</p>
<p>The two dates are given as strings, their format is <code>YYYY-MM-DD</code> as shown in the examples.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: date1 = &quot;2019-06-29&quot;, date2 = &quot;2019-06-30&quot;</span><br><span class="line">Output: 1</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: date1 = &quot;2020-01-15&quot;, date2 = &quot;2019-12-31&quot;</span><br><span class="line">Output: 15</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li>The given dates are valid dates between the years <code>1971</code> and <code>2100</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>Language: <strong>C++</strong></p>
<h6 id="1"><a class="header-anchor" href="#1">¶</a>1.</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> mon[<span class="number">13</span>]=&#123;<span class="number">0</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="built_in">string</span> date)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> year=<span class="number">0</span>,month=<span class="number">0</span>,day=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            year=year*<span class="number">10</span>+date[i]-<span class="string">'0'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">5</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            month=month*<span class="number">10</span>+date[i]-<span class="string">'0'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">8</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            day=day*<span class="number">10</span>+date[i]-<span class="string">'0'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1971</span>;i&lt;year;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            res=res+<span class="number">365</span>;</span><br><span class="line">            <span class="keyword">if</span>((i%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;i%<span class="number">100</span>!=<span class="number">0</span>)||i%<span class="number">400</span>==<span class="number">0</span>)res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;month;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            res=res+mon[i];</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="number">2</span>&amp;&amp;((year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>)||year%<span class="number">400</span>==<span class="number">0</span>))res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res+day;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">daysBetweenDates</span><span class="params">(<span class="built_in">string</span> date1, <span class="built_in">string</span> date2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">abs</span>(get(date2)-get(date1));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="2"><a class="header-anchor" href="#2">¶</a>2.</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isleap</span><span class="params">(<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; y%<span class="number">100</span>!=<span class="number">0</span> || y%<span class="number">400</span>==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tab[]=&#123;<span class="number">-1</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getdate1</span><span class="params">(<span class="keyword">char</span> *date)</span></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> y,m,d,r=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sscanf</span>(date, <span class="string">"%d-%d-%d"</span>, &amp;y,&amp;m,&amp;d);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1970</span>; i&lt;y;i++)</span><br><span class="line">        <span class="keyword">if</span>(isleap(i)) r+= <span class="number">366</span>;</span><br><span class="line">        <span class="keyword">else</span> r+= <span class="number">365</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">        r+=tab[i];</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">2</span> &amp;&amp; isleap(y)) r+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    r+=d;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> intfabs(x) ((x)&lt;0?-(x):(x))</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">daysBetweenDates</span><span class="params">(<span class="keyword">char</span> * date1, <span class="keyword">char</span> * date2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> intfabs(getdate1(date1)-getdate1(date2) );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//作者：ni-jin-tian-zhen-hao-kan-2</span></span><br><span class="line"><span class="comment">//链接：https://leetcode-cn.com/problems/number-of-days-between-two-dates/solution/fen-bie-ji-suan-liang-ri-qi-xiang-dui-yu-1970nian-/</span></span><br><span class="line"><span class="comment">//来源：力扣（LeetCode）</span></span><br><span class="line"><span class="comment">//著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/23/968-Binary-Tree-Cameras/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/23/968-Binary-Tree-Cameras/" itemprop="url">968. Binary Tree Cameras</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-23T01:35:00+08:00">2020-02-23</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-23T01:45:39+08:00">2020-02-23</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="968-binary-tree-cameras"><a class="header-anchor" href="#968-binary-tree-cameras">¶</a><a href="https://leetcode.com/problems/binary-tree-cameras/" target="_blank" rel="noopener">968. Binary Tree Cameras</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a binary tree, we install cameras on the nodes of the tree.</p>
<p>Each camera at a node can monitor <strong>its parent, itself, and its immediate children</strong>.</p>
<p>Calculate the minimum number of cameras needed to monitor all nodes of the tree.</p>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2018/12/29/bst_cameras_01.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [0,0,null,0,0]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: One camera is enough to monitor all nodes if placed as shown.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2018/12/29/bst_cameras_02.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [0,0,null,0,null,0,null,null,0]</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: At least two cameras are needed to monitor all nodes of the tree. The above image shows one of the valid configurations of camera placement.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The number of nodes in the given tree will be in the range <code>[1, 1000]</code>.</li>
<li><strong>Every</strong> node has value 0.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-树状dp"><a class="header-anchor" href="#法一-树状dp">¶</a>法一 树状dp</h6>
<p>每个节点对应的子树有三种状态:</p>
<ol>
<li>根节点放了且灯子树节点全被照亮；</li>
<li>根节点没放灯，除了根节点全被照亮；</li>
<li>根节点没放灯且子树节点全被照亮；</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode *root, <span class="keyword">int</span> &amp;up0, <span class="keyword">int</span> &amp;up1, <span class="keyword">int</span> &amp;p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root) &#123; up0 = <span class="number">0</span>;up1 = <span class="number">0</span>;p = <span class="number">1000</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">        <span class="keyword">int</span> a, b, c, d, e, f;       </span><br><span class="line">        dfs(root-&gt;left, a, b, c); dfs(root-&gt;right, d, e, f);     </span><br><span class="line">        up0 = b+e; up1 = min(&#123;c+e, f+b, c+f&#125;); p = min(&#123;b,a,c&#125;)+<span class="number">1</span>+min(&#123;e, d,f&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCameraCover</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a, b, c; dfs(root, a, b, c);</span><br><span class="line">        <span class="keyword">return</span> min(c, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-贪心法"><a class="header-anchor" href="#法二-贪心法">¶</a>法二 贪心法</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_set</span>&lt;TreeNode*&gt; s;</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode *node, TreeNode *par)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node)&#123;</span><br><span class="line">            dfs(node-&gt;left, node);</span><br><span class="line">            dfs(node-&gt;right, node);</span><br><span class="line">            <span class="keyword">if</span>((!par&amp;&amp;!s.count(node))||<span class="comment">//当前点没被照亮且没有父节点即根节点</span></span><br><span class="line">                !s.count(node-&gt;left)||<span class="comment">//当前点的左子节点没被照亮</span></span><br><span class="line">                !s.count(node-&gt;right))<span class="comment">//当前点的右子节点没被照亮</span></span><br><span class="line">            &#123;</span><br><span class="line">                ++ans;</span><br><span class="line">                s.insert(par);</span><br><span class="line">                s.insert(node);</span><br><span class="line">                s.insert(node-&gt;left);</span><br><span class="line">                s.insert(node-&gt;right);</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCameraCover</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        s.insert(<span class="literal">nullptr</span>);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        dfs(root, <span class="literal">nullptr</span>);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/23/1289-Minimum-Falling-Path-Sum-II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/23/1289-Minimum-Falling-Path-Sum-II/" itemprop="url">1289. Minimum Falling Path Sum II</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-23T00:27:00+08:00">2020-02-23</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-23T00:30:12+08:00">2020-02-23</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1289-minimum-falling-path-sum-ii"><a class="header-anchor" href="#1289-minimum-falling-path-sum-ii">¶</a><a href="https://leetcode.com/problems/minimum-falling-path-sum-ii/" target="_blank" rel="noopener">1289. Minimum Falling Path Sum II</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a square grid of integers <code>arr</code>, a <em>falling path with non-zero shifts</em> is a choice of exactly one element from each row of <code>arr</code>, such that no two elements chosen in adjacent rows are in the same column.</p>
<p>Return the minimum sum of a falling path with non-zero shifts.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Input: arr = [[1,2,3],[4,5,6],[7,8,9]]</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: </span><br><span class="line">The possible falling paths are:</span><br><span class="line">[1,5,9], [1,5,7], [1,6,7], [1,6,8],</span><br><span class="line">[2,4,8], [2,4,9], [2,6,7], [2,6,8],</span><br><span class="line">[3,4,8], [3,4,9], [3,5,7], [3,5,9]</span><br><span class="line">The falling path with the smallest sum is [1,5,7], so the answer is 13.</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= arr.length == arr[i].length &lt;= 200</code></li>
<li><code>-99 &lt;= arr[i][j] &lt;= 99</code></li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dp"><a class="header-anchor" href="#法一-dp">¶</a>法一 dp</h6>
<p>  每次找最小和次小值的索引，然后最小的索引的下一行加上次小值，其它都加上次小值。这样做的好处是可以不用额外开空间，直接在原数组上操作，并且求最小和次小的过程也是实时求的，可以一边更新一边求。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minFallingPathSum</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> row = a.size(), col = a[<span class="number">0</span>].size(), c1, c2, p1, p2;</span><br><span class="line">        <span class="keyword">if</span> (col == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; row; i++, p1 = <span class="number">0</span>, p2 = <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i][<span class="number">0</span>] &gt; a[i][<span class="number">1</span>]) p2 = <span class="number">0</span>, p1 = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; col; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &gt; <span class="number">0</span>)  &#123;</span><br><span class="line">                    <span class="keyword">if</span> (c1 == j) a[i][j] += a[i - <span class="number">1</span>][c2];</span><br><span class="line">                    <span class="keyword">else</span> a[i][j] += a[i - <span class="number">1</span>][c1];                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (j &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a[i][j] &lt; a[i][p1] &amp;&amp; a[i][j] &lt; a[i][p2]) p2 = p1, p1 = j;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (a[i][j] &lt; a[i][p2]) p2 = j;                    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            c1 = p1, c2 = p2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *min_element(a[row - <span class="number">1</span>].begin(), a[row - <span class="number">1</span>].end());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-dp"><a class="header-anchor" href="#法二-dp">¶</a>法二 dp</h6>
<p>  常规dp。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minFallingPathSum</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = arr.size(), cur = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(<span class="number">2</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(N));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; N; ++i) dp[<span class="number">0</span>][i] = arr[<span class="number">0</span>][i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)&#123;</span><br><span class="line">            cur ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">100</span>; j &lt; N; ++j)&#123;</span><br><span class="line">                dp[cur][j] = k;</span><br><span class="line">                k = min(k, dp[cur^<span class="number">1</span>][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = N<span class="number">-1</span>, mn = <span class="number">100</span>; j &gt;= <span class="number">0</span>; --j)&#123;</span><br><span class="line">                dp[cur][j] = min(k, dp[cur][j]) +arr[i][j];</span><br><span class="line">                k = min(k, dp[cur^<span class="number">1</span>][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *min_element(dp[cur].begin(), dp[cur].end());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/22/数论相关的资料/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/22/数论相关的资料/" itemprop="url">数论相关的资料</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-22T18:07:00+08:00">2020-02-22</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-22T18:08:55+08:00">2020-02-22</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/资料/" itemprop="url" rel="index">
                    <span itemprop="name">资料</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.cnblogs.com/linyujun/category/784324.html" target="_blank" rel="noopener">https://www.cnblogs.com/linyujun/category/784324.html</a></p>
<p><a href="https://www.cnblogs.com/liuyongliu/p/10308928.html" target="_blank" rel="noopener">https://www.cnblogs.com/liuyongliu/p/10308928.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/22/928-Minimize-Malware-Spread-II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/22/928-Minimize-Malware-Spread-II/" itemprop="url">928. Minimize Malware Spread II</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-22T17:09:02+08:00">2020-02-22</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-22T18:04:12+08:00">2020-02-22</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="928-minimize-malware-spread-ii"><a class="header-anchor" href="#928-minimize-malware-spread-ii">¶</a><a href="https://leetcode.com/problems/minimize-malware-spread-ii/" target="_blank" rel="noopener">928. Minimize Malware Spread II</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>(This problem is the same as <em>Minimize Malware Spread</em>, with the differences bolded.)</p>
<p>In a network of nodes, each node <code>i</code> is directly connected to another node <code>j</code> if and only if <code>graph[i][j] = 1</code>.</p>
<p>Some nodes <code>initial</code> are initially infected by malware.  Whenever two nodes are directly connected and at least one of those two nodes is infected by malware, both nodes will be infected by malware.  This spread of malware will continue until no more nodes can be infected in this manner.</p>
<p>Suppose <code>M(initial)</code> is the final number of nodes infected with malware in the entire network, after the spread of malware stops.</p>
<p>We will remove one node from the initial list, <strong>completely removing it and any connections from this node to any other node</strong>.  Return the node that if removed, would minimize <code>M(initial)</code>.  If multiple nodes could be removed to minimize <code>M(initial)</code>, return such a node with the smallest index.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: graph = [[1,1,0],[1,1,0],[0,0,1]], initial = [0,1]</span><br><span class="line">Output: 0</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: graph = [[1,1,0],[1,1,1],[0,1,1]], initial = [0,1]</span><br><span class="line">Output: 1</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: graph = [[1,1,0,0],[1,1,1,0],[0,1,1,1],[0,0,1,1]], initial = [0,1]</span><br><span class="line">Output: 1</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt; graph.length = graph[0].length &lt;= 300</code></li>
<li><code>0 &lt;= graph[i][j] == graph[j][i] &lt;= 1</code></li>
<li><code>graph[i][i] = 1</code></li>
<li><code>1 &lt;= initial.length &lt; graph.length</code></li>
<li><code>0 &lt;= initial[i] &lt; graph.length</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dfs"><a class="header-anchor" href="#法一-dfs">¶</a>法一 dfs</h6>
<p>  找到哪些点是只能被一个点传染到的点，然后统计每个传染点独占的能传染到的点的个数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minMalwareSpread</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; initial)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = graph.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; clean(N, <span class="number">1</span>), contri(N);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; infectedBy(N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : initial) clean[x] = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; seen;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i : initial)&#123;</span><br><span class="line">            seen.clear();</span><br><span class="line">            dfs(graph, clean, i, seen);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : seen) infectedBy[x].push_back(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;N; ++i) <span class="keyword">if</span>(infectedBy[i].size() == <span class="number">1</span>) contri[infectedBy[i][<span class="number">0</span>]]++;</span><br><span class="line">        </span><br><span class="line">        sort(initial.begin(), initial.end());</span><br><span class="line">        <span class="keyword">int</span> ans = initial[<span class="number">0</span>], ansSize = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i : initial)&#123;</span><br><span class="line">            <span class="keyword">if</span>(contri[i] &gt; ansSize) ans = i, ansSize = contri[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;clean, <span class="keyword">int</span> n, <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; &amp;seen)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; graph.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(graph[n][i] == <span class="number">1</span> &amp;&amp; clean[i] == <span class="number">1</span> &amp;&amp; !seen.count(i))&#123;</span><br><span class="line">                seen.insert(i);</span><br><span class="line">                dfs(graph, clean, i, seen);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  还有另一种角度，即从每个传染点出发，不经过其他传染点，看看该点能传染到哪些点，一旦遇到某个传染点就返回，说明这个邻接点连接的分量就算去掉了当前点依然会被传染。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minMalwareSpread</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; initial)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = graph.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; G(N);</span><br><span class="line">        <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; s(initial.begin(), initial.end());</span><br><span class="line">        sort(initial.begin(), initial.end());</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vis(N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; N ; ++j) <span class="keyword">if</span>(graph[i][j]) G[i].push_back(j), G[j].push_back(i);</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> mx = INT_MIN, ans = <span class="number">-1</span>, o = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;n : initial)&#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;nei : G[n])&#123;</span><br><span class="line">                <span class="keyword">int</span> r = dfs(G, s, vis, nei, n, o);</span><br><span class="line">                <span class="keyword">if</span>(r != <span class="number">-1</span>) t += r;<span class="comment">//r!=1说明该邻接点对应的分量不会被其他传染点传染</span></span><br><span class="line">            &#125;</span><br><span class="line">            o++;</span><br><span class="line">            <span class="keyword">if</span>(t &gt; mx) mx = t, ans = n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">            </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;G, <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; &amp;s, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;vis, <span class="keyword">int</span> src, <span class="keyword">int</span> node, <span class="keyword">int</span> o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(s.count(src)) <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//遇到其他传染点，说明该分量全会被传染，不用继续dfs</span></span><br><span class="line">        vis[src] = o;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;nei : G[src])&#123;</span><br><span class="line">            <span class="keyword">if</span>(nei == node||vis[nei] == o) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> r = dfs(G, s, vis, nei, node, o);</span><br><span class="line">            <span class="keyword">if</span>(r == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            ans += r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-并查集"><a class="header-anchor" href="#法二-并查集">¶</a>法二 并查集</h6>
<p>  先把所有传染点去掉，然后统计所有连通分量，然后对每个传染点看哪些分量会被其传染，对该分量传染源计数。最后对每个传染点，看它能传染的那些分量中，有哪些是只被其传染。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DSU</span> &#123;</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; parent;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; rank;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sz_;</span><br><span class="line">        <span class="keyword">int</span> sz;</span><br><span class="line"></span><br><span class="line">        DSU(<span class="keyword">int</span> n) &#123;</span><br><span class="line">            sz = n;</span><br><span class="line">            parent = <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n);</span><br><span class="line">            rank = <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n, <span class="number">0</span>);</span><br><span class="line">            sz_ = <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                parent[i] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (parent[x] != x) &#123;</span><br><span class="line">                parent[x] = parent[parent[x]];</span><br><span class="line">                x = parent[x];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">union_sets</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> rx = find(x), ry = find(y);</span><br><span class="line">            <span class="keyword">if</span> (rx != ry) &#123;</span><br><span class="line">                --sz;</span><br><span class="line">                <span class="keyword">if</span> (rank[rx] &lt; rank[ry]) &#123;</span><br><span class="line">                    swap(rx, ry);</span><br><span class="line">                &#125;</span><br><span class="line">                parent[ry] = rx;</span><br><span class="line">                sz_[rx] += sz_[ry];</span><br><span class="line">                <span class="keyword">if</span> (rank[rx] == rank[ry]) &#123;</span><br><span class="line">                    ++rank[rx];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> sz;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> sz_[find(x)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minMalwareSpread</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; initial)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = graph.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; clean(N, <span class="number">1</span>);</span><br><span class="line">        <span class="function">DSU <span class="title">d</span><span class="params">(N)</span></span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> n : initial) clean[n]=<span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="keyword">if</span>(clean[i]) <span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; N; ++j) <span class="keyword">if</span>(clean[j] &amp;&amp; graph[i][j]) d.union_sets(i, j);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt;&gt; nToC(N);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cnt(N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> n : initial)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) <span class="keyword">if</span>(graph[i][n] &amp;&amp; clean[i]) nToC[n].insert(d.find(i));</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> c : nToC[n]) cnt[c]++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sort(initial.begin(), initial.end());</span><br><span class="line">        <span class="keyword">int</span> ans = initial[<span class="number">0</span>], ansSize = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> n : initial)&#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> c : nToC[n]) <span class="keyword">if</span>(cnt[c] == <span class="number">1</span>) t += d.size(c);</span><br><span class="line">            <span class="keyword">if</span>(t &gt; ansSize) ansSize = t, ans = n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  另一种并查集解法是先用非传染点构建并查集，然后每次用除了某个传染点的其他所有传染点继续构建并查集，之后计算被感染的点数最少的或者索引最小的即为应该移除的点。其实是一种暴力解法，意外的性能很好。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span></span><br><span class="line"><span class="keyword">namespace</span> leetcode_union_find_52ms</span><br><span class="line">&#123;</span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">a_disjoint_set</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; roots;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ranks;</span><br><span class="line"></span><br><span class="line">  a_disjoint_set (<span class="keyword">int</span> <span class="keyword">const</span> N) : roots(N), ranks(N)</span><br><span class="line">  &#123;</span><br><span class="line">   iota(begin(roots),end(roots),<span class="number">0</span>);</span><br><span class="line">   fill(begin(ranks),end(ranks),<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">find</span> <span class="params">(<span class="keyword">int</span> <span class="keyword">const</span> i)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> roots[i] == i ? i : roots[i] = find(roots[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">join</span> <span class="params">(<span class="keyword">int</span> <span class="keyword">const</span> i, <span class="keyword">int</span> <span class="keyword">const</span> j)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">auto</span> <span class="keyword">const</span> [ri,rj] = tuple(find(i),find(j)); ri != rj)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">auto</span> <span class="keyword">const</span> [m,M] = minmax(&#123;ri,rj&#125;,[&amp;](<span class="keyword">auto</span>&amp;x,<span class="keyword">auto</span>&amp;y)&#123;<span class="keyword">return</span> ranks[x]&lt;ranks[y];&#125;);</span><br><span class="line">    roots[m] = M;</span><br><span class="line">    <span class="keyword">if</span> (ranks[m] == ranks[M]) &#123; ++ranks[M]; &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">a_solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;<span class="keyword">const</span>&amp; graph;</span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> N;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;<span class="keyword">const</span>&amp; malwares;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; ismalware;</span><br><span class="line">  a_disjoint_set ds;</span><br><span class="line"></span><br><span class="line">  a_solution (<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;<span class="keyword">const</span>&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;<span class="keyword">const</span>&amp; malwares)</span><br><span class="line">  : graph(graph), N(size(graph)), malwares(malwares), ismalware(N), ds(N)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> <span class="keyword">const</span> index : malwares)</span><br><span class="line">   &#123;</span><br><span class="line">    ismalware[index] = <span class="literal">true</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// join all non-malware nodes.</span></span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; N; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">if</span> (graph[i][j] &amp;&amp; !ismalware[i] &amp;&amp; !ismalware[j])</span><br><span class="line">     &#123;</span><br><span class="line">      ds.join(i,j);</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">a_candidate</span></span></span><br><span class="line"><span class="class">   &#123;</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (a_candidate <span class="keyword">const</span>&amp; that) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">return</span> tie(count,index) &lt; tie(that.count,that.index);</span><br><span class="line">    &#125;</span><br><span class="line">   &#125; best &#123;N+<span class="number">1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> candidate = <span class="number">0</span>; candidate &lt; N; ++candidate)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ismalware[candidate]) &#123; <span class="keyword">continue</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add all others</span></span><br><span class="line">    a_disjoint_set ds &#123;<span class="keyword">this</span>-&gt;ds&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> <span class="keyword">const</span> index : malwares)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">if</span> (index == candidate) &#123; <span class="keyword">continue</span>; &#125;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">     &#123;</span><br><span class="line">      <span class="keyword">if</span> (i != candidate &amp;&amp; i != index &amp;&amp; graph[index][i])</span><br><span class="line">      &#123;</span><br><span class="line">       ds.join(index,i);</span><br><span class="line">      &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// infected component sizes.</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sizes(N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">if</span> (i != candidate)</span><br><span class="line">     &#123;</span><br><span class="line">      ++sizes[ds.find(i)];</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// total infected node count.</span></span><br><span class="line">    <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; seen;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> <span class="keyword">const</span> malware : malwares)</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">if</span> (malware == candidate) &#123; <span class="keyword">continue</span>; &#125;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">int</span> <span class="keyword">const</span> root = ds.find(malware); seen.insert(root).second)</span><br><span class="line">     &#123;</span><br><span class="line">      size += sizes[root];</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    best = min(best,&#123;size,candidate&#125;);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> best.index;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;; <span class="comment">// solution</span></span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">minMalwareSpread</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;<span class="keyword">const</span>&amp; graph, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;<span class="keyword">const</span>&amp; initial)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> a_solution&#123;graph,initial&#125;.solve();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/22/1255-Maximum-Score-Words-Formed-by-Letters/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/22/1255-Maximum-Score-Words-Formed-by-Letters/" itemprop="url">1255. Maximum Score Words Formed by Letters</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-22T01:48:00+08:00">2020-02-22</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-22T01:49:26+08:00">2020-02-22</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1255-maximum-score-words-formed-by-letters"><a class="header-anchor" href="#1255-maximum-score-words-formed-by-letters">¶</a><a href="https://leetcode.com/problems/maximum-score-words-formed-by-letters/" target="_blank" rel="noopener">1255. Maximum Score Words Formed by Letters</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a list of <code>words</code>, list of  single <code>letters</code> (might be repeating) and <code>score</code> of every character.</p>
<p>Return the maximum score of <strong>any</strong> valid set of words formed by using the given letters (<code>words[i]</code> cannot be used two or more times).</p>
<p>It is not necessary to use all characters in <code>letters</code> and each letter can only be used once. Score of letters <code>'a'</code>, <code>'b'</code>, <code>'c'</code>, … ,<code>'z'</code> is given by <code>score[0]</code>, <code>score[1]</code>, … , <code>score[25]</code> respectively.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Input: words = [&quot;dog&quot;,&quot;cat&quot;,&quot;dad&quot;,&quot;good&quot;], letters = [&quot;a&quot;,&quot;a&quot;,&quot;c&quot;,&quot;d&quot;,&quot;d&quot;,&quot;d&quot;,&quot;g&quot;,&quot;o&quot;,&quot;o&quot;], score = [1,0,9,5,0,0,3,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0]</span><br><span class="line">Output: 23</span><br><span class="line">Explanation:</span><br><span class="line">Score  a=1, c=9, d=5, g=3, o=2</span><br><span class="line">Given letters, we can form the words &quot;dad&quot; (5+1+5) and &quot;good&quot; (3+2+2+5) with a score of 23.</span><br><span class="line">Words &quot;dad&quot; and &quot;dog&quot; only get a score of 21.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Input: words = [&quot;xxxz&quot;,&quot;ax&quot;,&quot;bx&quot;,&quot;cx&quot;], letters = [&quot;z&quot;,&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;x&quot;,&quot;x&quot;,&quot;x&quot;], score = [4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,10]</span><br><span class="line">Output: 27</span><br><span class="line">Explanation:</span><br><span class="line">Score  a=4, b=4, c=4, x=5, z=10</span><br><span class="line">Given letters, we can form the words &quot;ax&quot; (4+5), &quot;bx&quot; (4+5) and &quot;cx&quot; (4+5) with a score of 27.</span><br><span class="line">Word &quot;xxxz&quot; only get a score of 25.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: words = [&quot;leetcode&quot;], letters = [&quot;l&quot;,&quot;e&quot;,&quot;t&quot;,&quot;c&quot;,&quot;o&quot;,&quot;d&quot;], score = [0,0,1,1,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation:</span><br><span class="line">Letter &quot;e&quot; can only be used once.</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= words.length &lt;= 14</code></li>
<li><code>1 &lt;= words[i].length &lt;= 15</code></li>
<li><code>1 &lt;= letters.length &lt;= 100</code></li>
<li><code>letters[i].length == 1</code></li>
<li><code>score.length == 26</code></li>
<li><code>0 &lt;= score[i] &lt;= 10</code></li>
<li><code>words[i]</code>, <code>letters[i]</code> contains only lower case English letters.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>暴力法，遍历所有可能。</p>
<h6 id="非递归"><a class="header-anchor" href="#非递归">¶</a>非递归</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxScoreWords</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words, <span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&amp; letters, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; score)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">array</span>&lt;<span class="keyword">int</span>, 26&gt; count;</span><br><span class="line">    count.fill(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;c : letters) ++count[c - <span class="string">'a'</span>];</span><br><span class="line">    <span class="keyword">auto</span> N = words.size();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> canMake = [&amp;](<span class="keyword">int</span> subset, <span class="keyword">int</span> &amp;sr) &#123;</span><br><span class="line">        <span class="built_in">array</span>&lt;<span class="keyword">int</span>, <span class="number">26</span>&gt; cnt &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) <span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; i) &amp; subset) &#123;</span><br><span class="line">            <span class="keyword">auto</span> w = words[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> c : w) cnt[c - <span class="string">'a'</span>]++;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) <span class="keyword">if</span> (cnt[i] &gt; count[i])</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) <span class="keyword">if</span> (cnt[i]) &#123;</span><br><span class="line">            sr += cnt[i] * score[i];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> sw = (<span class="number">1</span> &lt;&lt; N) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// generates all subsets</span></span><br><span class="line">    <span class="keyword">int</span> x = sw;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        <span class="keyword">int</span> sr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (canMake(x, sr)) ans = max(ans, sr);</span><br><span class="line">        x = (x - <span class="number">1</span>) &amp; sw;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="递归"><a class="header-anchor" href="#递归">¶</a>递归</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; count;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; words;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; score;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getWord</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> value=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">bool</span> ok=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : words[i]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!count[c-<span class="string">'a'</span>]) &#123;</span><br><span class="line">                ok=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            count[c-<span class="string">'a'</span>]--;</span><br><span class="line">            value+= score[c-<span class="string">'a'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!ok)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">putWord</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : words[i]) &#123;</span><br><span class="line">            count[c-<span class="string">'a'</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxScoreWords</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(i == words.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> answer = maxScoreWords(i+<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> value = getWord(i);</span><br><span class="line">        <span class="keyword">if</span>(value != <span class="number">-1</span>) &#123;</span><br><span class="line">            answer = max(answer, maxScoreWords(i+<span class="number">1</span>)+value);</span><br><span class="line">        &#125;</span><br><span class="line">        putWord(i);</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxScoreWords</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words, <span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&amp; letters, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; score)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> nwords = words.size();</span><br><span class="line">        <span class="keyword">int</span> nletters = letters.size();</span><br><span class="line">        count.resize(<span class="number">26</span>);</span><br><span class="line">        <span class="keyword">this</span>-&gt;words = words;</span><br><span class="line">        <span class="keyword">this</span>-&gt;score = score;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c : letters) &#123;</span><br><span class="line">            count[c-<span class="string">'a'</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> maxScoreWords(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/21/847-Shortest-Path-Visiting-All-Nodes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/21/847-Shortest-Path-Visiting-All-Nodes/" itemprop="url">847. Shortest Path Visiting All Nodes</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-21T23:22:29+08:00">2020-02-21</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-22T00:50:10+08:00">2020-02-22</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="847-shortest-path-visiting-all-nodes"><a class="header-anchor" href="#847-shortest-path-visiting-all-nodes">¶</a><a href="https://leetcode.com/problems/shortest-path-visiting-all-nodes/" target="_blank" rel="noopener">847. Shortest Path Visiting All Nodes</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>An undirected, connected graph of N nodes (labeled <code>0, 1, 2, ..., N-1</code>) is given as <code>graph</code>.</p>
<p><code>graph.length = N</code>, and <code>j != i</code> is in the list <code>graph[i]</code> exactly once, if and only if nodes <code>i</code> and <code>j</code> are connected.</p>
<p>Return the length of the shortest path that visits every node. You may start and stop at any node, you may revisit nodes multiple times, and you may reuse edges.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [[1,2,3],[0],[0],[0]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: One possible path is [1,0,2,0,3]</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [[1],[0,2,4],[1,3,4],[2],[1,2]]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: One possible path is [0,1,4,2,3]</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= graph.length &lt;= 12</code></li>
<li><code>0 &lt;= graph[i].length &lt; graph.length</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-bfs"><a class="header-anchor" href="#法一-bfs">¶</a>法一 bfs</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">shortestPathLength</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        <span class="keyword">int</span> n = graph.size(), m = <span class="number">1</span>&lt;&lt;n;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(m , <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n, INT_MAX));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span> ;i &lt; n; ++i)&#123; q.push(&#123;<span class="number">1</span>&lt;&lt;i, i&#125;); dp[<span class="number">1</span>&lt;&lt;i][i] = <span class="number">0</span>; &#125;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> [state, node] = q.front();q.pop();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : graph[node])&#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[<span class="number">1</span>&lt;&lt;x|state][x] &lt;= dp[state][node]+<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                q.push(&#123;<span class="number">1</span>&lt;&lt;x|state, x&#125;);</span><br><span class="line">                dp[<span class="number">1</span>&lt;&lt;x|state][x] = dp[state][node]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *min_element(dp.back().begin(), dp.back().end());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-状态压缩dp"><a class="header-anchor" href="#法二-状态压缩dp">¶</a>法二 状态压缩dp</h6>
<p>  加上<code>for(int k = 0; k &lt; 2; k++)</code>这一句的原因：之前访问过的节点可能又访问一次。比如example1的[1,0,2,0,3]，1,0,2,0和1,0,2对应状态一样都是7(111)，但是1,0,2,0是由1,0,2转移过来的，它们状态都是7，即dp[7][0]其实等于dp[7][2]+1。如果你只求一遍（即while(repeat)循环），就可能会导致你用dp[7][2]更新完dp[7][0]，你又有了新的dp[7][0]值，但是用dp[7][0]扩展路径的那一步循环已经过去了，你没有对dp[7][0]进行扩展，可能会漏掉一些路径。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">shortestPathLength</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = graph.size(), m = <span class="number">1</span>&lt;&lt;n;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(m, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n, INT_MAX));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) dp[<span class="number">1</span>&lt;&lt;i][i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m<span class="number">-1</span>; ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; k++)&#123;</span><br><span class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;n; ++j)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(dp[i][j] != INT_MAX) </span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x: graph[j]) </span><br><span class="line">                            dp[i|(<span class="number">1</span>&lt;&lt;x)][x] = min(dp[i|(<span class="number">1</span>&lt;&lt;x)][x], dp[i][j]+<span class="number">1</span>);</span><br><span class="line">                &#125; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> *min_element(dp.back().begin(), dp.back().end());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">445</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">119</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
