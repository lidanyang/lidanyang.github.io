<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/21/378-Kth-Smallest-Element-in-a-Sorted-Matrix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/21/378-Kth-Smallest-Element-in-a-Sorted-Matrix/" itemprop="url">378. Kth Smallest Element in a Sorted Matrix</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-21T21:25:21+08:00">2020-01-21</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-21T21:43:02+08:00">2020-01-21</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="378-kth-smallest-element-in-a-sorted-matrix"><a class="header-anchor" href="#378-kth-smallest-element-in-a-sorted-matrix">¶</a><a href="https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/" target="_blank" rel="noopener">378. Kth Smallest Element in a Sorted Matrix</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given a <em>n</em> x <em>n</em> matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.</p>
<p>Note that it is the kth smallest element in the sorted order, not the kth distinct element.</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">matrix = [</span><br><span class="line">   [ 1,  5,  9],</span><br><span class="line">   [10, 11, 13],</span><br><span class="line">   [12, 13, 15]</span><br><span class="line">],</span><br><span class="line">k = 8,</span><br><span class="line"></span><br><span class="line">return 13.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong><br>
You may assume k is always valid, 1 ≤ k ≤ n<sup>2</sup>.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  下面三个方法都是二分，只是统计小于某个数的数的个数的方法不同。法一的统计个数的方法最妙，法三的代码量最短，法二运行速度最快。</p>
<h5 id="法一"><a class="header-anchor" href="#法一">¶</a>法一</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;A, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> c=<span class="number">0</span>, n=A.size(), i=n<span class="number">-1</span>, j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&gt;=<span class="number">0</span> &amp;&amp; j&lt;n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[i][j]&lt;=t) &#123;</span><br><span class="line">                c+=i+<span class="number">1</span>;</span><br><span class="line">                j++;</span><br><span class="line">            &#125; <span class="keyword">else</span> i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=matrix.size(), b=matrix[<span class="number">0</span>][<span class="number">0</span>], e=matrix[n<span class="number">-1</span>][n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span>(b&lt;=e) &#123;</span><br><span class="line">            <span class="keyword">int</span> m=b+(e-b)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> c=helper(matrix, m);</span><br><span class="line">            <span class="keyword">if</span> (c&lt;k) b=m+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> e=m<span class="number">-1</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二"><a class="header-anchor" href="#法二">¶</a>法二</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; A, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N=A.size();</span><br><span class="line">        <span class="keyword">int</span> L=A[<span class="number">0</span>][<span class="number">0</span>], R=A[N<span class="number">-1</span>][N<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span>(R&gt;L)</span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">int</span> M=(L+R+<span class="number">0</span>)/<span class="number">2</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;N &amp;&amp; A[N<span class="number">-1</span>][j] &lt;= M) j++;</span><br><span class="line">            cnt+=j;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-2</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">            &#123;</span><br><span class="line">                cnt+=upper_bound(A[i].begin(), A[i].end(), M)-A[i].begin();</span><br><span class="line">                <span class="comment">// while(j&lt;N &amp;&amp; A[i][j] &lt;= M) j++;</span></span><br><span class="line">                <span class="comment">// cnt+=j;</span></span><br><span class="line">            &#125;</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">if</span>(cnt&gt;=k) R=M;</span><br><span class="line">            <span class="keyword">else</span>       L=M+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        assert(L==R);</span><br><span class="line">        <span class="keyword">return</span> L;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三"><a class="header-anchor" href="#法三">¶</a>法三</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix, <span class="keyword">int</span> k)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> size = matrix.size(), l = matrix[<span class="number">0</span>][<span class="number">0</span>], r = matrix[size<span class="number">-1</span>][size<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span>(l &lt; r)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> smaller = <span class="number">0</span>, m = l+((r-l)&gt;&gt;<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) </span><br><span class="line">                smaller += upper_bound(matrix[i].begin(), matrix[i].end(), m)-matrix[i].begin();</span><br><span class="line">            smaller&lt;k? l=m+<span class="number">1</span> : r=m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/21/629-K-Inverse-Pairs-Array/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/21/629-K-Inverse-Pairs-Array/" itemprop="url">629. K Inverse Pairs Array</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-21T18:08:00+08:00">2020-01-21</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-21T18:41:05+08:00">2020-01-21</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="629-k-inverse-pairs-array"><a class="header-anchor" href="#629-k-inverse-pairs-array">¶</a><a href="https://leetcode.com/problems/k-inverse-pairs-array/" target="_blank" rel="noopener">629. K Inverse Pairs Array</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given two integers <code>n</code> and <code>k</code>, find how many different arrays consist of numbers from <code>1</code> to <code>n</code> such that there are exactly <code>k</code> inverse pairs.</p>
<p>We define an inverse pair as following: For <code>i&lt;sub style=&quot;display: inline;&quot;&gt;th&lt;/sub&gt;</code> and <code>j&lt;sub style=&quot;display: inline;&quot;&gt;th&lt;/sub&gt;</code> element in the array, if <code>i</code> &lt; <code>j</code> and <code>a[i]</code> &gt; <code>a[j]</code> then it’s an inverse pair; Otherwise, it’s not.</p>
<p>Since the answer may be very large, the answer should be modulo 10<sup>9</sup> + 7.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: n = 3, k = 0</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: </span><br><span class="line">Only the array [1,2,3] which consists of numbers from 1 to 3 has exactly 0 inverse pair.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: n = 3, k = 1</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: </span><br><span class="line">The array [1,3,2] and [2,1,3] have exactly 1 inverse pair.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The integer <code>n</code> is in the range [1, 1000] and <code>k</code> is in the range [0, 1000].</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  观察往1-n-1中插入一个n会增加几个逆序对，递推式就很明显了。</p>
<p>  递推式: <code>dp[n][k]=dp[n-1][k]+dp[n-1][k-1]+...+dp[n-1][min(0, k-(n-1))]</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> p=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kInversePairs</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp[n+<span class="number">1</span>][k+<span class="number">1</span>]&#123;&#125;;</span><br><span class="line">        dp[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> t=i*(i<span class="number">-1</span>)/<span class="number">2</span>, j, sum=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;=k&amp;&amp;j&lt;=t;++j)&#123;</span><br><span class="line">                sum=(sum+dp[i<span class="number">-1</span>][j])%p;</span><br><span class="line">                <span class="keyword">if</span>(j&gt;=i) sum=(sum-dp[i<span class="number">-1</span>][j-i]+p)%p;</span><br><span class="line">                dp[i][j]=sum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n][k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line">​</span><br></pre></td></tr></table></figure>
<p>空间优化：滚动数组</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kInversePairs</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">2</span>][k+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=k;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                dp[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[<span class="number">1</span>][i] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> b = i%<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j&lt;=k;j++) &#123;</span><br><span class="line">                sum = (sum + dp[<span class="number">1</span>-b][j]) % MOD;</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= i) &#123;</span><br><span class="line">                    sum = (sum - dp[<span class="number">1</span>-b][j-i] + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[b][j] = sum;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n%<span class="number">2</span>][k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h3>
<p>  一开始就有思路却做了一个小时，因为思路不清晰。刚开始认为递推式是<code>dp[n][k]=dp[n-1][k]+dp[n-1][k-1]+...+dp[n-1][0]</code>，但是这是错的。因为从n-1个数推出n个数的过程是，把n插入到1~n-1这n-1个数中，最多有n个插入位置，所以最多只能加n个<code>dp[n-1][j]</code>项，而上面的递推式直接加到<code>dp[n-1][0]</code>，忽略了k大于n时的可能性，正确的递推式应该是<code>dp[n][k]=dp[n-1][k]+dp[n-1][k-1]+...+dp[n-1][min(0, k-(n-1))]</code>，这样<code>dp[n][k]</code>就是<code>[dp[n-1][0], dp[n-1][1], ..., dp[n-1][k]]</code>的大小为n的滑动窗口和（开始窗口大小是1，然后逐渐增加到n，然后维持窗口大小不变）。</p>
<p>  另外，一开始想出递推式的时候，因为求<code>dp[n][k]</code>是<code>dp[n-1][j]</code>的区间和，所以想写三重循环(时间复杂度O(n^3))，却超时了，却没想到连续和可以用滑动窗口求。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/21/778-Swim-in-Rising-Water/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/21/778-Swim-in-Rising-Water/" itemprop="url">778. Swim in Rising Water</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-21T02:44:16+08:00">2020-01-21</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-21T02:52:30+08:00">2020-01-21</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="778-swim-in-rising-water"><a class="header-anchor" href="#778-swim-in-rising-water">¶</a><a href="https://leetcode.com/problems/swim-in-rising-water/" target="_blank" rel="noopener">778. Swim in Rising Water</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>On an N x N <code>grid</code>, each square <code>grid[i][j]</code> represents the elevation at that point <code>(i,j)</code>.</p>
<p>Now rain starts to fall. At time <code>t</code>, the depth of the water everywhere is <code>t</code>. You can swim from a square to another 4-directionally adjacent square if and only if the elevation of both squares individually are at most <code>t</code>. You can swim infinite distance in zero time. Of course, you must stay within the boundaries of the grid during your swim.</p>
<p>You start at the top left square <code>(0, 0)</code>. What is the least time until you can reach the bottom right square <code>(N-1, N-1)</code>?</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Input: [[0,2],[1,3]]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation:</span><br><span class="line">At time 0, you are in grid location (0, 0).</span><br><span class="line">You cannot go anywhere else because 4-directionally adjacent neighbors have a higher elevation than t = 0.</span><br><span class="line"></span><br><span class="line">You cannot reach point (1, 1) until time 3.</span><br><span class="line">When the depth of water is 3, we can swim anywhere inside the grid.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Input: [[0,1,2,3,4],[24,23,22,21,5],[12,13,14,15,16],[11,17,18,19,20],[10,9,8,7,6]]</span><br><span class="line">Output: 16</span><br><span class="line">Explanation:</span><br><span class="line"> 0  1  2  3  4</span><br><span class="line">24 23 22 21  5</span><br><span class="line">12 13 14 15 16</span><br><span class="line">11 17 18 19 20</span><br><span class="line">10  9  8  7  6</span><br><span class="line"></span><br><span class="line">The final route is marked in bold.</span><br><span class="line">We need to wait until time 16 so that (0, 0) and (4, 4) are connected.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>2 &lt;= N &lt;= 50</code>.</li>
<li>grid[i][j] is a permutation of [0, …, N*N - 1].</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-并查集"><a class="header-anchor" href="#法一-并查集">¶</a>法一 并查集</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x==a[x]?x:a[x]=Find(a[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Union</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rx= Find(x), ry=Find(y);</span><br><span class="line">        <span class="keyword">if</span>(rx != ry)&#123;</span><br><span class="line">            a[rx] = ry;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">swimInWater</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = grid.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pos(N * N);</span><br><span class="line">        a.resize(N*N);</span><br><span class="line">        iota(a.begin(), a.end(), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;++j)&#123;</span><br><span class="line">                pos[grid[i][j]] = i * N + j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; d&#123;&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N*N; ++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> x=pos[i]/N, y=pos[i]%N;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(x+d[j].first&gt;=<span class="number">0</span>&amp;&amp;x+d[j].first&lt;N&amp;&amp;</span><br><span class="line">                  y+d[j].second&gt;=<span class="number">0</span>&amp;&amp;y+d[j].second&lt;N&amp;&amp;grid[x+d[j].first][y+d[j].second]&lt;i)&#123;</span><br><span class="line">                    Union(pos[i], pos[grid[x+d[j].first][y+d[j].second]]);    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(Find(N*N<span class="number">-1</span>)==Find(<span class="number">0</span>)) <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> N*N;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dfs-二分"><a class="header-anchor" href="#法二-dfs-二分">¶</a>法二 dfs+二分</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; &amp;grid, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt; &amp;vis, <span class="keyword">int</span> px, <span class="keyword">int</span> py, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (grid[px][py] &gt; t) <span class="keyword">return</span>;</span><br><span class="line">        vis[px][py] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (px &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[px<span class="number">-1</span>][py]) dfs(grid, vis, px<span class="number">-1</span>, py, t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (py &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[px][py<span class="number">-1</span>]) dfs(grid, vis, px, py<span class="number">-1</span>, t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (px &lt; grid.size() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[px+<span class="number">1</span>][py]) dfs(grid, vis, px+<span class="number">1</span>, py, t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (py &lt; grid.size() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!vis[px][py+<span class="number">1</span>]) dfs(grid, vis, px, py+<span class="number">1</span>, t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">pos</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp;grid, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = grid.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt; vis(N, <span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;(N));</span><br><span class="line">        dfs(grid, vis, <span class="number">0</span>, <span class="number">0</span>, t);</span><br><span class="line">        <span class="keyword">return</span> vis[N<span class="number">-1</span>][N<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">swimInWater</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> hi = <span class="number">50</span>*<span class="number">50</span>;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (hi + lo) / <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//    cout &lt;&lt; lo &lt;&lt; " "&lt;&lt;mid &lt;&lt;" " &lt;&lt;hi&lt;&lt;endl;</span></span><br><span class="line">            <span class="keyword">if</span> (pos(grid, mid)) hi = mid;</span><br><span class="line">            <span class="keyword">else</span> lo = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="bfs-dijiskra"><a class="header-anchor" href="#bfs-dijiskra">¶</a>BFS+dijiskra</h5>
<p>  由于该问题有最短路的性质（某条路径的长度即路径上最高点的高度），所以可以用dijiskra求解，只是把求<strong>最短路</strong>变成了求<strong>最小时间</strong>。利用BFS进行堆优化的dijiskra，。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Dijkstra Algorithm with priority queue, BFS;</span></span><br><span class="line"><span class="comment">// 2. Keep track the distance from the start point [0, 0] to node [i, j];</span></span><br><span class="line"><span class="comment">// 3. track the max time on the path through this point. the max time to </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">swimInWater</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; grid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> n = grid.size();</span><br><span class="line">    priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q; <span class="comment">// &#123;-time, y * N + x&#125;   // the MAX of the min distance from start point to this point. </span></span><br><span class="line">    q.push(&#123;-grid[<span class="number">0</span>][<span class="number">0</span>], <span class="number">0</span> * n + <span class="number">0</span>&#125;); <span class="comment">// maxHeap, but here turn the element to negative, then turn it to minHeap; </span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; visited(n * n); <span class="comment">// visited</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dirs&#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;; <span class="comment">// directions</span></span><br><span class="line">    visited[<span class="number">0</span> * n + <span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">      <span class="keyword">auto</span> node = q.top(); q.pop(); <span class="comment">// we pick up the max value in the pq, which is with the shortest distance to the start point. </span></span><br><span class="line">      <span class="keyword">int</span> t = -node.first;</span><br><span class="line">      <span class="keyword">int</span> x = node.second % n;</span><br><span class="line">      <span class="keyword">int</span> y = node.second / n;      </span><br><span class="line">      <span class="keyword">if</span> (x == n - <span class="number">1</span> &amp;&amp; y == n - <span class="number">1</span>) <span class="keyword">return</span> t; <span class="comment">// current time is the shortest time, from the pq. </span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;  <span class="comment">// otherwise, explore the neighbour point. </span></span><br><span class="line">        <span class="keyword">int</span> tx = x + dirs[i];</span><br><span class="line">        <span class="keyword">int</span> ty = y + dirs[i + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (tx &lt; <span class="number">0</span> || ty &lt; <span class="number">0</span> || tx &gt;= n || ty &gt;= n) <span class="keyword">continue</span>; <span class="comment">// this step out of bounadry</span></span><br><span class="line">        <span class="keyword">if</span> (visited[ty * n + tx]) <span class="keyword">continue</span>; <span class="comment">// this step has been visited</span></span><br><span class="line">        visited[ty * n + tx] = <span class="number">1</span>; </span><br><span class="line">        q.push(&#123;-max(t, grid[ty][tx]), ty * n + tx&#125;); <span class="comment">// check the max time at this point, track the max time on the path through this point. </span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/21/773-Sliding-Puzzle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/21/773-Sliding-Puzzle/" itemprop="url">773. Sliding Puzzle</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-21T02:07:57+08:00">2020-01-21</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-21T02:11:21+08:00">2020-01-21</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="773-sliding-puzzle"><a class="header-anchor" href="#773-sliding-puzzle">¶</a><a href="https://leetcode.com/problems/sliding-puzzle/" target="_blank" rel="noopener">773. Sliding Puzzle</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>On a 2x3 <code>board</code>, there are 5 tiles represented by the integers 1 through 5, and an empty square represented by 0.</p>
<p>A move consists of choosing <code>0</code> and a 4-directionally adjacent number and swapping it.</p>
<p>The state of the board is <em>solved</em> if and only if the <code>board</code> is <code>[[1,2,3],[4,5,0]].</code></p>
<p>Given a puzzle board, return the least number of moves required so that the state of the board is solved. If it is impossible for the state of the board to be solved, return -1.</p>
<p><strong>Examples:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = [[1,2,3],[4,0,5]]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: Swap the 0 and the 5 in one move.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = [[1,2,3],[5,4,0]]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: No number of moves will make the board solved.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input: board = [[4,1,2],[5,0,3]]</span><br><span class="line">Output: 5</span><br><span class="line">Explanation: 5 is the smallest number of moves that solves the board.</span><br><span class="line">An example path:</span><br><span class="line">After move 0: [[4,1,2],[5,0,3]]</span><br><span class="line">After move 1: [[4,1,2],[0,5,3]]</span><br><span class="line">After move 2: [[0,1,2],[4,5,3]]</span><br><span class="line">After move 3: [[1,0,2],[4,5,3]]</span><br><span class="line">After move 4: [[1,2,0],[4,5,3]]</span><br><span class="line">After move 5: [[1,2,3],[4,5,0]]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: board = [[3,2,4],[1,5,0]]</span><br><span class="line">Output: 14</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li><code>board</code> will be a 2 x 3 array as described above.</li>
<li><code>board[i][j]</code> will be a permutation of <code>[0, 1, 2, 3, 4, 5]</code>.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-bfs"><a class="header-anchor" href="#法一-bfs">¶</a>法一 BFS</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; moves&#123;&#123;<span class="number">0</span>,&#123;<span class="number">1</span>,<span class="number">3</span>&#125;&#125;,&#123;<span class="number">1</span>,&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>&#125;&#125;,&#123;<span class="number">2</span>,&#123;<span class="number">1</span>,<span class="number">5</span>&#125;&#125;,&#123;<span class="number">3</span>,&#123;<span class="number">0</span>,<span class="number">4</span>&#125;&#125;,&#123;<span class="number">4</span>,&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">1</span>&#125;&#125;,&#123;<span class="number">5</span>,&#123;<span class="number">4</span>,<span class="number">2</span>&#125;&#125;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">slidingPuzzle</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; b)</span> </span>&#123;</span><br><span class="line">      <span class="built_in">string</span> s = to_string(b[<span class="number">0</span>][<span class="number">0</span>]) + to_string(b[<span class="number">0</span>][<span class="number">1</span>]) + to_string(b[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">        + to_string(b[<span class="number">1</span>][<span class="number">0</span>]) + to_string(b[<span class="number">1</span>][<span class="number">1</span>]) + to_string(b[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; m(&#123;&#123;s, <span class="number">0</span>&#125;&#125;);</span><br><span class="line">      <span class="built_in">queue</span>&lt;pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;&gt; q(&#123;&#123;s, s.find(<span class="string">'0'</span>)&#125;&#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (;!q.empty() &amp;&amp; q.front().first != <span class="string">"123450"</span>;q.pop()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> new_zero : moves[q.front().second]) &#123;</span><br><span class="line">          <span class="keyword">auto</span> str = q.front().first;</span><br><span class="line">          swap(str[q.front().second], str[new_zero]);</span><br><span class="line">          <span class="keyword">if</span> (m.insert(&#123;str, m[q.front().first] + <span class="number">1</span>&#125;).second) q.push(&#123; str, new_zero &#125;);</span><br><span class="line">        &#125;   </span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> q.empty() ? <span class="number">-1</span> : m[q.front().first];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dfs"><a class="header-anchor" href="#法二-dfs">¶</a>法二 DFS</h5>
<p>  DFS不是最快的方法，但是比较难写。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; moves&#123;&#123;<span class="number">0</span>,&#123;<span class="number">1</span>,<span class="number">3</span>&#125;&#125;,&#123;<span class="number">1</span>,&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>&#125;&#125;,&#123;<span class="number">2</span>,&#123;<span class="number">1</span>,<span class="number">5</span>&#125;&#125;,&#123;<span class="number">3</span>,&#123;<span class="number">0</span>,<span class="number">4</span>&#125;&#125;,&#123;<span class="number">4</span>,&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">1</span>&#125;&#125;,&#123;<span class="number">5</span>,&#123;<span class="number">4</span>,<span class="number">2</span>&#125;&#125;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">string</span> s, <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;&amp; m, <span class="keyword">int</span> cur_zero, <span class="keyword">int</span> swap_zero, <span class="keyword">int</span> cur_move, <span class="keyword">int</span>&amp; min_moves)</span> </span>&#123;</span><br><span class="line">      swap(s[cur_zero], s[swap_zero]);</span><br><span class="line">      <span class="keyword">if</span> (s == <span class="string">"123450"</span>) min_moves = min(min_moves, cur_move);</span><br><span class="line">      <span class="keyword">if</span> (cur_move &lt; min_moves &amp;&amp; (m[s] == <span class="number">0</span> || m[s] &gt; cur_move)) &#123;</span><br><span class="line">        m[s] = cur_move;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> new_zero : moves[swap_zero]) dfs(s, m, swap_zero, new_zero, cur_move + <span class="number">1</span>, min_moves);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">slidingPuzzle</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; b, <span class="keyword">int</span> min_moves = INT_MAX)</span> </span>&#123;</span><br><span class="line">      <span class="built_in">string</span> s = to_string(b[<span class="number">0</span>][<span class="number">0</span>]) + to_string(b[<span class="number">0</span>][<span class="number">1</span>]) + to_string(b[<span class="number">0</span>][<span class="number">2</span>]) </span><br><span class="line">        + to_string(b[<span class="number">1</span>][<span class="number">0</span>]) + to_string(b[<span class="number">1</span>][<span class="number">1</span>]) + to_string(b[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">      dfs(s, <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;() = &#123;&#125;, s.find(<span class="string">'0'</span>), s.find(<span class="string">'0'</span>), <span class="number">0</span>, min_moves);</span><br><span class="line">      <span class="keyword">return</span> min_moves == INT_MAX ? <span class="number">-1</span> : min_moves;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/20/488-Zuma-Game/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/20/488-Zuma-Game/" itemprop="url">488. Zuma Game</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-20T22:22:30+08:00">2020-01-20</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-20T22:50:17+08:00">2020-01-20</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="488-zuma-game"><a class="header-anchor" href="#488-zuma-game">¶</a><a href="https://leetcode.com/problems/zuma-game/" target="_blank" rel="noopener">488. Zuma Game</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Think about Zuma Game. You have a row of balls on the table, colored red®, yellow(Y), blue(B), green(G), and white(W). You also have several balls in your hand.</p>
<p>Each time, you may choose a ball in your hand, and insert it into the row (including the leftmost place and rightmost place). Then, if there is a group of 3 or more balls in the same color touching, remove these balls. Keep doing this until no more balls can be removed.</p>
<p>Find the minimal balls you have to insert to remove all the balls on the table. If you cannot remove all the balls, output -1.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = &quot;WRRBBW&quot;, hand = &quot;RB&quot;</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: WRRBBW -&gt; WRR[R]BBW -&gt; WBBW -&gt; WBB[B]W -&gt; WW</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = &quot;WWRRBBWW&quot;, hand = &quot;WRBRW&quot;</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: WWRRBBWW -&gt; WWRR[R]BBWW -&gt; WWBBWW -&gt; WWBB[B]WW -&gt; WWWW -&gt; empty</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = &quot;G&quot;, hand = &quot;GGGGG&quot;</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: G -&gt; G[G] -&gt; GG[G] -&gt; empty</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: board = &quot;RBYYBBRRB&quot;, hand = &quot;YRBGB&quot;</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: RBYYBBRRB -&gt; RBYY[Y]BBRRB -&gt; RBBBRRB -&gt; RRRB -&gt; B -&gt; B[B] -&gt; BB[B] -&gt; empty</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li>You may assume that the initial row of balls on the table won’t have any 3 or more consecutive balls with the same color.</li>
<li>The number of balls on the table won’t exceed 16, and the string represents these balls is called “board” in the input.</li>
<li>The number of balls in your hand won’t exceed 5, and the string represents these balls is called “hand” in the input.</li>
<li>Both input strings will be non-empty and only contain characters ‘R’,‘Y’,‘B’,‘G’,‘W’.</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  dfs暴力搜索。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMinStep</span><span class="params">(<span class="built_in">string</span> board, <span class="built_in">string</span> hand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = INT_MAX;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : hand) ++m[c];</span><br><span class="line">        res = helper(board, m);</span><br><span class="line">        <span class="keyword">return</span> res == INT_MAX ? <span class="number">-1</span> : res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="built_in">string</span> board, <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt;&amp; m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (board.empty()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt = INT_MAX, j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= board.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; board.size() &amp;&amp; board[i] == board[j]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> need = <span class="number">3</span> - (i - j);</span><br><span class="line">            <span class="keyword">if</span> (m[board[j]] &gt;= need) &#123;</span><br><span class="line">                <span class="keyword">if</span>(need &lt; <span class="number">0</span>) need = <span class="number">0</span>;</span><br><span class="line">                m[board[j]] -= need;</span><br><span class="line">                <span class="keyword">int</span> t = helper(board.substr(<span class="number">0</span>, j) + board.substr(i), m);</span><br><span class="line">                <span class="keyword">if</span> (t != INT_MAX) cnt = min(cnt, t + need);</span><br><span class="line">                m[board[j]] += need;</span><br><span class="line">            &#125;</span><br><span class="line">            j = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="常见错误解法"><a class="header-anchor" href="#常见错误解法">¶</a>常见错误解法</h2>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMinStep</span><span class="params">(<span class="built_in">string</span> board, <span class="built_in">string</span> hand)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = INT_MAX;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : hand) ++m[c];</span><br><span class="line">        res = helper(board, m);</span><br><span class="line">        <span class="keyword">return</span> res == INT_MAX ? <span class="number">-1</span> : res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">helper</span><span class="params">(<span class="built_in">string</span> board, <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt;&amp; m)</span> </span>&#123;</span><br><span class="line">        board = removeConsecutive(board);</span><br><span class="line">        <span class="keyword">if</span> (board.empty()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt = INT_MAX, j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= board.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; board.size() &amp;&amp; board[i] == board[j]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> need = <span class="number">3</span> - (i - j);</span><br><span class="line">            <span class="keyword">if</span> (m[board[j]] &gt;= need) &#123;</span><br><span class="line">                m[board[j]] -= need;</span><br><span class="line">                <span class="keyword">int</span> t = helper(board.substr(<span class="number">0</span>, j) + board.substr(i), m);</span><br><span class="line">                <span class="keyword">if</span> (t != INT_MAX) cnt = min(cnt, t + need);</span><br><span class="line">                m[board[j]] += need;</span><br><span class="line">            &#125;</span><br><span class="line">            j = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">removeConsecutive</span><span class="params">(<span class="built_in">string</span> board)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt;= board.size(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; board.size() &amp;&amp; board[i] == board[j]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (i - j &gt;= <span class="number">3</span>) <span class="keyword">return</span> removeConsecutive(board.substr(<span class="number">0</span>, j) + board.substr(i));</span><br><span class="line">            <span class="keyword">else</span> j = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> board;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/20/407-Trapping-Rain-Water-II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/20/407-Trapping-Rain-Water-II/" itemprop="url">407. Trapping Rain Water II</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-20T16:37:01+08:00">2020-01-20</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-20T16:42:36+08:00">2020-01-20</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="407-trapping-rain-water-ii"><a class="header-anchor" href="#407-trapping-rain-water-ii">¶</a><a href="https://leetcode.com/problems/trapping-rain-water-ii/" target="_blank" rel="noopener">407. Trapping Rain Water II</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given an <code>m x n</code> matrix of positive integers representing the height of each unit cell in a 2D elevation map, compute the volume of water it is able to trap after raining.</p>
<p><strong>Note:</strong></p>
<p>Both <em>m</em> and <em>n</em> are less than 110. The height of each unit cell is greater than 0 and is less than 20,000.</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Given the following 3x6 height map:</span><br><span class="line">[</span><br><span class="line">  [1,4,3,1,3,2],</span><br><span class="line">  [3,2,1,3,2,4],</span><br><span class="line">  [2,3,3,2,3,1]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">Return 4.</span><br></pre></td></tr></table></figure>
<p><img src="https://assets.leetcode.com/uploads/2018/10/13/rainwater_empty.png" alt></p>
<p>The above image represents the elevation map <code>[[1,4,3,1,3,2],[3,2,1,3,2,4],[2,3,3,2,3,1]]</code> before the rain.</p>
<p><img src="https://assets.leetcode.com/uploads/2018/10/13/rainwater_fill.png" alt></p>
<p>After the rain, water is trapped between the blocks. The total volume of water trapped is 4.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  c++优先级队列不要用<code>priority_queue&lt;vector&lt;int&gt;&gt; q;</code>，最好是自己定义一个数据结构，比如下面的GridPoint。</p>
<p>  这题的思路类似于拆木桶，每次都拆最短的一个挡板，然后看这个最短的附近有没有更短的，如果有就能盛水，否则就不能盛水。</p>
<p>  更详细的解释见下面的视频:</p>
<ol>
<li><a href="https://www.bilibili.com/video/av75654438?from=search&amp;seid=3727318853522837108" target="_blank" rel="noopener">https://www.bilibili.com/video/av75654438?from=search&amp;seid=3727318853522837108</a></li>
</ol>
<ol start="2">
<li><a href="https://www.bilibili.com/video/av80545040?from=search&amp;seid=3727318853522837108" target="_blank" rel="noopener">https://www.bilibili.com/video/av80545040?from=search&amp;seid=3727318853522837108</a></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GridPoint</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> height;</span><br><span class="line">  <span class="keyword">int</span> r;</span><br><span class="line">  <span class="keyword">int</span> c;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> GridPoint&amp; a, <span class="keyword">const</span> GridPoint&amp; b) &#123;</span><br><span class="line">  <span class="keyword">return</span> a.height &gt; b.height;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trapRainWater</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; heightMap)</span> </span>&#123;</span><br><span class="line">        priority_queue&lt;GridPoint&gt; q;</span><br><span class="line">        <span class="keyword">if</span>(heightMap.size()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> r=heightMap.size(),c=heightMap[<span class="number">0</span>].size(),ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r;++i)&#123;</span><br><span class="line">            q.push(&#123;heightMap[i][<span class="number">0</span>], i, <span class="number">0</span>&#125;);heightMap[i][<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">            q.push(&#123;heightMap[i][c<span class="number">-1</span>], i, c<span class="number">-1</span>&#125;);heightMap[i][c<span class="number">-1</span>]=<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;c;++i)&#123;</span><br><span class="line">            q.push(&#123;heightMap[<span class="number">0</span>][i], <span class="number">0</span>, i&#125;);heightMap[<span class="number">0</span>][i]=<span class="number">-1</span>;</span><br><span class="line">            q.push(&#123;heightMap[r<span class="number">-1</span>][i], r<span class="number">-1</span>, i&#125;);heightMap[r<span class="number">-1</span>][i]=<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; d&#123;&#123;<span class="number">-1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">1</span>&#125;,&#123;<span class="number">0</span>,<span class="number">-1</span>&#125;&#125;;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> p=q.top();q.pop();</span><br><span class="line">            <span class="keyword">int</span> x=p.r, y=p.c, h=p.height, dx, dy;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">4</span>;++i)&#123;</span><br><span class="line">                dx=d[i].first, dy=d[i].second;</span><br><span class="line">                <span class="keyword">if</span>(x+dx&gt;=<span class="number">0</span>&amp;&amp;x+dx&lt;r&amp;&amp;y+dy&gt;=<span class="number">0</span>&amp;&amp;y+dy&lt;c&amp;&amp;heightMap[x+dx][y+dy]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">                    ans += max(<span class="number">0</span>, h-heightMap[x+dx][y+dy]);</span><br><span class="line">                    q.push(&#123;max(h, heightMap[x+dx][y+dy]), x+dx, y+dy&#125;);</span><br><span class="line">                    heightMap[x+dx][y+dy]=<span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/20/583-Delete-Operation-for-Two-Strings-LCS-空间复杂度优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/20/583-Delete-Operation-for-Two-Strings-LCS-空间复杂度优化/" itemprop="url">583. Delete Operation for Two Strings(LCS 空间复杂度优化)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-20T02:34:00+08:00">2020-01-20</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-20T02:34:58+08:00">2020-01-20</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="583-delete-operation-for-two-strings"><a class="header-anchor" href="#583-delete-operation-for-two-strings">¶</a><a href="https://leetcode.com/problems/delete-operation-for-two-strings/" target="_blank" rel="noopener">583. Delete Operation for Two Strings</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given two words <em>word1</em> and <em>word2</em>, find the minimum number of steps required to make <em>word1</em> and <em>word2</em> the same, where in each step you can delete one character in either string.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;sea&quot;, &quot;eat&quot;</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: You need one step to make &quot;sea&quot; to &quot;ea&quot; and another step to make &quot;eat&quot; to &quot;ea&quot;.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The length of given words won’t exceed 500.</li>
<li>Characters in given words can only be lower-case letters.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>Language: <strong>C++</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(<span class="built_in">string</span> word1, <span class="built_in">string</span> word2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> m = word1.size();</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> n = word2.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(n+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            dp[i] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> pre = dp[<span class="number">0</span>];</span><br><span class="line">            dp[<span class="number">0</span>] = i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123; </span><br><span class="line">                <span class="keyword">int</span> temp = dp[j];</span><br><span class="line">                <span class="keyword">if</span>(word1[i<span class="number">-1</span>] == word2[j<span class="number">-1</span>])</span><br><span class="line">                    dp[j] = pre;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[j] = min(dp[j], dp[j<span class="number">-1</span>]) + <span class="number">1</span>;</span><br><span class="line">                pre = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/20/460-LFU-Cache/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/20/460-LFU-Cache/" itemprop="url">460. LFU Cache</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-20T00:18:30+08:00">2020-01-20</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-20T01:48:42+08:00">2020-01-20</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="460-lfu-cache"><a class="header-anchor" href="#460-lfu-cache">¶</a><a href="https://leetcode.com/problems/lfu-cache/" target="_blank" rel="noopener">460. LFU Cache</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Design and implement a data structure for cache. It should support the following operations: <code>get</code> and <code>put</code>.</p>
<p><code>get(key)</code> - Get the value (will always be positive) of the key if the key exists in the cache, otherwise return -1.<br>
<code>put(key, value)</code> - Set or insert the value if the key is not already present. When the cache reaches its capacity, it should invalidate the least frequently used item before inserting a new item. For the purpose of this problem, when there is a tie (i.e., two or more keys that have the same frequency), the least <strong>recently</strong> used key would be evicted.</p>
<p>Note that the number of times an item is used is the number of calls to the <code>get</code> and <code>put</code> functions for that item since it was inserted. This number is set to zero when the item is removed.</p>
<p><strong>Follow up:</strong><br>
Could you do both operations in <strong>O(1)</strong> time complexity?</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LFUCache cache = new LFUCache( 2 /* capacity */ );</span><br><span class="line"></span><br><span class="line">cache.put(1, 1);</span><br><span class="line">cache.put(2, 2);</span><br><span class="line">cache.get(1);       // returns 1</span><br><span class="line">cache.put(3, 3);    // evicts key 2</span><br><span class="line">cache.get(2);       // returns -1 (not found)</span><br><span class="line">cache.get(3);       // returns 3.</span><br><span class="line">cache.put(4, 4);    // evicts key 1.</span><br><span class="line">cache.get(1);       // returns -1 (not found)</span><br><span class="line">cache.get(3);       // returns 3</span><br><span class="line">cache.get(4);       // returns 4</span><br></pre></td></tr></table></figure>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-unordered-map-list"><a class="header-anchor" href="#法一-unordered-map-list">¶</a>法一 unordered_map+list</h5>
<p>  相同频次的构成一个列表<code>list&lt;pair&lt;int, int&gt;&gt;</code>，这样的不同频次对应的列表再构成一个频次列表的列表<code>list&lt;pair&lt;int, list&lt;pair&lt;int, int&gt;&gt;&gt;&gt;</code>，key到频次列表和频次列表中的键值对的映射用<code>unordered_map&lt;int, pair&lt;t1, t2&gt;&gt; m_it</code>；</p>
<p>  第一次调试的时候，在<code>auto &amp;lt=it1-&gt;second;//这里一定要用引用，否则会拷贝整个list!!!!</code>这一句上摔了个大跟头，因为忘了加引用，导致每次都复制整个list，运行时间从110ms飙升到1400ms。并且不加引用的话，也无法真正删除原频次列表中的某个键值对，因为删除操作是在复制来的列表上进行的，没有影响原列表，虽然不会影响返回值的正确性（因为是根据key到迭代器的映射直接找到键值对），但是会增加空间复杂度。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LFUCache</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">using</span> t1=<span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&gt;&gt;::iterator;</span><br><span class="line">    <span class="keyword">using</span> t2=<span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;::iterator;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, pair&lt;t1, t2&gt;&gt; m_it;</span><br><span class="line">    <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&gt;&gt; l;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">    LFUCache(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        c=capacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it=m_it.find(key);</span><br><span class="line">        <span class="keyword">if</span>(it==m_it.end()||c==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">auto</span> it1=it-&gt;second.first;<span class="comment">//&#123;频率, 频率表&#125; </span></span><br><span class="line">        <span class="keyword">auto</span> it2=it-&gt;second.second;<span class="comment">//key在频率表中的位置</span></span><br><span class="line">        <span class="keyword">int</span> val=it2-&gt;second;</span><br><span class="line">        <span class="keyword">int</span> frq=it1-&gt;first;</span><br><span class="line">        <span class="keyword">auto</span> &amp;lt=it1-&gt;second;<span class="comment">//这里一定要用引用，否则会拷贝整个list!!!!</span></span><br><span class="line">        <span class="keyword">if</span>(next(it1)==l.end()||next(it1)-&gt;first!=frq+<span class="number">1</span>)&#123;</span><br><span class="line">            l.insert(next(it1), &#123;frq+<span class="number">1</span>, <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;()&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        next(it1)-&gt;second.push_front(&#123;key, val&#125;);</span><br><span class="line">        it-&gt;second=make_pair(next(it1), next(it1)-&gt;second.begin());</span><br><span class="line">        lt.erase(it2);</span><br><span class="line">        <span class="keyword">if</span>(lt.size()==<span class="number">0</span>) l.erase(it1);</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(c==<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">auto</span> it=m_it.find(key);</span><br><span class="line">        <span class="keyword">if</span>(it==m_it.end())&#123;</span><br><span class="line">            <span class="keyword">if</span>(m_it.size()==c)&#123;</span><br><span class="line">                <span class="keyword">auto</span> it1=l.begin();</span><br><span class="line">                <span class="keyword">auto</span> old=it1-&gt;second.back();</span><br><span class="line">                m_it.erase(old.first);</span><br><span class="line">                it1-&gt;second.pop_back();</span><br><span class="line">                <span class="keyword">if</span>(it1-&gt;second.size()==<span class="number">0</span>) l.erase(it1);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(l.size()==<span class="number">0</span>||l.begin()-&gt;first!=<span class="number">1</span>)&#123;</span><br><span class="line">                l.insert(l.begin(), &#123;<span class="number">1</span>, <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;()&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            l.begin()-&gt;second.push_front(&#123;key, value&#125;);</span><br><span class="line">            m_it[key]=make_pair(l.begin(), l.begin()-&gt;second.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">auto</span> it1=it-&gt;second.first;<span class="comment">//&#123;频率, 频率表&#125; </span></span><br><span class="line">            <span class="keyword">auto</span> it2=it-&gt;second.second;<span class="comment">//key在频率表中的位置</span></span><br><span class="line">            <span class="keyword">int</span> frq=it1-&gt;first;</span><br><span class="line">            <span class="keyword">auto</span> &amp;lt=it1-&gt;second;<span class="comment">//这里一定要用引用，否则会拷贝整个list!!!!</span></span><br><span class="line">            <span class="keyword">if</span>(next(it1)==l.end()||next(it1)-&gt;first!=frq+<span class="number">1</span>)&#123;</span><br><span class="line">                l.insert(next(it1), &#123;frq+<span class="number">1</span>, <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;()&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            next(it1)-&gt;second.push_front(&#123;key, value&#125;);</span><br><span class="line">            it-&gt;second=make_pair(next(it1), next(it1)-&gt;second.begin());</span><br><span class="line">            lt.erase(it2);</span><br><span class="line">            <span class="keyword">if</span>(lt.size()==<span class="number">0</span>) l.erase(it1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your LFUCache object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * LFUCache* obj = new LFUCache(capacity);</span></span><br><span class="line"><span class="comment"> * int param_1 = obj-&gt;get(key);</span></span><br><span class="line"><span class="comment"> * obj-&gt;put(key,value);</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h5 id="法二-双向链表-vector-unordered-map"><a class="header-anchor" href="#法二-双向链表-vector-unordered-map">¶</a>法二 双向链表+vector+unordered_map</h5>
<p>  链表维护同频次键值对，用vector&lt;NodeQueue*&gt;维护链表，用unordered_map&lt;int, Node*&gt; map;维护key到结点的映射。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LFUCache</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> key;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        <span class="keyword">int</span> count;</span><br><span class="line">        Node *next, *pre;</span><br><span class="line">        Node(<span class="keyword">int</span> k, <span class="keyword">int</span> v, Node *n): key(k),val(v),next(n) &#123;</span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">            pre = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">NodeQueue</span> &#123;</span></span><br><span class="line">        Node *head, *tail;</span><br><span class="line">        NodeQueue() &#123;</span><br><span class="line">            head = <span class="literal">NULL</span>;</span><br><span class="line">            tail = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        NodeQueue(Node *n) &#123;</span><br><span class="line">            head = n;</span><br><span class="line">            tail = n;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> cap=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, Node*&gt; <span class="built_in">map</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;NodeQueue*&gt; q;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">map</span>[key]-&gt;pre) <span class="built_in">map</span>[key]-&gt;pre-&gt;next = <span class="built_in">map</span>[key]-&gt;next;</span><br><span class="line">        <span class="keyword">else</span> q[<span class="built_in">map</span>[key]-&gt;count<span class="number">-1</span>]-&gt;head = <span class="built_in">map</span>[key]-&gt;next;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">map</span>[key]-&gt;next) <span class="built_in">map</span>[key]-&gt;next-&gt;pre = <span class="built_in">map</span>[key]-&gt;pre;</span><br><span class="line">        <span class="keyword">else</span> q[<span class="built_in">map</span>[key]-&gt;count<span class="number">-1</span>]-&gt;tail = <span class="built_in">map</span>[key]-&gt;pre;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (q.size() &lt;= <span class="built_in">map</span>[key]-&gt;count) &#123;</span><br><span class="line">            q.push_back(<span class="keyword">new</span> NodeQueue(<span class="built_in">map</span>[key]));</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;pre = <span class="literal">NULL</span>;</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;pre = <span class="literal">NULL</span>;</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;next = q[<span class="built_in">map</span>[key]-&gt;count]-&gt;head;</span><br><span class="line">            <span class="keyword">if</span> (q[<span class="built_in">map</span>[key]-&gt;count]-&gt;head)</span><br><span class="line">                q[<span class="built_in">map</span>[key]-&gt;count]-&gt;head-&gt;pre = <span class="built_in">map</span>[key];</span><br><span class="line">            <span class="keyword">else</span> q[<span class="built_in">map</span>[key]-&gt;count]-&gt;tail = <span class="built_in">map</span>[key];</span><br><span class="line">            q[<span class="built_in">map</span>[key]-&gt;count]-&gt;head = <span class="built_in">map</span>[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    LFUCache(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        cap = capacity;</span><br><span class="line">        <span class="built_in">map</span>.clear();</span><br><span class="line">        q.push_back(<span class="keyword">new</span> NodeQueue());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">map</span>.count(key))</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;count++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        update(key);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">map</span>[key]-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">map</span>.count(key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cap==<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">auto</span> nq: q) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (nq-&gt;tail) &#123;</span><br><span class="line">                        <span class="built_in">map</span>.erase(nq-&gt;tail-&gt;key);</span><br><span class="line">                        <span class="keyword">if</span> (nq-&gt;tail-&gt;pre) &#123;</span><br><span class="line">                            nq-&gt;tail = nq-&gt;tail-&gt;pre;</span><br><span class="line">                            nq-&gt;tail-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            nq-&gt;tail = <span class="literal">NULL</span>;</span><br><span class="line">                            nq-&gt;head = <span class="literal">NULL</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        flag = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (flag) cap++; </span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">map</span>[key] = <span class="keyword">new</span> Node(key, value, q[<span class="number">0</span>]-&gt;head);</span><br><span class="line">            <span class="keyword">if</span> (!q[<span class="number">0</span>]-&gt;tail)</span><br><span class="line">                q[<span class="number">0</span>]-&gt;tail = <span class="built_in">map</span>[key];</span><br><span class="line">            <span class="keyword">else</span> q[<span class="number">0</span>]-&gt;head-&gt;pre = <span class="built_in">map</span>[key];</span><br><span class="line">            q[<span class="number">0</span>]-&gt;head = <span class="built_in">map</span>[key];</span><br><span class="line">            cap--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;val = value;</span><br><span class="line">            <span class="built_in">map</span>[key]-&gt;count++;</span><br><span class="line">            update(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-双向循环链表-vector-unordered-map"><a class="header-anchor" href="#法三-双向循环链表-vector-unordered-map">¶</a>法三 双向循环链表+vector+unordered_map</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LFUCache</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    LFUCache(<span class="keyword">int</span> capacity): cap(capacity), sz(<span class="number">0</span>)&#123;&#125;</span><br><span class="line">    ~LFUCache()&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> p : lists)</span><br><span class="line">            <span class="keyword">delete</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nodemap.find(key) == nodemap.end())</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            DoubleLinkedList::ListNode* node = nodemap[key];</span><br><span class="line">            lists[node-&gt;freq]-&gt;del(node);</span><br><span class="line">            node-&gt;freq++;</span><br><span class="line">            insert(node);</span><br><span class="line">            <span class="keyword">return</span> node-&gt;val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cap == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        DoubleLinkedList::ListNode* node;</span><br><span class="line">        <span class="keyword">if</span>(nodemap.find(key) != nodemap.end())&#123;</span><br><span class="line">            node = nodemap[key];</span><br><span class="line">            lists[node-&gt;freq]-&gt;del(node);</span><br><span class="line">            node-&gt;val = value;</span><br><span class="line">            node-&gt;freq++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cap == sz)&#123;</span><br><span class="line">                <span class="keyword">int</span> minfreq = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span>(lists[minfreq]-&gt;empty())</span><br><span class="line">                    minfreq++;</span><br><span class="line">                node = lists[minfreq]-&gt;last();</span><br><span class="line">                lists[minfreq]-&gt;dellast();</span><br><span class="line">                nodemap.erase(node-&gt;key);</span><br><span class="line">                node-&gt;key = key;</span><br><span class="line">                node-&gt;val = value;</span><br><span class="line">                node-&gt;freq = <span class="number">0</span>;</span><br><span class="line">                nodemap[key] = node;   </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                node = <span class="keyword">new</span> DoubleLinkedList::ListNode(key,value);</span><br><span class="line">                nodemap[key] = node;</span><br><span class="line">                sz++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        insert(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DoubleLinkedList</span>&#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">        <span class="keyword">public</span>:</span><br><span class="line">            <span class="keyword">int</span> key;</span><br><span class="line">            <span class="keyword">int</span> val;</span><br><span class="line">            <span class="keyword">int</span> freq;</span><br><span class="line">            ListNode* next;</span><br><span class="line">            ListNode* prev;</span><br><span class="line">            ListNode(<span class="keyword">int</span> k, <span class="keyword">int</span> v) : key(k), val(v), freq(<span class="number">0</span>), next(<span class="literal">nullptr</span>), prev(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">            ListNode(<span class="keyword">int</span> k, <span class="keyword">int</span> v, ListNode *next_, ListNode *prev_) :</span><br><span class="line">                    key(k), val(v), freq(<span class="number">0</span>), next(next_), prev(prev_) &#123;&#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        DoubleLinkedList()&#123;</span><br><span class="line">            dumhead = <span class="keyword">new</span> ListNode(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            dumhead-&gt;next = dumhead;</span><br><span class="line">            dumhead-&gt;prev = dumhead;</span><br><span class="line">        &#125;</span><br><span class="line">        ~DoubleLinkedList()&#123;</span><br><span class="line">            ListNode* tmp1 = dumhead-&gt;next;</span><br><span class="line">            ListNode* tmp2;</span><br><span class="line">            <span class="keyword">while</span>(tmp1 != dumhead)&#123;</span><br><span class="line">                tmp2 = tmp1-&gt;next;</span><br><span class="line">                <span class="keyword">delete</span> tmp1;</span><br><span class="line">                tmp1 = tmp2;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">delete</span> dumhead;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(ListNode* node)</span></span>&#123;</span><br><span class="line">            node-&gt;next-&gt;prev = node-&gt;prev;</span><br><span class="line">            node-&gt;prev-&gt;next = node-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">dellast</span><span class="params">()</span></span>&#123; del(dumhead-&gt;prev); &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">addfirst</span><span class="params">(ListNode* node)</span></span>&#123;</span><br><span class="line">            node-&gt;next = dumhead-&gt;next;</span><br><span class="line">            node-&gt;next-&gt;prev = node;</span><br><span class="line">            dumhead-&gt;next = node;</span><br><span class="line">            node-&gt;prev = dumhead;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> dumhead-&gt;next == dumhead; &#125;</span><br><span class="line">        <span class="function">ListNode* <span class="title">last</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> dumhead-&gt;prev; &#125;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        ListNode* dumhead;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(DoubleLinkedList::ListNode* node)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lists.size() &lt; node-&gt;freq + <span class="number">1</span>)</span><br><span class="line">            lists.push_back(<span class="keyword">new</span> DoubleLinkedList());</span><br><span class="line">        lists[node-&gt;freq]-&gt;addfirst(node);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">vector</span>&lt;DoubleLinkedList*&gt; lists;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, DoubleLinkedList::ListNode*&gt; nodemap;</span><br><span class="line">    <span class="keyword">int</span> sz;</span><br><span class="line">    <span class="keyword">int</span> cap;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法四"><a class="header-anchor" href="#法四">¶</a>法四</h5>
<p>  法四精髓在于如何维护最小的频率。</p>
<ol>
<li>调用get时，如果刚好最小频次f的那个列表因为删掉一个元素而变成空，那么最小频次一定是f+1，因为删掉的结点一定会放到f+1对应的列表中，如果调用get删掉的不是最小频次列表中的元素，那么最小频次不变。</li>
<li>调用put时，如果添加一个新key，则无论如何最小频次都是1，因为新key的频次是1；如果不是新key，则又回到1中的情况。</li>
</ol>
<p>  综上最小频次要么加1（某个元素频次加1的时候），要么直接设为1（添加新key）；</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LFUCache</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">int</span> minFreq;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt;&gt;frequency_map;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, pair&lt;<span class="keyword">int</span>, pair&lt;<span class="keyword">int</span>, <span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt;::iterator&gt;&gt;&gt; p_map;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">increaseFreqCount</span><span class="params">(<span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count;</span><br><span class="line">        <span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line">        p_map[key].second.first++;</span><br><span class="line">        </span><br><span class="line">        count = p_map[key].second.first;</span><br><span class="line">        it = p_map[key].second.second;</span><br><span class="line">        </span><br><span class="line">        frequency_map[count<span class="number">-1</span>].erase(it);</span><br><span class="line">        <span class="keyword">if</span> (frequency_map[count<span class="number">-1</span>].size() == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            frequency_map.erase(count<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">if</span> (count<span class="number">-1</span> == minFreq)</span><br><span class="line">                minFreq = count;</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">        frequency_map[count].push_back(key);</span><br><span class="line">        p_map[key].second.second = --(frequency_map[count].end());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    LFUCache(<span class="keyword">int</span> capacity) </span><br><span class="line">    &#123;</span><br><span class="line">        n = capacity;</span><br><span class="line">        frequency_map.erase(frequency_map.begin(), frequency_map.end());</span><br><span class="line">        p_map.erase(p_map.begin(), p_map.end());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans;</span><br><span class="line">        <span class="keyword">int</span> count;</span><br><span class="line">        <span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (n ==<span class="number">0</span> || (p_map.find(key) == p_map.end()))</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        </span><br><span class="line">        ans = p_map[key].first;</span><br><span class="line">        increaseFreqCount(key);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> size = p_map.size();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (p_map.find(key) == p_map.end())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p_map.size() == n)</span><br><span class="line">            &#123;</span><br><span class="line">                p_map.erase(frequency_map[minFreq].front());</span><br><span class="line">                frequency_map[minFreq].pop_front();</span><br><span class="line">            &#125;</span><br><span class="line">            frequency_map[<span class="number">1</span>].push_back(key);</span><br><span class="line">            p_map[key] = &#123;value, &#123;<span class="number">1</span>, --(frequency_map[<span class="number">1</span>].end())&#125;&#125;;</span><br><span class="line">            minFreq = <span class="number">1</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            p_map[key].first = value;</span><br><span class="line">            increaseFreqCount(key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h2>
<p>  LFU的get、put函数的逻辑结构:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it = mp_.find(key);</span><br><span class="line">        <span class="keyword">if</span> (it == mp_.end()) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        mp_[key] = promote(key);  <span class="comment">// freq++, age -&gt; most recently, update position</span></span><br><span class="line">        <span class="comment">//增加当前key的频次</span></span><br><span class="line">        <span class="keyword">return</span> mp_[key].second-&gt;second;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (capacity_ &lt;= <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">auto</span> it = mp_.find(key);</span><br><span class="line">        <span class="keyword">if</span> (it != mp_.end()) mp_[key] = promote(key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (capacity_ == mp_.size()) evict();<span class="comment">//删除最小频次的元素</span></span><br><span class="line">            mp_[key] = insert_front(key, value);<span class="comment">//在频次1的列表前加一个kv对</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>  主要实现3个函数:</p>
<ol>
<li>删除一个(k,v,f)对</li>
<li>获取使用次数最小的least recently used结点(k,v,fmin)</li>
<li>添加一个(k,v,f)对</li>
</ol>
<p>  则上面代码里:</p>
<ol>
<li>promote相当于删除(k,v,f)，添加(k,v,f+1)</li>
<li>evice相当于获取(k,v,fmin)，删除(k,v,fmin)</li>
<li>insert_front()相当于添加(k,v,1)</li>
</ol>
<p>  LFU的数据结构设计的关键在于:</p>
<ol>
<li>key按频次分类，相同频次的在同一个列表中；</li>
<li>节点按顺序加入列表，这样最远不使用的节点就是列表的第一个节点，因此必须是顺序结构；</li>
</ol>
<p>  get和set实现O(1)时间复杂度的关键在于:</p>
<ol>
<li>能O(1)时间找到k所在的列表和其在该列表中的位置；</li>
<li>能根据列表位置和列表中key的位置O(1)时间删除某个列表或者某个列表中的key；</li>
<li>能O(1)时间获取最小频次；</li>
</ol>
<p>  为了实现O(1)时间找到k所在的列表和其在该列表中的位置需要一个key到其位置的hashmap；</p>
<p>  由于要求频次列表是顺序结构并且删除元素的复杂度是O(1)，所以需要用双向链表来存放相同频次的key；</p>
<p>  为了O(1)时间找最小频次，可以像法四一样动态更新minFreq(这样就不用按顺序存放频次list，可以直接维护频次到频次list的映射），也可以像法一一样按顺序组织频次列表，然后删除空的频次列表，这样第一个频次列表对应的频次就是最小的频次（这样需要两个<code>list&lt;list&gt;</code>的嵌套，内层是频次列表，外层是按频次大小顺序排列的频次列表的列表）。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/19/853-Car-Fleet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/19/853-Car-Fleet/" itemprop="url">853. Car Fleet</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-19T17:56:00+08:00">2020-01-19</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-19T18:01:02+08:00">2020-01-19</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="853-car-fleet"><a class="header-anchor" href="#853-car-fleet">¶</a><a href="https://leetcode.com/problems/car-fleet/" target="_blank" rel="noopener">853. Car Fleet</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p><code>N</code> cars are going to the same destination along a one lane road.  The destination is <code>target</code> miles away.</p>
<p>Each car <code>i</code> has a constant speed <code>speed[i]</code> (in miles per hour), and initial position <code>position[i]</code> miles towards the target along the road.</p>
<p>A car can never pass another car ahead of it, but it can catch up to it, and drive bumper to bumper at the same speed.</p>
<p>The distance between these two cars is ignored - they are assumed to have the same position.</p>
<p>A <em>car fleet</em> is some non-empty set of cars driving at the same position and same speed.  Note that a single car is also a car fleet.</p>
<p>If a car catches up to a car fleet right at the destination point, it will still be considered as one car fleet.</p>
<p>How many car fleets will arrive at the destination?</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input: target = 12, position = [10,8,0,5,3], speed = [2,4,1,1,3]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation:</span><br><span class="line">The cars starting at 10 and 8 become a fleet, meeting each other at 12.</span><br><span class="line">The car starting at 0 doesn&apos;t catch up to any other car, so it is a fleet by itself.</span><br><span class="line">The cars starting at 5 and 3 become a fleet, meeting each other at 6.</span><br><span class="line">Note that no other cars meet these fleets before the destination, so the answer is 3.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>0 &lt;= N &lt;= 10 ^ 4</code></li>
<li><code>0 &lt; target &lt;= 10 ^ 6</code></li>
<li><code>0 &lt; speed[i] &lt;= 10 ^ 6</code></li>
<li><code>0 &lt;= position[i] &lt; target</code></li>
<li>All initial positions are different.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  由于后面的车追上前面的车之后会减速（即后面的车会把前面的车挡住），所以要从离终点最近的车开始往前遍历，看看之前的车能不能追上，如果能就可以合并到一支车队中；如果前一辆车不能追上当前车，则说明前面所有的车都不可能追上该车（因为这辆车会把前面的车挡住），所以要新开一支车队。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">carFleet</span><span class="params">(<span class="keyword">int</span> target, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; position, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; speed)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N=position.size(), ans=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(N==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi(N);</span><br><span class="line">        iota(vi.begin(), vi.end(), <span class="number">0</span>);</span><br><span class="line">        sort(vi.begin(), vi.end(), [&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> j)&#123; <span class="keyword">return</span> position[i] &gt; position[j]; &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> cur=vi[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">static_cast</span>&lt;<span class="keyword">int64_t</span>&gt;(target-position[cur])*speed[vi[i]] &lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">int64_t</span>&gt;(target-position[vi[i]])*speed[cur])&#123;</span><br><span class="line">                ++ans;</span><br><span class="line">                cur=vi[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//0 3 5 8 10</span></span><br><span class="line">    <span class="comment">//1 3 1 4 2</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/19/1003-Check-If-Word-Is-Valid-After-Substitutions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/19/1003-Check-If-Word-Is-Valid-After-Substitutions/" itemprop="url">1003. Check If Word Is Valid After Substitutions</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-19T00:22:00+08:00">2020-01-19</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-19T17:56:35+08:00">2020-01-19</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1003-check-if-word-is-valid-after-substitutions"><a class="header-anchor" href="#1003-check-if-word-is-valid-after-substitutions">¶</a><a href="https://leetcode.com/problems/check-if-word-is-valid-after-substitutions/" target="_blank" rel="noopener">1003. Check If Word Is Valid After Substitutions</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>We are given that the string <code>&quot;abc&quot;</code> is valid.</p>
<p>From any valid string <code>V</code>, we may split <code>V</code> into two pieces <code>X</code> and <code>Y</code> such that <code>X + Y</code> (<code>X</code> concatenated with <code>Y</code>) is equal to <code>V</code>.  (<code>X</code> or <code>Y</code> may be empty.)  Then, <code>X + &quot;abc&quot; + Y</code> is also valid.</p>
<p>If for example <code>S = &quot;abc&quot;</code>, then examples of valid strings are: <code>&quot;abc&quot;, &quot;aabcbc&quot;, &quot;abcabc&quot;, &quot;abcabcababcc&quot;</code>.  Examples of <strong>invalid</strong> strings are: <code>&quot;abccba&quot;</code>, <code>&quot;ab&quot;</code>, <code>&quot;cababc&quot;</code>, <code>&quot;bac&quot;</code>.</p>
<p>Return <code>true</code> if and only if the given string <code>S</code> is valid.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;aabcbc&quot;</span><br><span class="line">Output: true</span><br><span class="line">Explanation: </span><br><span class="line">We start with the valid string &quot;abc&quot;.</span><br><span class="line">Then we can insert another &quot;abc&quot; between &quot;a&quot; and &quot;bc&quot;, resulting in &quot;a&quot; + &quot;abc&quot; + &quot;bc&quot; which is &quot;aabcbc&quot;.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;abcabcababcc&quot;</span><br><span class="line">Output: true</span><br><span class="line">Explanation: </span><br><span class="line">&quot;abcabcabc&quot; is valid after consecutive insertings of &quot;abc&quot;.</span><br><span class="line">Then we can insert &quot;abc&quot; before the last letter, resulting in &quot;abcabcab&quot; + &quot;abc&quot; + &quot;c&quot; which is &quot;abcabcababcc&quot;.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;abccba&quot;</span><br><span class="line">Output: false</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;cababc&quot;</span><br><span class="line">Output: false</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= S.length &lt;= 20000</code></li>
<li><code>S[i]</code> is <code>'a'</code>, <code>'b'</code>, or <code>'c'</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>Language: <strong>C++</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValid</span><span class="params">(<span class="built_in">string</span> S)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(index&lt;S.size())&#123;</span><br><span class="line">            <span class="keyword">if</span>(S[index]==<span class="string">'c'</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(top&gt;=<span class="number">1</span> &amp;&amp; S[top<span class="number">-1</span>]==<span class="string">'a'</span> &amp;&amp; S[top]==<span class="string">'b'</span>)&#123;</span><br><span class="line">                    top -= <span class="number">2</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                S[++top] = S[index];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> top==<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">441</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
