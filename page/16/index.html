<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/15/904-Fruit-Into-Baskets/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/15/904-Fruit-Into-Baskets/" itemprop="url">904. Fruit Into Baskets</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-15T23:08:19+08:00">2020-01-15</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-15T23:15:07+08:00">2020-01-15</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="904-fruit-into-baskets"><a class="header-anchor" href="#904-fruit-into-baskets">¶</a><a href="https://leetcode.com/problems/fruit-into-baskets/" target="_blank" rel="noopener">904. Fruit Into Baskets</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>In a row of trees, the <code>i</code>-th tree produces fruit with type <code>tree[i]</code>.</p>
<p>You <strong>start at any tree of your choice</strong>, then repeatedly perform the following steps:</p>
<ol>
<li>Add one piece of fruit from this tree to your baskets.  If you cannot, stop.</li>
<li>Move to the next tree to the right of the current tree.  If there is no tree to the right, stop.</li>
</ol>
<p>Note that you do not have any choice after the initial choice of starting tree: you must perform step 1, then step 2, then back to step 1, then step 2, and so on until you stop.</p>
<p>You have two baskets, and each basket can carry any quantity of fruit, but you want each basket to only carry one type of fruit each.</p>
<p>What is the total amount of fruit you can collect with this procedure?</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2,1]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: We can collect [1,2,1].</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [0,1,2,2]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: We can collect [1,2,2].</span><br><span class="line">If we started at the first tree, we would only collect [0, 1].</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2,3,2,2]</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: We can collect [2,3,2,2].</span><br><span class="line">If we started at the first tree, we would only collect [1, 2].</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [3,3,3,1,2,1,1,2,3,3,4]</span><br><span class="line">Output: 5</span><br><span class="line">Explanation: We can collect [1,2,1,1,2].</span><br><span class="line">If we started at the first tree or the eighth tree, we would only collect 4 fruits.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= tree.length &lt;= 40000</code></li>
<li><code>0 &lt;= tree[i] &lt; tree.length</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-滑动窗口"><a class="header-anchor" href="#法一-滑动窗口">¶</a>法一 滑动窗口</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">totalFruit</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; tree)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; m;</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>, n=tree.size();</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">            m[tree[i]]++;</span><br><span class="line">            <span class="keyword">while</span>(m.size()&gt;=<span class="number">3</span>)&#123;</span><br><span class="line">                <span class="keyword">auto</span> it=m.find(tree[j]);</span><br><span class="line">                <span class="keyword">if</span>(--it-&gt;second==<span class="number">0</span>) m.erase(it);</span><br><span class="line">                ++j;</span><br><span class="line">            &#125;</span><br><span class="line">            ans=max(i-j+<span class="number">1</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>不用unordered_map的版本:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">totalFruit</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; tree)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v (tree.size());</span><br><span class="line">        <span class="keyword">auto</span> maxSoFar = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">auto</span> current = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">auto</span> typesCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> front = <span class="number">0</span>, back = <span class="number">0</span>; front &lt; tree.size(); ++front) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v[tree[front]]++ == <span class="number">0</span>) &#123; ++typesCount; &#125;</span><br><span class="line">            ++current;</span><br><span class="line">            <span class="keyword">while</span> (<span class="number">2</span> &lt; typesCount) &#123;</span><br><span class="line">                --v[tree[back]];</span><br><span class="line">                <span class="keyword">if</span> (v[tree[back++]] == <span class="number">0</span>) &#123; --typesCount; &#125;</span><br><span class="line">                --current;</span><br><span class="line">            &#125;</span><br><span class="line">            maxSoFar = max(maxSoFar, current);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxSoFar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-按块扫描"><a class="header-anchor" href="#法二-按块扫描">¶</a>法二 按块扫描</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">totalFruit</span><span class="params">(<span class="keyword">int</span>[] tree)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// We'll make a list of indexes for which a block starts.</span></span><br><span class="line">        List&lt;Integer&gt; blockLefts = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add the left boundary of each block</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tree.length; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span> || tree[i-<span class="number">1</span>] != tree[i])</span><br><span class="line">                blockLefts.add(i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add tree.length as a sentinel for convenience</span></span><br><span class="line">        blockLefts.add(tree.length);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line">        search: <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// We'll start our scan at block[i].</span></span><br><span class="line">            <span class="comment">// types : the different values of tree[i] seen</span></span><br><span class="line">            <span class="comment">// weight : the total number of trees represented</span></span><br><span class="line">            <span class="comment">//          by blocks under consideration</span></span><br><span class="line">            Set&lt;Integer&gt; types = <span class="keyword">new</span> HashSet();</span><br><span class="line">            <span class="keyword">int</span> weight = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// For each block from the i-th and going forward,</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; blockLefts.size() - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">                <span class="comment">// Add each block to consideration</span></span><br><span class="line">                types.add(tree[blockLefts.get(j)]);</span><br><span class="line">                weight += blockLefts.get(j+<span class="number">1</span>) - blockLefts.get(j);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// If we have 3+ types, this is an illegal subarray</span></span><br><span class="line">                <span class="keyword">if</span> (types.size() &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">                    i = j - <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">continue</span> search;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// If it is a legal subarray, record the answer</span></span><br><span class="line">                ans = Math.max(ans, weight);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/14/481-Magical-String/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/14/481-Magical-String/" itemprop="url">481. Magical String</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-14T23:40:00+08:00">2020-01-14</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-14T23:42:42+08:00">2020-01-14</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="481-magical-string"><a class="header-anchor" href="#481-magical-string">¶</a><a href="https://leetcode.com/problems/magical-string/" target="_blank" rel="noopener">481. Magical String</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>A magical string <strong>S</strong> consists of only ‘1’ and ‘2’ and obeys the following rules:</p>
<p>The string <strong>S</strong> is magical because concatenating the number of contiguous occurrences of characters ‘1’ and ‘2’ generates the string <strong>S</strong> itself.</p>
<p>The first few elements of string <strong>S</strong> is the following: <strong>S</strong> = “1221121221221121122……”</p>
<p>If we group the consecutive '1’s and '2’s in <strong>S</strong>, it will be:</p>
<p>1 22 11 2 1 22 1 22 11 2 11 22 …</p>
<p>and the occurrences of '1’s or '2’s in each group are:</p>
<p>1 2 2 1 1 2 1 2 2 1 2 2 …</p>
<p>You can see that the occurrence sequence above is the <strong>S</strong> itself.</p>
<p>Given an integer N as input, return the number of '1’s in the first N number in the magical string <strong>S</strong>.</p>
<p><strong>Note:</strong> N will not exceed 100,000.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: 6</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: The first 6 elements of magical string S is &quot;12211&quot; and it contains three 1&apos;s, so return 3.</span><br></pre></td></tr></table></figure>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一"><a class="header-anchor" href="#法一">¶</a>法一</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">magicalString</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">3</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">2</span>, add=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">string</span> base=<span class="string">"122"</span>;</span><br><span class="line">        <span class="keyword">while</span>(base.size()&lt;n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt=base[i]-<span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)</span><br><span class="line">                base+=add+<span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">if</span>(add==<span class="number">1</span>)</span><br><span class="line">                add=<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                add=<span class="number">1</span>;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  count(base.begin(),base.begin()+n,<span class="string">'1'</span>);;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">特判 n == 0 和 n &lt;= 3 的情况，分别返回 0 和 1。</span></span><br><span class="line"><span class="comment">将前三个字符 122 加入数组中，每次按照数组前边给定的数量，添加一组新的字符，即和上一组字符相反。</span></span><br><span class="line"><span class="comment">例如，接下来按照第三个元素 ‘2’，需要加入两个字符，上次加入的是 ‘2’，那么这次新加入的字符应该是 ‘1’；此时数组为 12211，然后按照第四个元素 ‘1’，需要加入一个字符，上次加入的是 ‘1’，那么这次新加入的字符应该是 ‘2’。依次类推，直到长度达到 n。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h5 id="法二"><a class="header-anchor" href="#法二">¶</a>法二</h5>
<p>  最简洁的写法。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">magicalString</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> S = <span class="string">"122"</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span> (S.size() &lt; n)</span><br><span class="line">            S += <span class="built_in">string</span>(S[i++] - <span class="string">'0'</span>, S.back() ^ <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">return</span> count(S.begin(), S.begin() + n, <span class="string">'1'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/14/486-Predict-the-Winner/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/14/486-Predict-the-Winner/" itemprop="url">486. Predict the Winner</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-14T22:31:22+08:00">2020-01-14</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-14T23:07:55+08:00">2020-01-14</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="486-predict-the-winner"><a class="header-anchor" href="#486-predict-the-winner">¶</a><a href="https://leetcode.com/problems/predict-the-winner/" target="_blank" rel="noopener">486. Predict the Winner</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given an array of scores that are non-negative integers. Player 1 picks one of the numbers from either end of the array followed by the player 2 and then player 1 and so on. Each time a player picks a number, that number will not be available for the next player. This continues until all the scores have been chosen. The player with the maximum score wins.</p>
<p>Given an array of scores, predict whether player 1 is the winner. You can assume each player plays to maximize his score.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1, 5, 2]</span><br><span class="line">Output: False</span><br><span class="line">Explanation: Initially, player 1 can choose between 1 and 2\. If he chooses 2 (or 1), then player 2 can choose from 1 (or 2) and 5\. If player 2 chooses 5, then player 1 will be left with 1 (or 2). So, final score of player 1 is 1 + 2 = 3, and player 2 is 5\. Hence, player 1 will never be the winner and you need to return False.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1, 5, 233, 7]</span><br><span class="line">Output: True</span><br><span class="line">Explanation: Player 1 first chooses 1\. Then player 2 have to choose between 5 and 7\. No matter which number player 2 choose, player 1 can choose 233.Finally, player 1 has more score (234) than player 2 (12), so you need to return True representing player1 can win.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>1 &lt;= length of the array &lt;= 20.</li>
<li>Any scores in the given array are non-negative integers and will not exceed 10,000,000.</li>
<li>If the scores of both players are equal, then player 1 is still the winner.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-记忆化搜索"><a class="header-anchor" href="#法一-记忆化搜索">¶</a>法一 记忆化搜索</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; memo;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">winner</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;nums, <span class="keyword">int</span> s, <span class="keyword">int</span> e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s==e) <span class="keyword">return</span> nums[s];</span><br><span class="line">        <span class="keyword">auto</span> it=memo.find(s*nums.size()+e);</span><br><span class="line">        <span class="keyword">if</span>(it!=memo.end()) <span class="keyword">return</span> it-&gt;second;</span><br><span class="line">        <span class="keyword">int</span> a=nums[s]-winner(nums, s+<span class="number">1</span>, e);</span><br><span class="line">        <span class="keyword">int</span> b=nums[e]-winner(nums, s, e<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> memo[nums.size()*s+e]=max(a, b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">PredictTheWinner</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> winner(nums, <span class="number">0</span>, nums.size()<span class="number">-1</span>) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-dp"><a class="header-anchor" href="#法二-dp">¶</a>法二 dp</h5>
<p>  <code>dp[i][j]</code>代表当前玩家能从<code>[i,j]</code>区间获得的最大值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">PredictTheWinner</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.size();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(len,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(len));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[i][i] = nums[i];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len; j++)</span><br><span class="line">                dp[i][j] = max(nums[i] - dp[i + <span class="number">1</span>][j], nums[j] - dp[i][j - <span class="number">1</span>]);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][len - <span class="number">1</span>] &gt;= <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>空间优化</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">PredictTheWinner</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.size();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(len);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[i] = nums[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; len; j++)</span><br><span class="line">                dp[j] = max(nums[i] - dp[j], nums[j] - dp[j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[len - <span class="number">1</span>] &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h3>
<p>  像这种得分题，可以把己方得分算作正，对方得分算作负，然后所有运算都可以转化为加法运算，最后的结果的正负即代表胜负。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/14/692-Top-K-Frequent-Words/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/14/692-Top-K-Frequent-Words/" itemprop="url">692. Top K Frequent Words</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-14T16:03:00+08:00">2020-01-14</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-14T16:05:18+08:00">2020-01-14</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="692-top-k-frequent-words"><a class="header-anchor" href="#692-top-k-frequent-words">¶</a><a href="https://leetcode.com/problems/top-k-frequent-words/" target="_blank" rel="noopener">692. Top K Frequent Words</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given a non-empty list of words, return the <em>k</em> most frequent elements.</p>
<p>Your answer should be sorted by frequency from highest to lowest. If two words have the same frequency, then the word with the lower alphabetical order comes first.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [&quot;i&quot;, &quot;love&quot;, &quot;leetcode&quot;, &quot;i&quot;, &quot;love&quot;, &quot;coding&quot;], k = 2</span><br><span class="line">Output: [&quot;i&quot;, &quot;love&quot;]</span><br><span class="line">Explanation: &quot;i&quot; and &quot;love&quot; are the two most frequent words.</span><br><span class="line">    Note that &quot;i&quot; comes before &quot;love&quot; due to a lower alphabetical order.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: [&quot;the&quot;, &quot;day&quot;, &quot;is&quot;, &quot;sunny&quot;, &quot;the&quot;, &quot;the&quot;, &quot;the&quot;, &quot;sunny&quot;, &quot;is&quot;, &quot;is&quot;], k = 4</span><br><span class="line">Output: [&quot;the&quot;, &quot;is&quot;, &quot;sunny&quot;, &quot;day&quot;]</span><br><span class="line">Explanation: &quot;the&quot;, &quot;is&quot;, &quot;sunny&quot; and &quot;day&quot; are the four most frequent words,</span><br><span class="line">    with the number of occurrence being 4, 3, 2 and 1 respectively.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>You may assume <em>k</em> is always valid, 1 ≤ <em>k</em> ≤ number of unique elements.</li>
<li>Input words contain only lowercase letters.</li>
</ol>
<p><strong>Follow up:</strong></p>
<ol>
<li>Try to solve it in <em>O</em>(<em>n</em> log <em>k</em>) time and <em>O</em>(<em>n</em>) extra space.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-multiset"><a class="header-anchor" href="#法一-multiset">¶</a>法一 multiset</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyCompare</span> &#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt; arg_type;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span> <span class="params">()</span> <span class="params">(<span class="keyword">const</span> arg_type &amp;a1, <span class="keyword">const</span> arg_type &amp;a2)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (a1.first &gt; a2.first) || (a1.first == a2.first &amp;&amp; a1.second &lt; a2.second);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; topKFrequent(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; c;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;word : words) &#123;</span><br><span class="line">            c[word]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">multiset</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt;, MyCompare&gt; rc;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;[word, freq] : c) &#123;</span><br><span class="line">            rc.insert(make_pair(freq, word));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> it = rc.begin();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">            ans.emplace_back(it-&gt;second);</span><br><span class="line">            it++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-priority-queue"><a class="header-anchor" href="#法二-priority-queue">¶</a>法二 priority_queue</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; topKFrequent(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; um;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;w:words) um[w]++;</span><br><span class="line">        <span class="keyword">auto</span> cmp=[&amp;](<span class="keyword">const</span> <span class="built_in">string</span> &amp;p1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;p2)&#123;</span><br><span class="line">            <span class="keyword">return</span> um[p1]&gt;um[p2]||(um[p1]==um[p2]&amp;&amp;p1&lt;p2);</span><br><span class="line">        &#125;;</span><br><span class="line">        priority_queue&lt;<span class="built_in">string</span>, <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;, <span class="keyword">decltype</span>(cmp)&gt; q(cmp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;pr:um)&#123;</span><br><span class="line">            q.push(pr.first);</span><br><span class="line">            <span class="keyword">if</span>(q.size()&gt;k) q.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; ans(k);</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            ans[--k]=q.top();</span><br><span class="line">            q.pop();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/14/1130-Minimum-Cost-Tree-From-Leaf-Values/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/14/1130-Minimum-Cost-Tree-From-Leaf-Values/" itemprop="url">1130. Minimum Cost Tree From Leaf Values</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-14T11:17:00+08:00">2020-01-14</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-15T10:52:25+08:00">2020-01-15</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1130-minimum-cost-tree-from-leaf-values"><a class="header-anchor" href="#1130-minimum-cost-tree-from-leaf-values">¶</a><a href="https://leetcode.com/problems/minimum-cost-tree-from-leaf-values/" target="_blank" rel="noopener">1130. Minimum Cost Tree From Leaf Values</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given an array <code>arr</code> of positive integers, consider all binary trees such that:</p>
<ul>
<li>Each node has either 0 or 2 children;</li>
<li>The values of <code>arr</code> correspond to the values of each <strong>leaf</strong> in an in-order traversal of the tree.  <em>(Recall that a node is a leaf if and only if it has 0 children.)</em></li>
<li>The value of each non-leaf node is equal to the product of the largest leaf value in its left and right subtree respectively.</li>
</ul>
<p>Among all possible binary trees considered, return the smallest possible sum of the values of each non-leaf node.  It is guaranteed this sum fits into a 32-bit integer.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input: arr = [6,2,4]</span><br><span class="line">Output: 32</span><br><span class="line">Explanation:</span><br><span class="line">There are two possible trees.  The first has non-leaf node sum 36, and the second has non-leaf node sum 32.</span><br><span class="line"></span><br><span class="line">    24            24</span><br><span class="line">   /  \          /  \</span><br><span class="line">  12   4        6    8</span><br><span class="line"> /  \               / \</span><br><span class="line">6    2             2   4</span><br></pre></td></tr></table></figure>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>2 &lt;= arr.length &lt;= 40</code></li>
<li><code>1 &lt;= arr[i] &lt;= 15</code></li>
<li>It is guaranteed that the answer fits into a 32-bit signed integer (ie. it is less than <code>2^31</code>).</li>
</ul>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-区间dp"><a class="header-anchor" href="#法一-区间dp">¶</a>法一 区间dp</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">mctFromLeafValues</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; arr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=arr.size();</span><br><span class="line">        <span class="keyword">int</span> dp[n][n]&#123;&#125;, mx[n][n]&#123;&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) dp[i][i]=<span class="number">0</span>,mx[i][i]=arr[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n-i;++j)&#123;</span><br><span class="line">                mx[j][j+i]=max(mx[j][j+i<span class="number">-1</span>], mx[j+i][j+i]);</span><br><span class="line">                dp[j][j+i]=INT_MAX;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=j+<span class="number">1</span>;k&lt;=j+i;++k)&#123;</span><br><span class="line">                    dp[j][j+i]=min(dp[j][j+i], dp[j][k<span class="number">-1</span>]+dp[k][j+i]+mx[j][k<span class="number">-1</span>]*mx[k][j+i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-栈"><a class="header-anchor" href="#法二-栈">¶</a>法二 栈</h5>
<p><a href="https://leetcode.com/problems/minimum-cost-tree-from-leaf-values/discuss/339959/One-Pass-O(N)-Time-and-Space" target="_blank" rel="noopener">https://leetcode.com/problems/minimum-cost-tree-from-leaf-values/discuss/339959/One-Pass-O(N)-Time-and-Space</a></p>
<p>  把整个过程看成消除游戏，每次取相邻的两数的乘积，然后删掉其中较小的数，直到剩下一个数为止。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">mctFromLeafValues</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="built_in">stack</span> = &#123;INT_MAX&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> a : A) &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="built_in">stack</span>.back() &lt;= a) &#123;</span><br><span class="line">                <span class="keyword">int</span> mid = <span class="built_in">stack</span>.back();</span><br><span class="line">                <span class="built_in">stack</span>.pop_back();</span><br><span class="line">                res += mid * min(<span class="built_in">stack</span>.back(), a);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">stack</span>.push_back(a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="built_in">stack</span>.size(); ++i) &#123;</span><br><span class="line">            res += <span class="built_in">stack</span>[i] * <span class="built_in">stack</span>[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/13/480-Sliding-Window-Median/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/13/480-Sliding-Window-Median/" itemprop="url">480. Sliding Window Median</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-13T22:18:00+08:00">2020-01-13</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-13T22:58:26+08:00">2020-01-13</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="480-sliding-window-median"><a class="header-anchor" href="#480-sliding-window-median">¶</a><a href="https://leetcode.com/problems/sliding-window-median/" target="_blank" rel="noopener">480. Sliding Window Median</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Median is the middle value in an ordered integer list. If the size of the list is even, there is no middle value. So the median is the mean of the two middle value.</p>
<p>Examples:</p>
<p><code>[2,3,4]</code> , the median is <code>3</code></p>
<p><code>[2,3]</code>, the median is <code>(2 + 3) / 2 = 2.5</code></p>
<p>Given an array <em>nums</em>, there is a sliding window of size <em>k</em> which is moving from the very left of the array to the very right. You can only see the <em>k</em> numbers in the window. Each time the sliding window moves right by one position. Your job is to output the median array for each window in the original array.</p>
<p>For example,<br>
Given <em>nums</em> = <code>[1,3,-1,-3,5,3,6,7]</code>, and <em>k</em> = 3.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Window position                Median</span><br><span class="line">---------------               -----</span><br><span class="line">[1  3  -1] -3  5  3  6  7       1</span><br><span class="line"> 1 [3  -1  -3] 5  3  6  7       -1</span><br><span class="line"> 1  3 [-1  -3  5] 3  6  7       -1</span><br><span class="line"> 1  3  -1 [-3  5  3] 6  7       3</span><br><span class="line"> 1  3  -1  -3 [5  3  6] 7       5</span><br><span class="line"> 1  3  -1  -3  5 [3  6  7]      6</span><br></pre></td></tr></table></figure>
<p>Therefore, return the median sliding window as <code>[1,-1,-1,3,5,6]</code>.</p>
<p><strong>Note:</strong><br>
You may assume <code>k</code> is always valid, ie: <code>k</code> is always smaller than input array’s size for non-empty array.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  用multiset来维护窗口中元素的顺序，根据<code>if(nums[i] &gt;= *pt) pt++;if(nums[i-k] &gt;= *pt) pt--;</code>动态获取中间值的位置。</p>
<ul>
<li>有注释的版本</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. we only compute the median once,  in the rest, we adjust the mid iteration based the new added element</span></span><br><span class="line"><span class="comment">//    and to be deleted element in the array relationship; which is one of the key feature in this algorithm; </span></span><br><span class="line"><span class="comment">// 2. the second key point is how to remove the the window left element to avoid duplicate ones; </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; medianSlidingWindow(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; res;</span><br><span class="line">        <span class="comment">// sort the elements in the sliding window </span></span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">double</span>&gt; ms(nums.begin(), nums.begin() + k);</span><br><span class="line">        <span class="comment">// the mid exact or the upper bound of the mid range (two cased here)</span></span><br><span class="line">        <span class="keyword">auto</span> mid = next(ms.begin(), k/<span class="number">2</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = k; ; ++i) &#123;</span><br><span class="line">            <span class="comment">// for the previous window of size k, </span></span><br><span class="line">            <span class="comment">// if k is odd, it is the computed mid, </span></span><br><span class="line">            <span class="comment">// if k is even, it is (mid + pre_mid)/2.</span></span><br><span class="line">            <span class="comment">// the second parameter of pre/next is 1 by default. this push is for the preceeding window. </span></span><br><span class="line">            res.push_back((*mid + *prev(mid,  <span class="number">1</span> - k % <span class="number">2</span>)) / <span class="number">2.0</span>);  </span><br><span class="line">            </span><br><span class="line">            <span class="comment">// if reach the end of the given array.</span></span><br><span class="line">            <span class="keyword">if</span> (i == nums.size()) <span class="keyword">return</span> res;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// for the current element nums[i], </span></span><br><span class="line">            ms.insert(nums[i]);</span><br><span class="line">            <span class="comment">// for the new add element, adjust the mid element. </span></span><br><span class="line">            <span class="keyword">if</span> (nums[i] &lt; *mid) --mid;  </span><br><span class="line">            </span><br><span class="line">            <span class="comment">// rease the first element that &gt;= nums[i-k]; indee, here, it is equal to nums[i - k]</span></span><br><span class="line">            <span class="comment">// since there may be duplication, so, we use lower bound. </span></span><br><span class="line">            <span class="keyword">if</span> (nums[i - k] &lt;= *mid) ++mid;</span><br><span class="line">            ms.erase(ms.lower_bound(nums[i - k]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>无注释清爽版</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; medianSlidingWindow(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; med(len - k + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; window;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">            window.insert(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">bool</span> isOdd = k % <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">auto</span> pt = next(window.begin(), k/<span class="number">2</span>);</span><br><span class="line">        med[<span class="number">0</span>] = isOdd ? *pt : (*pt / <span class="number">2.0</span> + *next(pt, <span class="number">-1</span>) / <span class="number">2.0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = k; i &lt; len; i++)&#123;</span><br><span class="line">            window.insert(nums[i]);</span><br><span class="line">            <span class="keyword">if</span>(nums[i] &gt;= *pt) pt++;</span><br><span class="line">            <span class="keyword">if</span>(nums[i-k] &gt;= *pt) pt--; </span><br><span class="line">            window.erase(next(window.upper_bound(nums[i-k]), <span class="number">-1</span>));</span><br><span class="line">            med[i - k + <span class="number">1</span>] = isOdd ? *pt : (*pt / <span class="number">2.0</span> + *next(pt, <span class="number">-1</span>) / <span class="number">2.0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> med;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-大小堆"><a class="header-anchor" href="#法二-大小堆">¶</a>法二 大小堆</h5>
<p>  将窗口分为两半，分别用大顶堆和小顶堆维护，中位数可从窗口的边界值算出。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; medianSlidingWindow(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; s1;<span class="comment">//小顶堆,保存上半部</span></span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; s2;<span class="comment">//大顶堆，保存下半部</span></span><br><span class="line">        <span class="comment">//保证s1.size()+1==s2.size()或者s1.size()==s2.size()</span></span><br><span class="line">        <span class="keyword">int</span> n=nums.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=k)&#123;</span><br><span class="line">                <span class="keyword">auto</span> it1=s1.find(nums[i-k]), it2=s2.find(nums[i-k]);</span><br><span class="line">                <span class="keyword">if</span>(it1!=s1.end()) s1.erase(it1);</span><br><span class="line">                <span class="keyword">else</span> s2.erase(it2);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s2.empty()||nums[i]&lt;=*prev(s2.end())) s2.insert(nums[i]);</span><br><span class="line">            <span class="keyword">else</span> s1.insert(nums[i]);</span><br><span class="line">            <span class="keyword">while</span>(!s1.empty()&amp;&amp;s1.size()&gt;s2.size()) &#123;</span><br><span class="line">                <span class="keyword">auto</span> n1=*s1.begin();</span><br><span class="line">                s1.erase(s1.begin());</span><br><span class="line">                s2.insert(n1);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(!s2.empty()&amp;&amp;s1.size()&lt;s2.size()<span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="keyword">auto</span> n2=*prev(s2.end());</span><br><span class="line">                s2.erase(prev(s2.end()));</span><br><span class="line">                s1.insert(n2);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i&lt;k<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(s1.size()==s2.size()) ans.push_back((*s1.begin()+*(prev(s2.end())))/<span class="number">2.0</span>);</span><br><span class="line">            <span class="keyword">else</span> ans.push_back(<span class="keyword">double</span>(*(prev(s2.end()))));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>从leetcode讨论区看到了一种更简洁的写法如下:</p>
<ul>
<li>java版</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">double</span>[] medianSlidingWindow(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">       <span class="keyword">double</span>[] result = <span class="keyword">new</span> <span class="keyword">double</span>[nums.length - k + <span class="number">1</span>];</span><br><span class="line">       <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">       PriorityQueue&lt;Integer&gt; lo = <span class="keyword">new</span> PriorityQueue&lt;&gt;(Collections.reverseOrder());</span><br><span class="line">       PriorityQueue&lt;Integer&gt; hi = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            lo.add(nums[i]);</span><br><span class="line">            hi.add(lo.poll());</span><br><span class="line">            <span class="keyword">if</span>(hi.size()&gt;lo.size()) lo.add(hi.poll());</span><br><span class="line">            <span class="keyword">if</span> (lo.size() + hi.size() == k) &#123;</span><br><span class="line">                result[j]=lo.size()==hi.size()?(<span class="keyword">double</span>)((<span class="keyword">long</span>) lo.peek()+(<span class="keyword">long</span>)hi.peek())/<span class="number">2</span>:(<span class="keyword">double</span>) lo.peek();</span><br><span class="line">                <span class="keyword">if</span> (!lo.remove(nums[j])) hi.remove(nums[j]);</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>c++版</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; medianSlidingWindow(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k) &#123;</span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; s1;<span class="comment">//小顶堆,保存上半部</span></span><br><span class="line">        <span class="built_in">multiset</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; s2;<span class="comment">//大顶堆，保存下半部</span></span><br><span class="line">        <span class="comment">//保证s1.size()+1==s2.size()或者s1.size()==s2.size()</span></span><br><span class="line">        <span class="keyword">int</span> n=nums.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">            s2.insert(nums[i]);</span><br><span class="line">            s1.insert(*(prev(s2.end())));</span><br><span class="line">            s2.erase(prev(s2.end()));</span><br><span class="line">            <span class="comment">// if(i&gt;=k)&#123;</span></span><br><span class="line">            <span class="comment">//     auto it1=s1.find(nums[i-k]), it2=s2.find(nums[i-k]);</span></span><br><span class="line">            <span class="comment">//     if(it2!=s2.end()) s2.erase(it2);</span></span><br><span class="line">            <span class="comment">//     else s1.erase(it1);    </span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">            <span class="comment">// if(s2.size()&lt;s1.size()) &#123;</span></span><br><span class="line">            <span class="comment">//     auto n1=*s1.begin();</span></span><br><span class="line">            <span class="comment">//     s1.erase(s1.begin());</span></span><br><span class="line">            <span class="comment">//     s2.insert(n1);</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">            <span class="comment">// if(s1.size()+s2.size()==k)&#123;</span></span><br><span class="line">            <span class="comment">//     if(s1.size()==s2.size()) ans.push_back((*s1.begin()+*(prev(s2.end())))/2.0);</span></span><br><span class="line">            <span class="comment">//     else ans.push_back(double(*(prev(s2.end()))));</span></span><br><span class="line">            <span class="comment">// &#125; </span></span><br><span class="line">            <span class="keyword">if</span>(s2.size()&lt;s1.size()) &#123;</span><br><span class="line">                <span class="keyword">auto</span> n1=*s1.begin();</span><br><span class="line">                s1.erase(s1.begin());</span><br><span class="line">                s2.insert(n1);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s1.size()+s2.size()==k)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s1.size()==s2.size()) ans.push_back((*s1.begin()+*(prev(s2.end())))/<span class="number">2.0</span>);</span><br><span class="line">                <span class="keyword">else</span> ans.push_back(<span class="keyword">double</span>(*(prev(s2.end()))));</span><br><span class="line">                <span class="keyword">auto</span> it1=s1.find(nums[i-k+<span class="number">1</span>]), it2=s2.find(nums[i-k+<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">if</span>(it2!=s2.end()) s2.erase(it2);</span><br><span class="line">                <span class="keyword">else</span> s1.erase(it1);</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="关于中位数迭代器更新规则的解释"><a class="header-anchor" href="#关于中位数迭代器更新规则的解释">¶</a>关于中位数迭代器更新规则的解释</h6>
<p>the code to move the mid can also be written like:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Insert nums[i].</span></span><br><span class="line">window.insert(nums[i]);</span><br><span class="line"><span class="keyword">if</span> (nums[i] &gt; *mid)</span><br><span class="line">    mid++;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Erase nums[i-k].</span></span><br><span class="line"><span class="keyword">if</span> (nums[i - k] &gt;= *mid)</span><br><span class="line">    mid--;</span><br></pre></td></tr></table></figure>
<p>this is because there are only 4 cases after insertion and erasure. (use m for median, N for insertion, X for erasure, O for other elements)<br>
case 1. NXOmO<br>
case 2. OmONX<br>
case 3. NOmOX<br>
case 4. XOmON</p>
<p>in case 1&amp;2, insertion &amp; erasure will cancel out each other, so we have nothing to do.<br>
in case 3, mid needs to move left, i.e., m-- because X will erase one O in this case)<br>
in case 4, mid needs to move right, i.e., m++ for the same reason as case 3)</p>
<p>if N appears on left, it will be canceled out if X is on left, otherwise mid needs to move left.<br>
so in the original code</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.insert(nums[i]);</span><br><span class="line"><span class="keyword">if</span> (nums[i] &lt; *mid)</span><br><span class="line">    mid--;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Erase nums[i-k].</span></span><br><span class="line"><span class="keyword">if</span> (nums[i-k] &lt;= *mid)</span><br><span class="line">    mid++;</span><br></pre></td></tr></table></figure>
<p>does exactly this thing by move mid to left if N is on left, then checking if X is on left, it moves mid back to right.</p>
<p>this logic applies to the situation when k is even, considering the cases:<br>
case 1. NXOOmO<br>
case 2. OOmONX<br>
case 3. NOOmOX<br>
case 4. XOOmON</p>
<p>in case 3. after insertion on left NOOmO, move mid left leads to NOmOO<br>
if erasure happens on left =&gt; XNOOmO =&gt; OOmO (X cancels out N)<br>
if erasure happens on right =&gt; NOmOOX =&gt; OOmO (X cancels out O, N becomes O)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/13/C-hash表实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/13/C-hash表实现/" itemprop="url">C++hash表实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-13T21:22:00+08:00">2020-01-13</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-13T21:24:24+08:00">2020-01-13</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/模板/" itemprop="url" rel="index">
                    <span itemprop="name">模板</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>hash表实现</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">struct</span> <span class="title">Gethash</span>&#123;</span></span><br><span class="line">	<span class="keyword">size_t</span> <span class="keyword">operator</span> ()(<span class="keyword">const</span> T &amp;x)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">size_t</span> Gethash&lt;<span class="keyword">int</span>&gt;::<span class="keyword">operator</span> ()(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">size_t</span> Gethash&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;::<span class="keyword">operator</span> ()(<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> &amp;x)<span class="keyword">const</span>&#123;<span class="keyword">return</span> x;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">size_t</span> Gethash&lt;<span class="keyword">char</span>*&gt;::<span class="keyword">operator</span> ()(<span class="keyword">char</span> *<span class="keyword">const</span> &amp;_str)<span class="keyword">const</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">size_t</span> seed=<span class="number">131</span>;<span class="keyword">size_t</span> hash=<span class="number">0</span>;<span class="keyword">char</span> *str=_str;</span><br><span class="line">	<span class="keyword">while</span> (*str)hash=hash*seed+*str++;</span><br><span class="line">	<span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">size_t</span> Gethash&lt;<span class="built_in">string</span>&gt;::<span class="keyword">operator</span> ()(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s)<span class="keyword">const</span>&#123;</span><br><span class="line">	<span class="keyword">size_t</span> hash=<span class="number">5381</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">string</span>::const_iterator i=s.begin();i!=s.end();++i)hash+=(hash&lt;&lt;<span class="number">5</span>)+*i;</span><br><span class="line">	<span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">size_t</span> Gethash&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt;::<span class="keyword">operator</span> ()(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &amp;x)<span class="keyword">const</span>&#123;<span class="keyword">return</span> (x.first&lt;&lt;<span class="number">15</span>)+(x.first&gt;&gt;<span class="number">8</span>)+x.second;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">Tkey</span>,<span class="title">class</span> <span class="title">Tvalue</span>=<span class="title">bool</span>,<span class="title">class</span> _<span class="title">Hash</span>=<span class="title">Gethash</span>&lt;Tkey&gt; &gt;</span></span><br><span class="line"><span class="class"><span class="title">struct</span> <span class="title">Hash</span>&#123;</span></span><br><span class="line">	_Hash gethash;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">		Tkey first;Tvalue second;node *next;</span><br><span class="line">		node():next(<span class="number">0</span>)&#123;&#125;</span><br><span class="line">		node(<span class="keyword">const</span> Tkey &amp;x,<span class="keyword">const</span> Tvalue &amp;y,node *_next=<span class="number">0</span>):first(x),second(y),next(_next)&#123;&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	node **v,*key;<span class="keyword">size_t</span> len,P,max_size;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">iterator</span>&#123;</span></span><br><span class="line">		<span class="keyword">size_t</span> i;node *j;Hash&lt;Tkey,Tvalue,_Hash&gt; *H;</span><br><span class="line">		iterator()&#123;&#125;</span><br><span class="line">		iterator(<span class="keyword">size_t</span> _i,node *_j,Hash&lt;Tkey,Tvalue,_Hash&gt; *_H):i(_i),j(_j),H(_H)&#123;go();&#125;</span><br><span class="line">		<span class="function"><span class="keyword">void</span> <span class="title">go</span><span class="params">()</span></span>&#123;</span><br><span class="line">			<span class="keyword">if</span> (i&lt;H-&gt;P&amp;&amp;!j)&#123;</span><br><span class="line">				<span class="keyword">for</span> (++i;i&lt;H-&gt;P&amp;&amp;!H-&gt;v[i];++i);</span><br><span class="line">				<span class="keyword">if</span> (i==H-&gt;P)j=<span class="number">0</span>;<span class="keyword">else</span> j=H-&gt;v[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		node <span class="keyword">operator</span> *()&#123;<span class="keyword">return</span> *j;&#125;</span><br><span class="line">		iterator&amp; <span class="keyword">operator</span> ++()&#123;j=j-&gt;next;go();&#125;</span><br><span class="line">		iterator <span class="keyword">operator</span> ++(<span class="keyword">int</span>)&#123;iterator res=*<span class="keyword">this</span>;++*<span class="keyword">this</span>;<span class="keyword">return</span> res;&#125;</span><br><span class="line">		iterator&amp; <span class="keyword">operator</span> --()&#123;</span><br><span class="line">			<span class="keyword">if</span> (j==H-&gt;v[i])&#123;<span class="keyword">for</span> (--i;!H-&gt;v[i];--i);<span class="keyword">for</span> (j=H-&gt;v[i];j-&gt;next;j=j-&gt;next);&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;node *k=j;<span class="keyword">for</span> (j=H-&gt;v[i];j-&gt;next!=k;j=j-&gt;next);&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		iterator <span class="keyword">operator</span> --(<span class="keyword">int</span>)&#123;iterator res=*<span class="keyword">this</span>;--*<span class="keyword">this</span>;<span class="keyword">return</span> res;&#125;</span><br><span class="line">		node* <span class="keyword">operator</span> -&gt;()&#123;<span class="keyword">return</span> j;&#125;</span><br><span class="line">		<span class="keyword">inline</span> <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span> ==(<span class="keyword">const</span> iterator &amp;x,<span class="keyword">const</span> iterator &amp;y)&#123;<span class="keyword">return</span> x.i==y.i&amp;&amp;x.j==y.j;&#125;</span><br><span class="line">		<span class="keyword">inline</span> <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span> !=(<span class="keyword">const</span> iterator &amp;x,<span class="keyword">const</span> iterator &amp;y)&#123;<span class="keyword">return</span> x.i!=y.i||x.j!=y.j;&#125;</span><br><span class="line">		<span class="keyword">bool</span> <span class="keyword">operator</span> !()&#123;<span class="keyword">return</span> i==H-&gt;P;&#125;</span><br><span class="line">		<span class="function"><span class="keyword">operator</span> <span class="title">bool</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> i!=H-&gt;P;&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function">iterator <span class="title">begin</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> iterator(<span class="number">0</span>,v[<span class="number">0</span>],<span class="keyword">this</span>);&#125;</span><br><span class="line">	<span class="function">iterator <span class="title">end</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> iterator(P,<span class="number">0</span>,<span class="keyword">this</span>);&#125;</span><br><span class="line">	<span class="comment">//void operator =(const Hash &amp;y)&#123;&#125;</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Grow</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">double</span> rate=<span class="number">1.7</span>;Hash&lt;Tkey,Tvalue,_Hash&gt; res(max_size*<span class="number">2</span>,<span class="keyword">size_t</span>(rate*max_size*<span class="number">2</span>));</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>;i&lt;P;++i)</span><br><span class="line">			<span class="keyword">for</span> (node *j=v[i];j;j=j-&gt;next)res.insert(j-&gt;first,j-&gt;second);</span><br><span class="line">		<span class="built_in">free</span>();*<span class="keyword">this</span>=res;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">size_t</span> L,<span class="keyword">size_t</span> p)</span></span>&#123;</span><br><span class="line">		P=p;len=<span class="number">0</span>;max_size=L;++L;key=<span class="keyword">new</span> node[L];</span><br><span class="line">		v=<span class="keyword">new</span> node*[p];<span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span>(node*)*p);</span><br><span class="line">	&#125;</span><br><span class="line">	Hash(<span class="keyword">size_t</span> len=<span class="number">3</span>,<span class="keyword">size_t</span> p=<span class="number">5</span>)&#123;build(len,p);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;len=<span class="number">0</span>;<span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span>(node*)*P);&#125;</span><br><span class="line">	<span class="comment">//void clear()&#123;free();build(3,5);&#125;</span></span><br><span class="line">	<span class="function">Tvalue&amp; <span class="title">insert</span><span class="params">(<span class="keyword">const</span> Tkey &amp;x,<span class="keyword">const</span> Tvalue &amp;y=<span class="number">0</span>)</span></span>&#123;</span><br><span class="line">		<span class="comment">//if (&amp;find_(x))&#123;Tvalue *null=NULL;return *null;&#125;</span></span><br><span class="line">		<span class="keyword">if</span> (len==max_size)Grow();<span class="keyword">size_t</span> x1=gethash(x)%P;</span><br><span class="line">		key[++len]=node(x,y,v[x1]);v[x1]=key+len;</span><br><span class="line">		<span class="keyword">return</span> key[len].second;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">Tvalue&amp; <span class="title">insert</span><span class="params">(<span class="keyword">const</span> pair&lt;Tkey,Tvalue&gt; &amp;p)</span></span>&#123;<span class="keyword">return</span> insert(p.first,p.second);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(<span class="keyword">const</span> Tkey &amp;x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">size_t</span> x1=gethash(x)%P;</span><br><span class="line">		<span class="keyword">for</span> (node *i=v[x1],*pre=<span class="number">0</span>;i;pre=i,i=i-&gt;next)<span class="keyword">if</span> (i-&gt;first==x)&#123;</span><br><span class="line">			<span class="keyword">if</span> (!pre)v[x1]=i-&gt;next;<span class="keyword">else</span> pre-&gt;next=i-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(iterator x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (x.j==v[x.i])v[x.i]=x-&gt;next;</span><br><span class="line">		<span class="keyword">else</span> &#123;node *y=x-&gt;next;--x;x-&gt;next=y;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">Tvalue* <span class="title">find_</span><span class="params">(<span class="keyword">const</span> Tkey &amp;x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">size_t</span> x1=gethash(x)%P;</span><br><span class="line">		<span class="keyword">for</span> (node *i=v[x1];i;i=i-&gt;next)</span><br><span class="line">			<span class="keyword">if</span> (i-&gt;first==x)<span class="keyword">return</span> &amp;i-&gt;second;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> Tkey &amp;x,<span class="keyword">int</span> &amp;s)</span></span>&#123;</span><br><span class="line">		<span class="keyword">size_t</span> x1=gethash(x)%P;</span><br><span class="line">		<span class="keyword">for</span> (node *i=v[x1];i;i=i-&gt;next)</span><br><span class="line">			<span class="keyword">if</span> (i-&gt;first==x)&#123;s+=i-&gt;second; <span class="keyword">return</span>;&#125;</span><br><span class="line">		<span class="comment">//Tvalue *null=NULL;return *null;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">iterator <span class="title">find</span><span class="params">(<span class="keyword">const</span> Tkey &amp;x)</span></span>&#123;</span><br><span class="line">		<span class="keyword">size_t</span> x1=gethash(x)%P;</span><br><span class="line">		<span class="keyword">for</span> (node *i=v[x1];i;i=i-&gt;next)</span><br><span class="line">			<span class="keyword">if</span> (i-&gt;first==x)<span class="keyword">return</span> iterator(x1,i,<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">return</span> end();</span><br><span class="line">	&#125;</span><br><span class="line">	Tvalue&amp; <span class="keyword">operator</span> [](<span class="keyword">const</span> Tkey &amp;x)&#123;</span><br><span class="line">		Tvalue *res=find_(x);<span class="keyword">if</span> (res==<span class="number">0</span>)<span class="keyword">return</span> insert(x);<span class="keyword">return</span> *res;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> len==<span class="number">0</span>;&#125;</span><br><span class="line">	<span class="keyword">size_t</span> size()&#123;<span class="keyword">return</span> len;&#125;</span><br><span class="line">	<span class="keyword">size_t</span> count(<span class="keyword">const</span> Tkey &amp;x)&#123;<span class="keyword">return</span> find_(x)?<span class="number">1</span>:<span class="number">0</span>;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span>&#123;<span class="keyword">delete</span>[] key;<span class="keyword">delete</span>[] v;&#125;</span><br><span class="line">	~Hash()&#123;&#125;</span><br><span class="line">	<span class="comment">/*void print()&#123;</span></span><br><span class="line"><span class="comment">		for (size_t i=0;i&lt;P;++i)</span></span><br><span class="line"><span class="comment">			for (node *j=v[i];j;j=j-&gt;next)printf("H[%d]=%d\n",j-&gt;first,j-&gt;second);</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>运用</li>
</ul>
<p><a href="https://leetcode.com/problems/concatenated-words/" target="_blank" rel="noopener">https://leetcode.com/problems/concatenated-words/</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Gethash&lt;string&gt; h;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">unordered_set</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; str_set;</span><br><span class="line">str_set::hasher h = str_set().hash_function();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; results;</span><br><span class="line">    Hash&lt;<span class="keyword">int</span>&gt; dict;</span><br><span class="line">    <span class="keyword">int</span> min_len;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isConcatenated</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;word)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dict.count(h(word))) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i =  min_len; i &lt; word.size() - min_len + <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (dict.count(h(word.substr(<span class="number">0</span>, i))) &gt; <span class="number">0</span> &amp;&amp; isConcatenated(word.substr(i, word.size() - i)))<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; findAllConcatenatedWordsInADict(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words) &#123;</span><br><span class="line">		dict.clear();</span><br><span class="line">        sort(words.begin(), words.end(), [](<span class="keyword">const</span> <span class="built_in">string</span> &amp;lhs, <span class="keyword">const</span> <span class="built_in">string</span> &amp;rhs)&#123;<span class="keyword">return</span> lhs.size() &lt; rhs.size();&#125;);</span><br><span class="line">        min_len = max(<span class="number">1</span>, (<span class="keyword">int</span>)words.front().size());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.size(); dict.insert(h(words[i++])))</span><br><span class="line">            <span class="keyword">if</span> (words[i].size() &gt;= min_len * <span class="number">2</span> &amp;&amp; isConcatenated(words[i]))</span><br><span class="line">                results.push_back(words[i]);</span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/13/472-Concatenated-Words/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/13/472-Concatenated-Words/" itemprop="url">472. Concatenated Words</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-13T21:20:47+08:00">2020-01-13</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-13T21:39:49+08:00">2020-01-13</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="472-concatenated-words"><a class="header-anchor" href="#472-concatenated-words">¶</a><a href="https://leetcode.com/problems/concatenated-words/" target="_blank" rel="noopener">472. Concatenated Words</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Given a list of words (<strong>without duplicates</strong>), please write a program that returns all concatenated words in the given list of words.</p>
<p>A concatenated word is defined as a string that is comprised entirely of at least two shorter words in the given array.</p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: [&quot;cat&quot;,&quot;cats&quot;,&quot;catsdogcats&quot;,&quot;dog&quot;,&quot;dogcatsdog&quot;,&quot;hippopotamuses&quot;,&quot;rat&quot;,&quot;ratcatdogcat&quot;]</span><br><span class="line"></span><br><span class="line">Output: [&quot;catsdogcats&quot;,&quot;dogcatsdog&quot;,&quot;ratcatdogcat&quot;]</span><br><span class="line"></span><br><span class="line">Explanation: &quot;catsdogcats&quot; can be concatenated by &quot;cats&quot;, &quot;dog&quot; and &quot;cats&quot;;  &quot;dogcatsdog&quot; can be concatenated by &quot;dog&quot;, &quot;cats&quot; and &quot;dog&quot;; &quot;ratcatdogcat&quot; can be concatenated by &quot;rat&quot;, &quot;cat&quot;, &quot;dog&quot; and &quot;cat&quot;.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li>The number of elements of the given array will not exceed <code>10,000</code></li>
<li>The length sum of elements in the given array will not exceed <code>600,000</code>.</li>
<li>All the input string will only include lower case letters.</li>
<li>The returned elements order does not matter.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-字符串hash-dfs"><a class="header-anchor" href="#法一-字符串hash-dfs">¶</a>法一 字符串hash+dfs</h5>
<p>  要注意含有空字符串的情况，空字符串可以直接剔除，因为如果当前字符串s是由s1,s2构成(其中一个是&quot;&quot;)，即s=s1+s2。不妨设s1=&quot;&quot;，则当前s=s2，与<strong>题设不含重复字符串</strong>矛盾，所以s必须要由两个非空字符串构成才合法。</p>
<p>  因为不含重复字符串，所以<code>isConcatenated</code>函数中<code>if (dict.count(word))</code>可以直接返回<code>true</code>，因为<code>word[i]</code>本身肯定不能使得<code>dict.count(word)</code>为<code>true</code>，所以<code>isConcatenated</code>肯定是在至少第二次递归调用时才能返回<code>true</code>，即保证了是由<strong>两个以上字符串</strong>构成。</p>
<p>  <strong>剪枝策略</strong>:<code>for (int i =  min_len; i &lt; word.size() - min_len + 1 ; ++ i)</code>中从min_len开始遍历，因为要在<code>word</code>数组中搜索前缀字符串，所以前缀至少要比<code>word</code>中最短的字符串要长才可能搜索的到。<code>i &lt; word.size() - min_len + 1</code>同理，也是为了保证<code>isConcatenated(word.substr(i, word.size() - i))</code>中的<code>word.size()-i</code>不比<code>min_len</code>小，这样<code>word.substr(i, word.size() - i)</code>才有可能在<code>word</code>数组中找到。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; results;</span><br><span class="line">    <span class="built_in">unordered_set</span>&lt;<span class="built_in">string</span>&gt; dict;</span><br><span class="line">    <span class="keyword">int</span> min_len = <span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isConcatenated</span><span class="params">(<span class="built_in">string</span> <span class="keyword">const</span> &amp; word)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dict.count(word)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i =  min_len; i &lt; word.size() - min_len + <span class="number">1</span> ; ++ i)</span><br><span class="line">            <span class="keyword">if</span> (dict.count(word.substr(<span class="number">0</span>, i)) &gt; <span class="number">0</span> &amp;&amp; isConcatenated(word.substr(i, word.size() - i)))<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; findAllConcatenatedWordsInADict(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words) &#123;</span><br><span class="line">        dict.clear();</span><br><span class="line">        sort(words.begin(), words.end(), [](<span class="keyword">const</span> <span class="built_in">string</span> &amp;lhs, <span class="keyword">const</span> <span class="built_in">string</span> &amp;rhs)&#123;<span class="keyword">return</span> lhs.size() &lt; rhs.size();&#125;);</span><br><span class="line">        min_len = max(<span class="number">1u</span>l, words.front().size());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; words.size(); dict.insert(words[i++]))</span><br><span class="line">            <span class="keyword">if</span> (words[i].size() &gt;= min_len * <span class="number">2</span> &amp;&amp; isConcatenated(words[i]))</span><br><span class="line">                results.push_back(words[i]);</span><br><span class="line">        <span class="keyword">return</span> results;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法二-字典树-dfs"><a class="header-anchor" href="#法二-字典树-dfs">¶</a>法二 字典树+dfs</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">        Node *nxt[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">bool</span> f;</span><br><span class="line">        Node(<span class="keyword">bool</span> fl=<span class="literal">false</span>):f(fl)&#123; fill(nxt,nxt+<span class="number">26</span>,<span class="literal">nullptr</span>); &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    Node *root;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> cur=root;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;c:s)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;nxt[c-<span class="string">'a'</span>]==<span class="literal">nullptr</span>) </span><br><span class="line">                cur-&gt;nxt[c-<span class="string">'a'</span>]=<span class="keyword">new</span> Node();</span><br><span class="line">            cur=cur-&gt;nxt[c-<span class="string">'a'</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        cur-&gt;f=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s, <span class="keyword">int</span> p, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> cur=root;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=p;i&lt;s.size();++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;nxt[s[i]-<span class="string">'a'</span>]==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            cur=cur-&gt;nxt[s[i]-<span class="string">'a'</span>];</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;f&amp;&amp;dfs(s, i+<span class="number">1</span>, d+<span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(d&gt;=<span class="number">1</span>&amp;&amp;cur-&gt;f) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; findAllConcatenatedWordsInADict(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; words) &#123;</span><br><span class="line">        root=<span class="keyword">new</span> Node();</span><br><span class="line">        sort(words.begin(), words.end(), [](<span class="keyword">const</span> <span class="built_in">string</span> &amp;s1, <span class="keyword">const</span> <span class="built_in">string</span> &amp;s2)&#123; <span class="keyword">return</span> s1.size() &lt; s2.size(); &#125;);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:words)&#123; <span class="keyword">if</span>(dfs(x, <span class="number">0</span>, <span class="number">0</span>)) ans.push_back(x); add(x); &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/13/1005-Maximize-Sum-Of-Array-After-K-Negations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/13/1005-Maximize-Sum-Of-Array-After-K-Negations/" itemprop="url">1005. Maximize Sum Of Array After K Negations</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-13T20:37:57+08:00">2020-01-13</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-13T20:51:04+08:00">2020-01-13</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1005-maximize-sum-of-array-after-k-negations"><a class="header-anchor" href="#1005-maximize-sum-of-array-after-k-negations">¶</a><a href="https://leetcode.com/problems/maximize-sum-of-array-after-k-negations/" target="_blank" rel="noopener">1005. Maximize Sum Of Array After K Negations</a></h3>
<p>Difficulty: <strong>Easy</strong></p>
<p>Given an array <code>A</code> of integers, we <strong>must</strong> modify the array in the following way: we choose an <code>i</code> and replace <code>A[i]</code> with <code>-A[i]</code>, and we repeat this process <code>K</code> times in total.  (We may choose the same index <code>i</code> multiple times.)</p>
<p>Return the largest possible sum of the array after modifying it in this way.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: A = [4,2,3], K = 1</span><br><span class="line">Output: 5</span><br><span class="line">Explanation: Choose indices (1,) and A becomes [4,-2,3].</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: A = [3,-1,0,2], K = 3</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: Choose indices (1, 2, 2) and A becomes [3,1,0,2].</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: A = [2,-3,-1,5,-4], K = 2</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: Choose indices (1, 4) and A becomes [2,3,-1,5,4].</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= A.length &lt;= 10000</code></li>
<li><code>1 &lt;= K &lt;= 10000</code></li>
<li><code>-100 &lt;= A[i] &lt;= 100</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  贪心法，将尽可能多的负数变成正数，最后剩下的次数k如果是偶数，因为偶数次作用在同一个元素上会正负抵消，所以可以直接返回结果，如果是奇数（因为奇数k必定大于0，说明将所有负数都翻转过了次数还没用完，此时数组肯定全是正数），则必须要多翻转一个元素，为了使得损失最小，需要选择最小的正数翻转。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">largestSumAfterKNegations</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        sort(A.begin(), A.end());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; K &gt; <span class="number">0</span> &amp;&amp; i &lt; A.size() &amp;&amp; A[i] &lt; <span class="number">0</span>; ++i, --K)</span><br><span class="line">            A[i] = -A[i];</span><br><span class="line">        <span class="keyword">return</span> accumulate(A.begin(), A.end(), <span class="number">0</span>) - (K%<span class="number">2</span>) * *min_element(A.begin(), A.end()) * <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  另外，此题还可以用堆来做。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">largestSumAfterKNegations</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; A, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:A) q.push(x);</span><br><span class="line">        <span class="keyword">while</span>(k--&gt;<span class="number">0</span>) &#123;<span class="keyword">int</span> x=-q.top();q.pop();q.push(x);&#125;</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;ans+=q.top();q.pop();&#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/13/432-All-O-one-Data-Structure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/13/432-All-O-one-Data-Structure/" itemprop="url">432. All O`one Data Structure</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-13T14:44:00+08:00">2020-01-13</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-01-13T16:06:39+08:00">2020-01-13</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="432-all-o-one-data-structure"><a class="header-anchor" href="#432-all-o-one-data-structure">¶</a>[432. All O`one Data Structure]</h3>
<p>(<a href="https://leetcode.com/problems/all-oone-data-structure/" target="_blank" rel="noopener">https://leetcode.com/problems/all-oone-data-structure/</a>)</p>
<p>Difficulty: <strong>Hard</strong></p>
<p>Implement a data structure supporting the following operations:</p>
<ol>
<li>Inc(Key) - Inserts a new key <key style="display: inline;">with value 1. Or increments an existing key by 1. Key is guaranteed to be a <strong>non-empty</strong> string.</key></li>
<li>Dec(Key) - If Key’s value is 1, remove it from the data structure. Otherwise decrements an existing key by 1. If the key does not exist, this function does nothing. Key is guaranteed to be a <strong>non-empty</strong> string.</li>
<li>GetMaxKey() - Returns one of the keys with maximal value. If no element exists, return an empty string <code>&quot;&quot;</code>.</li>
<li>GetMinKey() - Returns one of the keys with minimal value. If no element exists, return an empty string <code>&quot;&quot;</code>.</li>
</ol>
<p>Challenge: Perform all these in O(1) time complexity.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h5 id="法一-非o-1-解法"><a class="header-anchor" href="#法一-非o-1-解法">¶</a>法一 非O(1)解法</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllOne</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; hash;</span><br><span class="line">    AllOne() &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Inserts a new key &lt;Key&gt; with value 1. Or increments an existing key by 1. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="built_in">string</span> key)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         <span class="keyword">if</span>(hash.find(key) == hash.end())</span><br><span class="line">         &#123;hash[key] = <span class="number">1</span>;&#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         &#123;hash[key] += <span class="number">1</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Decrements an existing key by 1. If Key's value is 1, remove it from the data structure. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="built_in">string</span> key)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(hash.find(key) != hash.end())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(hash[key] == <span class="number">1</span>)</span><br><span class="line">            &#123;hash.erase(key);&#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;hash[key] -= <span class="number">1</span>;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns one of the keys with maximal value. */</span></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getMaxKey</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(hash.size() &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> max_util = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">string</span> key = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;i : hash)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(i.second &gt;= max_util)</span><br><span class="line">                &#123;</span><br><span class="line">                    max_util = i.second;</span><br><span class="line">                    key = i.first;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> key;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h5 id="法二-非o-1-解法"><a class="header-anchor" href="#法二-非o-1-解法">¶</a>法二 非O(1)解法</h5>
<p>  有点像O(1)，但是插入字符串的时候是O(logn)复杂度的，把<code>std::set&lt;std::string&gt; keys;</code>改成<code>std::unordered_set&lt;std::string&gt; keys;</code>就是O(1)了吧。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllOne</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    AllOne() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Inserts a new key &lt;Key&gt; with value 1. Or increments an existing key by 1. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it = _m.find(key);</span><br><span class="line">        inc((it == _m.end() ? _cache.end() : it-&gt;second), key);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Decrements an existing key by 1. If Key's value is 1, remove it from the data structure. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it = _m.find(key);</span><br><span class="line">        <span class="keyword">if</span> (it == _m.end()) <span class="keyword">return</span>;</span><br><span class="line">        dec(it-&gt;second, key);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns one of the keys with maximal value. */</span></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getMaxKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (_m.empty())</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">return</span> *_cache.back().keys.begin();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns one of the keys with Minimal value. */</span></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getMinKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (_m.empty())</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">return</span> *_cache.front().keys.begin();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; keys;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">list</span>&lt;Node&gt;::iterator it, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (it == _cache.end()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (_cache.empty() || _cache.front().val != <span class="number">1</span>)</span><br><span class="line">                _cache.emplace_front(Node&#123;<span class="number">1</span>, &#123;key&#125;&#125;);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                _cache.front().keys.insert(key);</span><br><span class="line">            _m.emplace(key, _cache.begin());</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">auto</span> next = <span class="built_in">std</span>::next(it);</span><br><span class="line">        <span class="keyword">if</span> (next != _cache.end() &amp;&amp; next-&gt;val == it-&gt;val + <span class="number">1</span>) &#123;</span><br><span class="line">            next-&gt;keys.insert(key);</span><br><span class="line">            _m[key] = next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            _cache.insert(next, Node&#123;it-&gt;val + <span class="number">1</span>,&#123;key&#125;&#125;);</span><br><span class="line">            _m[key] = <span class="built_in">std</span>::next(it);</span><br><span class="line">        &#125;</span><br><span class="line">        it-&gt;keys.erase(key);</span><br><span class="line">        <span class="keyword">if</span> (it-&gt;keys.empty()) _cache.erase(it);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">list</span>&lt;Node&gt;::iterator it, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;key)</span> </span>&#123;</span><br><span class="line">        it-&gt;keys.erase(key);</span><br><span class="line">        <span class="keyword">if</span> (it-&gt;val == <span class="number">1</span>) &#123;</span><br><span class="line">            _m.erase(key);</span><br><span class="line">            <span class="keyword">if</span> (it-&gt;keys.empty()) _cache.erase(it);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (it == _cache.begin()) &#123;</span><br><span class="line">            _cache.emplace_front(Node&#123;it-&gt;val - <span class="number">1</span>, &#123;key&#125;&#125;);</span><br><span class="line">            _m[key] = _cache.begin();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">auto</span> prev = <span class="built_in">std</span>::prev(it);</span><br><span class="line">            <span class="keyword">if</span> (prev-&gt;val == it-&gt;val - <span class="number">1</span>) &#123;</span><br><span class="line">                prev-&gt;keys.insert(key);</span><br><span class="line">                _m[key] = prev;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                _cache.emplace(it, Node&#123;it-&gt;val - <span class="number">1</span>, &#123;key&#125;&#125;);</span><br><span class="line">                _m[key] = <span class="built_in">std</span>::prev(it);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (it-&gt;keys.empty()) _cache.erase(it);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="built_in">std</span>::<span class="built_in">list</span>&lt;Node&gt;::iterator&gt; _m;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt;Node&gt; _cache;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="法三-o-1-解法"><a class="header-anchor" href="#法三-o-1-解法">¶</a>法三 O(1)解法</h5>
<p>  每个值维护一个桶，然后用一个unordered_map维护key到桶中位置的映射关系，为了O(1)能取到最大最小，需要用list存放所有值桶。我个人最喜欢这个解法，因为代码风格很好。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllOne</span> &#123;</span></span><br><span class="line">  <span class="keyword">typedef</span> <span class="built_in">string</span> <span class="keyword">key_t</span>;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">int</span> <span class="keyword">val_t</span>;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="built_in">list</span>&lt;<span class="keyword">key_t</span>&gt; <span class="keyword">keylist_t</span>;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="built_in">list</span>&lt;pair&lt;<span class="keyword">val_t</span>, <span class="keyword">keylist_t</span>&gt;&gt; <span class="keyword">vallist_t</span>;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">keylist_t</span>::iterator <span class="keyword">keyiter_t</span>;</span><br><span class="line">  <span class="keyword">typedef</span> <span class="keyword">vallist_t</span>::iterator <span class="keyword">valiter_t</span>;</span><br><span class="line"> <span class="keyword">protected</span>:</span><br><span class="line">  <span class="keyword">vallist_t</span> vallist;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="keyword">key_t</span>, pair&lt;<span class="keyword">valiter_t</span>, <span class="keyword">keyiter_t</span>&gt;&gt; keymap;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  AllOne() &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> it = keymap.find(key);</span><br><span class="line">    <span class="keyword">valiter_t</span> vit;</span><br><span class="line">    <span class="keyword">keyiter_t</span> eit;</span><br><span class="line">    <span class="keyword">if</span> (it == keymap.end()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (vallist.empty() || vallist.front().first != <span class="number">1</span>)</span><br><span class="line">        vit = vallist.insert(vallist.begin(), make_pair(<span class="number">1</span>, <span class="keyword">keylist_t</span>()));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        vit = vallist.begin();</span><br><span class="line">      eit = vit-&gt;second.insert(vit-&gt;second.begin(), key);</span><br><span class="line">      keymap[key] = make_pair(vit, eit);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      vit = it-&gt;second.first;</span><br><span class="line">      eit = it-&gt;second.second;</span><br><span class="line">      <span class="keyword">auto</span> val = vit-&gt;first + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">auto</span> nvit = next(vit);</span><br><span class="line">      <span class="keyword">if</span> (nvit == vallist.end() || nvit-&gt;first != val)</span><br><span class="line">        nvit = vallist.insert(nvit, make_pair(val, <span class="keyword">keylist_t</span>()));</span><br><span class="line">      <span class="keyword">auto</span> neit = nvit-&gt;second.insert(nvit-&gt;second.begin(), *eit);</span><br><span class="line">      vit-&gt;second.erase(eit);</span><br><span class="line">      <span class="keyword">if</span> (vit-&gt;second.empty())</span><br><span class="line">        vallist.erase(vit);</span><br><span class="line">      it-&gt;second = make_pair(nvit, neit);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">valiter_t</span> vit, pvit;</span><br><span class="line">    <span class="keyword">keyiter_t</span> eit, peit;</span><br><span class="line">    <span class="keyword">auto</span> it = keymap.find(key);</span><br><span class="line">    <span class="keyword">if</span> (it == keymap.end()) <span class="keyword">return</span>;</span><br><span class="line">    vit = it-&gt;second.first;</span><br><span class="line">    eit = it-&gt;second.second;</span><br><span class="line">    <span class="keyword">auto</span> val = vit-&gt;first - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (val) &#123;</span><br><span class="line">      <span class="keyword">if</span> (vit == vallist.begin() || prev(vit)-&gt;first != val)</span><br><span class="line">        pvit = vallist.insert(vit, make_pair(val, <span class="keyword">keylist_t</span>()));</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        pvit = prev(vit);</span><br><span class="line">      peit = pvit-&gt;second.insert(pvit-&gt;second.begin(), *eit);</span><br><span class="line">      it-&gt;second = make_pair(pvit, peit);</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">      keymap.erase(it);</span><br><span class="line">    vit-&gt;second.erase(eit);</span><br><span class="line">    <span class="keyword">if</span> (vit-&gt;second.empty())</span><br><span class="line">      vallist.erase(vit);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="built_in">string</span> <span class="title">getMaxKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> vallist.empty() ? <span class="string">""</span> : vallist.back().second.front();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="built_in">string</span> <span class="title">getMinKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> vallist.empty() ? <span class="string">""</span> : vallist.front().second.front();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//作者：sinstar</span></span><br><span class="line"><span class="comment">//链接：https://leetcode-cn.com/problems/all-oone-data-structure/solution/shi-zi-lian-biao-ha-xi-biao-quan-o1-by-sinstar/</span></span><br><span class="line"><span class="comment">//来源：力扣（LeetCode）</span></span><br><span class="line"><span class="comment">//著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</span></span><br></pre></td></tr></table></figure>
<h5 id="法四-o-1-解法"><a class="header-anchor" href="#法四-o-1-解法">¶</a>法四 O(1)解法</h5>
<p>&amp;esmp; 借鉴了https://leetcode.com/problems/insert-delete-getrandom-o1-duplicates-allowed/ 中的O(1)vector，实现key插入删除为O(1)复杂度的词频vector。代码里的DLList维护的是词频值的双向链表，是为了方便O(1)时间获取最大最小词频值。其实不要这个双向链表，也是可以进行正常的插入删除的，不过在获取最大最小词频对应的key时，需要遍历value_freq，因此为了O(1)获得最大最小需要这个双向链表。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLNode</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> freq;</span><br><span class="line">    DLNode* prev;</span><br><span class="line">    DLNode* next;</span><br><span class="line">    DLNode() : freq(<span class="number">0</span>), prev(<span class="literal">nullptr</span>), next(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    DLNode(<span class="keyword">int</span> f) : freq(f), prev(<span class="literal">nullptr</span>), next(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DLList</span> &#123;</span></span><br><span class="line">    DLNode* head;</span><br><span class="line">    DLNode* tail;</span><br><span class="line">    DLList() &#123;</span><br><span class="line">        head = <span class="keyword">new</span> DLNode();</span><br><span class="line">        tail = <span class="keyword">new</span> DLNode();</span><br><span class="line">        head-&gt;next = tail;</span><br><span class="line">        tail-&gt;prev = head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">erase</span><span class="params">(DLNode* node)</span> </span>&#123;</span><br><span class="line">        node-&gt;next-&gt;prev = node-&gt;prev;</span><br><span class="line">        node-&gt;prev-&gt;next = node-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(DLNode* left, DLNode* right, DLNode* node)</span> </span>&#123;</span><br><span class="line">        left-&gt;next = node;</span><br><span class="line">        right-&gt;prev = node;</span><br><span class="line">        node-&gt;prev = left;</span><br><span class="line">        node-&gt;next = right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMaxFreq</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tail-&gt;prev-&gt;freq;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMinFreq</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> head-&gt;next-&gt;freq;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AllOne</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    DLList* dl;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; value_freq;<span class="comment">//单词-&gt;词频</span></span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &gt; freq_values;<span class="comment">//词频-&gt;该词频下的所有单词的vector数组</span></span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; value_index;<span class="comment">//单词-&gt;在词频数组中的下标</span></span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, DLNode*&gt; freq_node;<span class="comment">//词频-&gt;在双链表中的节点地址</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">incrKey</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value_freq.count(key) == <span class="number">0</span>) &#123;</span><br><span class="line">            value_freq[key] = <span class="number">1</span>;</span><br><span class="line">            freq_values[<span class="number">1</span>].push_back(key);</span><br><span class="line">            value_index[key] = freq_values[<span class="number">1</span>].size() - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// remove old info</span></span><br><span class="line">            <span class="keyword">int</span> freq = value_freq[key];</span><br><span class="line">            <span class="keyword">int</span> ind = value_index[key];</span><br><span class="line">            <span class="built_in">string</span> tail_key = freq_values[freq].back();</span><br><span class="line">            <span class="keyword">if</span>(tail_key!=key)&#123;</span><br><span class="line">                freq_values[freq][ind] = tail_key;</span><br><span class="line">                value_index[tail_key] = ind;</span><br><span class="line">            &#125;</span><br><span class="line">            freq_values[freq].pop_back();</span><br><span class="line">            <span class="comment">// add new info</span></span><br><span class="line">            ++value_freq[key];</span><br><span class="line">            ++freq;</span><br><span class="line">            freq_values[freq].push_back(key);</span><br><span class="line">            value_index[key] = freq_values[freq].size() - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decrKey</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value_freq.count(key) == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> freq = value_freq[key];</span><br><span class="line">        <span class="keyword">int</span> ind = value_index[key];</span><br><span class="line">        <span class="built_in">string</span> tail_key = freq_values[freq].back();</span><br><span class="line">        <span class="keyword">if</span>(tail_key!=key)&#123;</span><br><span class="line">            freq_values[freq][ind] = tail_key;</span><br><span class="line">            value_index[tail_key] = ind;</span><br><span class="line">        &#125;</span><br><span class="line">        freq_values[freq].pop_back();</span><br><span class="line">        <span class="comment">// update info</span></span><br><span class="line">        --freq;</span><br><span class="line">        <span class="keyword">if</span> (freq == <span class="number">0</span>) &#123;</span><br><span class="line">            value_freq.erase(key);</span><br><span class="line">            value_index.erase(key);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            value_freq[key] = freq;</span><br><span class="line">            freq_values[freq].push_back(key);</span><br><span class="line">            value_index[key] = freq_values[freq].size() - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateFreq</span><span class="params">(<span class="keyword">int</span> old_freq, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> new_freq = old_freq + d;</span><br><span class="line">        <span class="keyword">auto</span> cur=freq_node[old_freq];</span><br><span class="line">        <span class="keyword">auto</span> right = d==<span class="number">1</span>?cur-&gt;next:cur;</span><br><span class="line">        <span class="keyword">auto</span> left = d==<span class="number">1</span>?cur:cur-&gt;prev;</span><br><span class="line">        <span class="keyword">if</span> (freq_node.count(new_freq) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">auto</span> node = <span class="keyword">new</span> DLNode(new_freq);</span><br><span class="line">            freq_node[new_freq] = node;</span><br><span class="line">            dl-&gt;add(left, right, node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (old_freq != <span class="number">0</span> &amp;&amp; freq_values[old_freq].empty()) &#123;</span><br><span class="line">            dl-&gt;erase(cur);</span><br><span class="line">            freq_node.erase(old_freq);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getValueofFreq</span><span class="params">(<span class="keyword">int</span> freq)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (freq == <span class="number">0</span> || freq_values[freq].empty()) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">return</span> freq_values[freq][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    AllOne() &#123;</span><br><span class="line">        dl = <span class="keyword">new</span> DLList();</span><br><span class="line">        freq_node[<span class="number">0</span>] = dl-&gt;head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Inserts a new key &lt;Key&gt; with value 1. Or increments an existing key by 1. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> old_freq = value_freq.count(key) ? value_freq[key] : <span class="number">0</span>;</span><br><span class="line">        incrKey(key);</span><br><span class="line">        updateFreq(old_freq, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Decrements an existing key by 1. If Key's value is 1, remove it from the data structure. */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="built_in">string</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value_freq.count(key) == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> old_freq = value_freq[key];</span><br><span class="line">        decrKey(key);</span><br><span class="line">        updateFreq(old_freq,<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns one of the keys with maximal value. */</span></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getMaxKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getValueofFreq(dl-&gt;getMaxFreq());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/** Returns one of the keys with Minimal value. */</span></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getMinKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getValueofFreq(dl-&gt;getMinFreq());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">442</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
