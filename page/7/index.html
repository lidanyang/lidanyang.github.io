<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.0" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="分类">
<meta property="og:url" content="http://yoursite.com/categories/index.html">
<meta property="og:site_name" content="Just a blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-05-28T06:22:34.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分类">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/categories/">





  <title>Just a blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Just a blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/20/882-Reachable-Nodes-In-Subdivided-Graph/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/20/882-Reachable-Nodes-In-Subdivided-Graph/" itemprop="url">882. Reachable Nodes In Subdivided Graph</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-20T17:13:44+08:00">2020-02-20</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-20T17:24:46+08:00">2020-02-20</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="882-reachable-nodes-in-subdivided-graph"><a class="header-anchor" href="#882-reachable-nodes-in-subdivided-graph">¶</a><a href="https://leetcode.com/problems/reachable-nodes-in-subdivided-graph/" target="_blank" rel="noopener">882. Reachable Nodes In Subdivided Graph</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Starting with an <strong>undirected</strong> graph (the “original graph”) with nodes from <code>0</code> to <code>N-1</code>, subdivisions are made to some of the edges.</p>
<p>The graph is given as follows: <code>edges[k]</code> is a list of integer pairs <code>(i, j, n)</code> such that <code>(i, j)</code> is an edge of the original graph,</p>
<p>and <code>n</code> is the total number of <strong>new</strong> nodes on that edge.</p>
<p>Then, the edge <code>(i, j)</code> is deleted from the original graph, <code>n</code> new nodes <code>(x_1, x_2, ..., x_n)</code> are added to the original graph,</p>
<p>and <code>n+1</code> new edges <code>(i, x_1), (x_1, x_2), (x_2, x_3), ..., (x_{n-1}, x_n), (x_n, j)</code> are added to the original graph.</p>
<p>Now, you start at node <code>0</code> from the original graph, and in each move, you travel along one edge.</p>
<p>Return how many nodes you can reach in at most <code>M</code> moves.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: edges = [[0,1,10],[0,2,1],[1,2,2]], M = 6, N = 3</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: </span><br><span class="line">The nodes that are reachable in the final graph after M = 6 moves are indicated below.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: edges = [[0,1,4],[1,2,6],[0,2,8],[1,3,1]], M = 10, N = 4</span><br><span class="line">Output: 23</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>0 &lt;= edges.length &lt;= 10000</code></li>
<li><code>0 &lt;= edges[i][0] &lt; edges[i][1] &lt; N</code></li>
<li>There does not exist any <code>i != j</code> for which <code>edges[i][0] == edges[j][0]</code> and <code>edges[i][1] == edges[j][1]</code>.</li>
<li>The original graph has no parallel edges.</li>
<li><code>0 &lt;= edges[i][2] &lt;= 10000</code></li>
<li><code>0 &lt;= M &lt;= 10^9</code></li>
<li><code>&lt;font face=&quot;monospace&quot; style=&quot;display: inline;&quot;&gt;1 &lt;= N &lt;= 3000&lt;/font&gt;</code></li>
<li>A reachable node is a node that can be travelled to using at most M moves starting from node 0.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>dijiskra最短路，然后看看从每个最短路能够到几个新增的点，注意方向问题（a和b的边，可以从a到b，也可以从b到a）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">reachableNodes</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; edges, <span class="keyword">int</span> M, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;&gt; G(N);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : edges)&#123;</span><br><span class="line">            G[x[<span class="number">1</span>]].push_back(&#123;x[<span class="number">0</span>], x[<span class="number">2</span>]+<span class="number">1</span>&#125;);</span><br><span class="line">            G[x[<span class="number">0</span>]].push_back(&#123;x[<span class="number">1</span>], x[<span class="number">2</span>]+<span class="number">1</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; dis(N, &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;, <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;, greater&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;&gt; q;</span><br><span class="line">        q.push(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        dis[<span class="number">0</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">auto</span> [dist, node] = q.top();q.pop();</span><br><span class="line">            <span class="keyword">if</span>(dis[node].second) <span class="keyword">continue</span>;</span><br><span class="line">            dis[node].second = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(dis[node].first &lt;= M) ++ans;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> [nxt, d] : G[node])&#123;</span><br><span class="line">                <span class="keyword">if</span>(dis[node].first &lt;= M)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!dis[nxt].second) ans += min(d<span class="number">-1</span>, M - dis[node].first);</span><br><span class="line">                    <span class="keyword">else</span> ans += min(max(<span class="number">0</span>, d<span class="number">-1</span>-M + dis[nxt].first), M - dis[node].first);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span> ans;</span><br><span class="line">                <span class="keyword">if</span>(!dis[nxt].second &amp;&amp; (dis[nxt].first == <span class="number">-1</span> || dis[node].first+d &lt; dis[nxt].first ))&#123;</span><br><span class="line">                    dis[nxt].first = dis[node].first+d;</span><br><span class="line">                    q.push(&#123;dis[nxt].first, nxt&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// [[0,1,10],[0,2,1],[1,2,2]]</span></span><br><span class="line"><span class="comment">// 6</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// [[0,1,4],[1,2,6],[0,2,8],[1,3,1]]</span></span><br><span class="line"><span class="comment">// 10</span></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line">​</span><br></pre></td></tr></table></figure>
<p>贴几个别人的解法:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="keyword">namespace</span> zm</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">template</span> &lt;<span class="keyword">typename</span> K,</span><br><span class="line">           <span class="keyword">typename</span> T,</span><br><span class="line">           <span class="keyword">typename</span> Hash      = <span class="built_in">std</span>::hash&lt;K&gt;,</span><br><span class="line">           <span class="keyword">typename</span> KeyEqual  = <span class="built_in">std</span>::equal_to&lt;K&gt;,</span><br><span class="line">           <span class="keyword">typename</span> Allocator = <span class="built_in">std</span>::allocator&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">const</span> K,T&gt;&gt;&gt;</span><br><span class="line"> struct hashmap : <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;K,T,Hash,KeyEqual,Allocator&gt;</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;K,T,Hash,KeyEqual,Allocator&gt;::<span class="built_in">unordered_map</span>;</span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">has</span> <span class="params">(K <span class="keyword">const</span>&amp; key)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">this</span>-&gt;find(key) != <span class="keyword">this</span>-&gt;end();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">contains</span> <span class="params">(K <span class="keyword">const</span>&amp; key)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">this</span>-&gt;has(key);</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">a_node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"> <span class="keyword">int</span> index;</span><br><span class="line"> <span class="keyword">int</span> distance;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">auto</span> <span class="title">totuple</span> <span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> tie(index,distance);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> a_node (<span class="keyword">int</span> index, <span class="keyword">int</span> distance)</span><br><span class="line"> : index(index)</span><br><span class="line"> , distance(distance)</span><br><span class="line"> &#123;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (a_node <span class="keyword">const</span>&amp; that) <span class="keyword">const</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">return</span> totuple() &lt; that.totuple();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (a_node <span class="keyword">const</span>&amp; that) <span class="keyword">const</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">return</span> that &lt; *<span class="keyword">this</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (a_node <span class="keyword">const</span>&amp; that) <span class="keyword">const</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">return</span> !(*<span class="keyword">this</span> &gt; that);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;= (a_node <span class="keyword">const</span>&amp; that) <span class="keyword">const</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">return</span> !(that &gt; *<span class="keyword">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span></span><br><span class="line"><span class="keyword">namespace</span> leetcode_dijkstra</span><br><span class="line">&#123;</span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">a_solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> N;</span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> M;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;a_node&gt;&gt; neighbors;</span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; distances;</span><br><span class="line">  hashmap&lt;<span class="keyword">int</span>,hashmap&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; points; <span class="comment">// on edges.</span></span><br><span class="line">  <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; seen; <span class="comment">// nodes visited in dijkstra.</span></span><br><span class="line"></span><br><span class="line">  a_solution (<span class="keyword">int</span> <span class="keyword">const</span> N, <span class="keyword">int</span> <span class="keyword">const</span> M, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;<span class="keyword">const</span>&amp; edges)</span><br><span class="line">  : N(N)</span><br><span class="line">  , M(M)</span><br><span class="line">  , neighbors(N)</span><br><span class="line">  , distances(N,M+<span class="number">1</span>)</span><br><span class="line">  , seen(N)</span><br><span class="line">  &#123;</span><br><span class="line">   distances[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">auto</span>&amp;&amp; edge : edges)</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">auto</span> <span class="keyword">const</span> [u,v,w] = tie(edge[<span class="number">0</span>],edge[<span class="number">1</span>],edge[<span class="number">2</span>]);</span><br><span class="line">    neighbors[u].emplace_back(v,w);</span><br><span class="line">    neighbors[v].emplace_back(u,w);</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">auto</span> <span class="keyword">const</span> greater = [&amp;](<span class="keyword">auto</span>&amp;&amp;m,<span class="keyword">auto</span>&amp;&amp;n)&#123;<span class="keyword">return</span> m.distance&gt;n.distance;&#125;;</span><br><span class="line">   priority_queue&lt;a_node,<span class="built_in">vector</span>&lt;a_node&gt;,<span class="keyword">decltype</span>(greater)&gt; minq(greater,&#123;&#123;<span class="number">0</span>,<span class="number">0</span>&#125;&#125;);</span><br><span class="line">   <span class="keyword">while</span> (!minq.empty())</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">auto</span> <span class="keyword">const</span> [node,distance] = minq.top(); minq.pop();</span><br><span class="line">    <span class="keyword">if</span> (distance &gt; distances[node])</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    distances[node] = distance;</span><br><span class="line"></span><br><span class="line">    seen[node] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> [neighbor,count] : neighbors[node])</span><br><span class="line">    &#123;</span><br><span class="line">     <span class="comment">// M-distance == how much further we can walk from this node.</span></span><br><span class="line">     <span class="comment">// count == how many new nodes there are on this edge.</span></span><br><span class="line">     <span class="keyword">auto</span> <span class="keyword">const</span> [m,M] = minmax(node,neighbor);</span><br><span class="line">     <span class="keyword">auto</span>&amp; points = <span class="keyword">this</span>-&gt;points[m][M];</span><br><span class="line">     points = min(count,points+<span class="keyword">this</span>-&gt;M-distance);</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">auto</span> <span class="keyword">const</span> total = distance+count+<span class="number">1</span>; total &lt; distances[neighbor])</span><br><span class="line">     &#123;</span><br><span class="line">      distances[neighbor] = total;</span><br><span class="line">      minq.emplace(neighbor,total);</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   dijkstra();</span><br><span class="line">   <span class="keyword">auto</span> count = accumulate(begin(seen),end(seen),<span class="number">0</span>)</span><br><span class="line">              + accumulate(begin(points),end(points),<span class="number">0</span>,[&amp;](<span class="keyword">auto</span>&amp;&amp;sum,<span class="keyword">auto</span>&amp;&amp;pair)</span><br><span class="line">                &#123;</span><br><span class="line">                 <span class="keyword">auto</span>&amp;&amp;neighbors = pair.second;</span><br><span class="line">                 <span class="keyword">return</span> sum+accumulate(begin(neighbors),end(neighbors),<span class="number">0</span>,[&amp;](<span class="keyword">auto</span>&amp;&amp;sum,<span class="keyword">auto</span>&amp;&amp;pair)&#123;<span class="keyword">return</span> sum+pair.second;&#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">   <span class="keyword">return</span> count;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;; <span class="comment">// a_solution</span></span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">int</span> <span class="title">reachableNodes</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;<span class="keyword">const</span>&amp; edges, <span class="keyword">int</span> <span class="keyword">const</span> M, <span class="keyword">int</span> <span class="keyword">const</span> N)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> a_solution&#123;N,M,edges&#125;.solve();</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>把M当成油量，算出到每个节点剩余的最多油量。某个边的端点剩余油量和边上的新增点点数的最小值即能到达的这些新增点的个数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">reachableNodes</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; edges, <span class="keyword">int</span> M, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;&gt; graph(N);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; edge: edges)&#123;</span><br><span class="line">            graph[edge[<span class="number">0</span>]].push_back(&#123;edge[<span class="number">1</span>], edge[<span class="number">2</span>]&#125;);</span><br><span class="line">            graph[edge[<span class="number">1</span>]].push_back(&#123;edge[<span class="number">0</span>], edge[<span class="number">2</span>]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; HP(N, INT_MIN);</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q&#123;&#123;<span class="number">0</span>&#125;&#125;;</span><br><span class="line">        HP[<span class="number">0</span>] = M;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> f = q.front(); q.pop();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;next: graph[f])&#123;</span><br><span class="line">                <span class="keyword">int</span> next_hp = HP[f] - next.second - <span class="number">1</span>; </span><br><span class="line">                <span class="keyword">if</span> (next_hp &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (HP[next.first] &lt; next_hp)&#123;</span><br><span class="line">                    HP[next.first] = next_hp;</span><br><span class="line">                    q.push(next.first);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;N; i++) ret += HP[i]&gt;=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; edge: edges)&#123;</span><br><span class="line">            <span class="keyword">int</span> i = HP[edge[<span class="number">0</span>]]==INT_MIN? <span class="number">0</span>: HP[edge[<span class="number">0</span>]];</span><br><span class="line">            <span class="keyword">int</span> j = HP[edge[<span class="number">1</span>]]==INT_MIN? <span class="number">0</span>: HP[edge[<span class="number">1</span>]];</span><br><span class="line">            ret += min(i+j, edge[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/19/920-Number-of-Music-Playlists/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/19/920-Number-of-Music-Playlists/" itemprop="url">920. Number of Music Playlists</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-19T22:09:00+08:00">2020-02-19</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-20T01:59:23+08:00">2020-02-20</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="920-number-of-music-playlists"><a class="header-anchor" href="#920-number-of-music-playlists">¶</a><a href="https://leetcode.com/problems/number-of-music-playlists/" target="_blank" rel="noopener">920. Number of Music Playlists</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>Your music player contains <code>N</code> different songs and she wants to listen to <code>L</code>(not necessarily different) songs during your trip.  You create a playlist so that:</p>
<ul>
<li>Every song is played at least once</li>
<li>A song can only be played again only if <code>K</code> other songs have been played</li>
</ul>
<p>Return the number of possible playlists.  <strong>As the answer can be very large, return it modulo <code>10^9 + 7</code></strong>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: N = 3, L = 3, K = 1</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: There are 6 possible playlists. [1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1].</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: N = 2, L = 3, K = 0</span><br><span class="line">Output: 6</span><br><span class="line">Explanation: There are 6 possible playlists. [1, 1, 2], [1, 2, 1], [2, 1, 1], [2, 2, 1], [2, 1, 2], [1, 2, 2]</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: N = 2, L = 3, K = 1</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: There are 2 possible playlists. [1, 2, 1], [2, 1, 2]</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>0 &lt;= K &lt; N &lt;= L &lt;= 100</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-简单dp"><a class="header-anchor" href="#法一-简单dp">¶</a>法一 简单dp</h6>
<p>  <code>dp[i]</code>代表一共有i首不同的歌时的列表数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keyword">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numMusicPlaylists</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> L, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; dp(N+<span class="number">1</span>);</span><br><span class="line">        dp[K+<span class="number">1</span>] = N;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; ++i) dp[K+<span class="number">1</span>] = (dp[K+<span class="number">1</span>]*(N-i)) % p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = K+<span class="number">1</span> ; i&lt; L; ++i) <span class="keyword">for</span>(<span class="keyword">int</span> j = N; j &gt;= max(<span class="number">1</span>, K); --j) dp[j] = (dp[j<span class="number">-1</span>]*(N-j+<span class="number">1</span>)+dp[j]*(j-K)) % p;    </span><br><span class="line">        <span class="keyword">return</span> dp[N];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br></pre></td></tr></table></figure>
<h6 id="法二-数学推导-dp"><a class="header-anchor" href="#法二-数学推导-dp">¶</a>法二 数学推导+dp</h6>
<p>  每首歌第一次出现的位置可以形成一种序列(x1, x2, x3…)，而每个这样的序列都可以直接通过数学算出其对应的列表的数量，即只要知道每首歌第一次出现位置的分布，就能直接算出对应这种分布的列表数。剩下的任务就是对每种分布枚举计算。最后能得到一个简单的递推式。具体见<a href="https://leetcode.com/articles/number-of-music-playlists/" target="_blank" rel="noopener">leetcode题解</a>。题解里的公式是错的，正确的应该是⟨S,P⟩=P⟨S−1,P⟩+⟨S,P-1⟩。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="keyword">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numMusicPlaylists</span><span class="params">(<span class="keyword">int</span> N, <span class="keyword">int</span> L, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; dp(L-N+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N-K; ++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= L- N; ++j)</span><br><span class="line">                dp[j] = (dp[j<span class="number">-1</span>]*i+dp[j]) % p;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">long</span> ans  = dp[L-N];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) ans = (ans * i)%p;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="法三-生成函数"><a class="header-anchor" href="#法三-生成函数">¶</a>法三 生成函数</h6>
<p>观察法二的公式，可以发现是求1-P的自然数的幂次(j^kj, 1 &lt;= j &lt;= P)的积，它们的每个幂次的指数(kj)的和是S。这个可以对应到生成函数<code>f(x)=sigma(1^0*x^0+1^1x^1+....)*sigma(2^0*x^0+2^1*x^1+...)*...*sigma(P^0*x^0+P^1*x^1+...)</code>。然后对生成函数的级数求和，对结果运用多项式的中国剩余定理由分式积拆成分式和，然后算出每个分式项的系数（通过取特殊值），最后再将分式和级数展开，收集S幂次对应的项得到求法二中的公式的解析式。前后项的系数之间满足一个等式关系，所以后项系数可由前项系数O(1)时间求出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numMusicPlaylists</span><span class="params">(self, N, L, K)</span>:</span></span><br><span class="line">        MOD = <span class="number">10</span>**<span class="number">9</span> + <span class="number">7</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">inv</span><span class="params">(x)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> pow(x, MOD<span class="number">-2</span>, MOD)</span><br><span class="line"></span><br><span class="line">        C = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">1</span>, N-K):</span><br><span class="line">            C *= -x</span><br><span class="line">            C %= MOD</span><br><span class="line">        C = inv(C)</span><br><span class="line"></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">1</span>, N-K+<span class="number">1</span>):</span><br><span class="line">            ans += pow(k, L-K<span class="number">-1</span>, MOD) * C</span><br><span class="line">            C = C * (k - (N-K)) % MOD * inv(k) % MOD</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">1</span>, N+<span class="number">1</span>):</span><br><span class="line">            ans = ans * k % MOD</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/19/1036-Escape-a-Large-Maze/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/19/1036-Escape-a-Large-Maze/" itemprop="url">1036. Escape a Large Maze</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-19T14:50:00+08:00">2020-02-19</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-20T17:27:02+08:00">2020-02-20</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1036-escape-a-large-maze"><a class="header-anchor" href="#1036-escape-a-large-maze">¶</a><a href="https://leetcode.com/problems/escape-a-large-maze/" target="_blank" rel="noopener">1036. Escape a Large Maze</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>In a 1 million by 1 million grid, the coordinates of each grid square are <code>(x, y)</code> with <code>0 &lt;= x, y &lt; 10^6</code>.</p>
<p>We start at the <code>source</code> square and want to reach the <code>target</code> square.  Each move, we can walk to a 4-directionally adjacent square in the grid that isn’t in the given list of <code>blocked</code> squares.</p>
<p>Return <code>true</code> if and only if it is possible to reach the target square through a sequence of moves.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: blocked = [[0,1],[1,0]], source = [0,0], target = [0,2]</span><br><span class="line">Output: false</span><br><span class="line">Explanation: </span><br><span class="line">The target square is inaccessible starting from the source square, because we can&apos;t walk outside the grid.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Input: blocked = [], source = [0,0], target = [999999,999999]</span><br><span class="line">Output: true</span><br><span class="line">Explanation: </span><br><span class="line">Because there are no blocked cells, it&apos;s possible to reach the target square.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>0 &lt;= blocked.length &lt;= 200</code></li>
<li><code>blocked[i].length == 2</code></li>
<li><code>0 &lt;= blocked[i][j] &lt; 10^6</code></li>
<li><code>source.length == target.length == 2</code></li>
<li><code>0 &lt;= source[i][j], target[i][j] &lt; 10^6</code></li>
<li><code>source != target</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-dfs-用栈模拟dfs"><a class="header-anchor" href="#法一-dfs-用栈模拟dfs">¶</a>法一 dfs（用栈模拟dfs）</h6>
<p>  本题的trick在于block的数量有限，所以并不能围住很大一部分，所以一旦能走到离source很远的位置就说明一定没被围住。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// key thinking: major constraint - number of blocks</span></span><br><span class="line"><span class="comment">// for blocks to form enclosing walls, they either need to be</span></span><br><span class="line"><span class="comment">// wide enough (perimeter limit) or deep enough (radius limit)</span></span><br><span class="line"><span class="comment">// when using bfs, see if moving options more than blocks count</span></span><br><span class="line"><span class="comment">// when using dfs, see if we can move farther than block count</span></span><br><span class="line"><span class="comment">// if we could, than that means they are not enclosing</span></span><br><span class="line"><span class="comment">// test against source and target separately</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">static</span> <span class="built_in">array</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, <span class="number">4</span>&gt; dirs &#123;&#123;&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;&#125;;</span><br><span class="line"><span class="keyword">uint64_t</span> key(<span class="keyword">int</span> x, <span class="keyword">int</span> y) &#123;<span class="keyword">return</span> (<span class="keyword">uint64_t</span>(x) &lt;&lt; <span class="number">32</span>) | y;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="built_in">unordered_set</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; &amp;visited, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; s, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; t, <span class="keyword">int</span> blocks)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">stack</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q &#123;&#123; &#123;s[<span class="number">0</span>], s[<span class="number">1</span>]&#125; &#125;&#125;;</span><br><span class="line">  <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">    <span class="keyword">auto</span> [x, y] = q.top(); q.pop();</span><br><span class="line">    <span class="comment">// major optimization: </span></span><br><span class="line">    <span class="comment">// if we have moved deep enough, we are guaranteed to be able to break through walls</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(x - s[<span class="number">0</span>]) + <span class="built_in">abs</span>(y - s[<span class="number">1</span>]) &gt;= blocks || x == t[<span class="number">0</span>] &amp;&amp; y == t[<span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [dx, dy] : dirs) &#123;</span><br><span class="line">      <span class="keyword">auto</span> i = x + dx, j = y + dy;</span><br><span class="line">      <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt; <span class="number">999999</span> || j &lt; <span class="number">0</span> || j &gt; <span class="number">999999</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">auto</span> k = key(i,j); !visited.count(k)) visited.emplace(k), q.emplace(i, j);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isEscapePossible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; blocked, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; s, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; t)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">unordered_set</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; vis_s, <span class="keyword">vis_t</span>;</span><br><span class="line">  <span class="keyword">auto</span> sx = s[<span class="number">0</span>], sy = s[<span class="number">1</span>], tx = t[<span class="number">0</span>], ty = t[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; b : blocked) &#123;</span><br><span class="line">      <span class="comment">// put blocks to visited list so we cannot walk on it</span></span><br><span class="line">      <span class="keyword">auto</span> bx = b[<span class="number">0</span>], by = b[<span class="number">1</span>];</span><br><span class="line">      <span class="comment">// we only care about blocks that could possibly form walls =&gt; only record close blocks</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">abs</span>(bx - sx) + <span class="built_in">abs</span>(by - sy) &lt; <span class="number">201</span>) vis_s.emplace(key(bx, by));</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">abs</span>(bx - tx) + <span class="built_in">abs</span>(by - ty) &lt; <span class="number">201</span>) <span class="keyword">vis_t</span>.emplace(key(bx, by));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// test if either source and target is enclosed</span></span><br><span class="line">  <span class="comment">// if neither are enclosed, then we are good!</span></span><br><span class="line">  <span class="keyword">return</span> dfs(vis_s, s, t, vis_s.size()) &amp;&amp; dfs(<span class="keyword">vis_t</span>, t, s, <span class="keyword">vis_t</span>.size());</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-bfs"><a class="header-anchor" href="#法二-bfs">¶</a>法二 bfs</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> dy[<span class="number">4</span>] = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> B;</span><br><span class="line">    <span class="built_in">unordered_map</span> &lt; <span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">bool</span> &gt; isblocked;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isin</span><span class="params">(<span class="built_in">unordered_map</span> &lt; <span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">bool</span> &gt; &amp;m, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> key = x * (<span class="keyword">long</span> <span class="keyword">long</span>)N + y;</span><br><span class="line">        <span class="keyword">return</span> m.find(key) != m.end();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="built_in">unordered_map</span> &lt; <span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">bool</span> &gt; &amp;m, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> key = x * (<span class="keyword">long</span> <span class="keyword">long</span>)N + y;</span><br><span class="line">        m[key] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mapdo</span><span class="params">(<span class="built_in">unordered_map</span> &lt; <span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">bool</span> &gt; &amp;m)</span> </span>&#123;</span><br><span class="line">        m.reserve(<span class="number">1024</span>);</span><br><span class="line">        m.max_load_factor(<span class="number">0.25</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> tx, <span class="keyword">int</span> ty)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span> &lt; pair &lt; <span class="keyword">int</span>, <span class="keyword">int</span> &gt; &gt; q;</span><br><span class="line">        <span class="built_in">unordered_map</span> &lt; <span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">bool</span> &gt; vis;</span><br><span class="line">        mapdo(vis);</span><br><span class="line">        q.push(&#123;x, y&#125;);</span><br><span class="line">        insert(vis, x, y);</span><br><span class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> n = q.size();</span><br><span class="line">            <span class="keyword">if</span> (n &gt; B) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">                <span class="keyword">auto</span> u = q.front();</span><br><span class="line">                q.pop();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = u.first + dx[i];</span><br><span class="line">                    <span class="keyword">int</span> y = u.second + dy[i];</span><br><span class="line">                    <span class="keyword">if</span> (x == tx &amp;&amp; y == ty) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">if</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; N &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; N &amp;&amp; !isin(isblocked, x, y)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!isin(vis, x, y)) &#123;</span><br><span class="line">                            q.push(&#123;x, y&#125;);</span><br><span class="line">                            insert(vis, x, y);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isEscapePossible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; blocked, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; source, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; target)</span> </span>&#123;</span><br><span class="line">        mapdo(isblocked);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> v : blocked) insert(isblocked, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">        B = blocked.size();</span><br><span class="line">        <span class="keyword">int</span> b = bfs(source[<span class="number">0</span>], source[<span class="number">1</span>], target[<span class="number">0</span>], target[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        b = bfs(target[<span class="number">0</span>], target[<span class="number">1</span>], source[<span class="number">0</span>], source[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-bfs"><a class="header-anchor" href="#法三-bfs">¶</a>法三 bfs</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isEscapePossible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; blocked, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; s, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; t)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_set</span>&lt;<span class="keyword">long</span>&gt; blocks;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; b : blocked) &#123;</span><br><span class="line">            blocks.insert(b[<span class="number">0</span>] * <span class="number">1e6</span> + b[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> escape(s, t, blocks) &amp;&amp; escape(t, s, blocks);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dirs = &#123;&#123;<span class="number">-1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, <span class="number">-1</span>&#125;, &#123;<span class="number">0</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">escape</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; s, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; t, <span class="built_in">unordered_set</span>&lt;<span class="keyword">long</span>&gt;&amp; block)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">        q.push(s);</span><br><span class="line">        <span class="built_in">unordered_set</span>&lt;<span class="keyword">long</span>&gt; visited;</span><br><span class="line">        visited.insert(s[<span class="number">0</span>] * <span class="number">1e6</span> + s[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">int</span> step = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> visited_pixel = <span class="number">0</span>; <span class="comment">// </span></span><br><span class="line">        <span class="keyword">while</span> (!q.empty() &amp;&amp; q.size() &lt;= block.size() &amp;&amp; step &lt; <span class="number">200</span>) &#123; <span class="comment">// 400 //q.size() &lt;= block.size() much faster, no need step.</span></span><br><span class="line">            <span class="keyword">int</span> k = q.size();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> a = q.front()[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">int</span> b = q.front()[<span class="number">1</span>]; <span class="comment">// faster than vector&lt;&gt;</span></span><br><span class="line">                q.pop();</span><br><span class="line">                visited_pixel++;</span><br><span class="line">                <span class="keyword">if</span> (visited_pixel &gt; <span class="number">19900</span>) <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// Faster</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; dir: dirs) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = a + dir[<span class="number">0</span>], y = b + dir[<span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">long</span> tmp = x * <span class="number">1e6</span> + y;</span><br><span class="line">                    <span class="keyword">if</span> (x &lt; <span class="number">0</span> || x &gt;= <span class="number">1000000</span> || y &lt; <span class="number">0</span> || y &gt;= <span class="number">1000000</span> || block.count(tmp) || visited.count(tmp)) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">if</span> (x == t[<span class="number">0</span>] &amp;&amp; y == t[<span class="number">1</span>]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    visited.insert(tmp);</span><br><span class="line">                    q.push(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&#123;x, y&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            step++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (q.empty()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// step &gt;= 400.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="另类解法-模拟法"><a class="header-anchor" href="#另类解法-模拟法">¶</a>另类解法（模拟法）</h6>
<p><a href="https://leetcode-cn.com/problems/escape-a-large-maze/solution/cong-zhang-ai-wu-dian-blockedru-shou-de-kuai-su-su/" target="_blank" rel="noopener">https://leetcode-cn.com/problems/escape-a-large-maze/solution/cong-zhang-ai-wu-dian-blockedru-shou-de-kuai-su-su/</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">int</span> x;</span><br><span class="line">        <span class="keyword">int</span> y;</span><br><span class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (<span class="keyword">const</span> Point&amp; right) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;x &lt; right.x)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;x == right.x)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>-&gt;y &lt; right.y;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Point(<span class="keyword">const</span> <span class="keyword">int</span> x,<span class="keyword">const</span> <span class="keyword">int</span> y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>-&gt;x = x;</span><br><span class="line">            <span class="keyword">this</span>-&gt;y = y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> x1,y1,x2,y2,minx,maxx,miny,maxy,l,r;</span><br><span class="line">    <span class="keyword">int</span> extidxx, extidxy;</span><br><span class="line">    <span class="built_in">set</span>&lt;Point&gt; pts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (x1,y1)            (x2,y2)</span></span><br><span class="line">    <span class="comment">// S--------  |          T</span></span><br><span class="line">    <span class="comment">//         |  |          |</span></span><br><span class="line">    <span class="comment">//         |  |          |</span></span><br><span class="line">    <span class="comment">//         T  | S---------</span></span><br><span class="line">    <span class="comment">//     (x2,y2)  (x1,y1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> INPATH(x,y) (((x) == (x2) &amp;&amp; (y) <span class="meta-string">&lt;= maxy &amp;&amp; (y) &gt;= miny) || ((y) == (y1) &amp;&amp; (x) &gt;= minx &amp;&amp; (x) &lt;= maxx))</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> AREA(x,y) (((x) &gt; maxx) || ((y2 &gt; y1)? ((y) <span class="meta-string">&lt; miny) : ((y) &gt; maxy)))</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> INBOARD(x,y) ((x) &gt;= l &amp;&amp; (x) <span class="meta-string">&lt;= r &amp;&amp; (y) &gt;= l &amp;&amp; (y) &lt;= r)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateExt</span><span class="params">(<span class="keyword">const</span> Point&amp; pt)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        extidxx = max(pt.x, extidxx);</span><br><span class="line">        <span class="keyword">if</span>(y2 &lt; y1) extidxy = min(pt.y, extidxy);</span><br><span class="line">        <span class="keyword">else</span> extidxy = max(pt.y, extidxy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">notSearched</span><span class="params">(<span class="keyword">const</span> Point&amp; pt)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(pt.x &gt; extidxx)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(y2 &lt; y1 &amp;&amp; pt.y &lt; extidxy)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(y2 &gt; y1 &amp;&amp; pt.y &gt; extidxy)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> SEARCHRES</span><br><span class="line">    &#123;</span><br><span class="line">        LOCKED = <span class="number">0</span>,</span><br><span class="line">        UNLOCKED = <span class="number">1</span>,</span><br><span class="line">        REACHEDGE = <span class="number">2</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function">SEARCHRES <span class="title">search</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        Point cpt, <span class="comment">// 搜索起始点</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> rotate, <span class="comment">// 旋转方向</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> lastarea, <span class="comment">// 第一次搜索时应为 0, 第二次为 outarea</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> &amp; crosses, <span class="comment">// 穿越数, 初始化值为 0</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> &amp; outarea <span class="comment">// 首次穿出的区域, 初始化值为 0</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> xoffs[] = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> yoffs[] = &#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> oppomove[] = &#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line">        Point firstpt = cpt;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 搜索起始方向, 当 y == y1 时应为 6(←), 否则若 y2 &lt; y1 应为 0(↓); 若 y2 &gt; y1 应为 4(↑).</span></span><br><span class="line">        <span class="keyword">int</span> currmove = (cpt.y == y1) ? <span class="number">6</span> : ((y2 &lt; y1)? <span class="number">0</span> : <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 上次搜索的点是否在线内</span></span><br><span class="line">        <span class="keyword">bool</span> lastIn = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(;;)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 找到搜索起始方向 = 前一个方向的对向</span></span><br><span class="line">            <span class="keyword">bool</span> foundNew = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 八联通方向搜索(四联通移动,八联通即可封锁)</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                currmove += rotate;</span><br><span class="line">                <span class="keyword">if</span>(currmove &gt;= <span class="number">8</span>)</span><br><span class="line">                    currmove -= <span class="number">8</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(currmove &lt;= <span class="number">0</span>)</span><br><span class="line">                    currmove += <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">                <span class="function">Point <span class="title">npt</span><span class="params">(cpt.x + xoffs[currmove], cpt.y + yoffs[currmove])</span></span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(npt.x == firstpt.x &amp;&amp; npt.y == firstpt.y)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 返回了初始点，绕了回来</span></span><br><span class="line">                    <span class="comment">// 如果出的方向与进的方向不同, 则算作一次穿越</span></span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">abs</span>(lastarea - outarea) == <span class="number">2</span>)</span><br><span class="line">                        crosses += <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span>((crosses &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="comment">// 偶数次, 没包起来</span></span><br><span class="line">                        <span class="keyword">return</span> UNLOCKED;</span><br><span class="line">                    <span class="keyword">else</span> <span class="comment">// 奇数次, 把原点 or 目标点 包了起来</span></span><br><span class="line">                        <span class="keyword">return</span> LOCKED;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(!INBOARD(npt.x,npt.y))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">int</span> currArea = AREA(npt.x,npt.y) ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">abs</span>(lastarea - currArea) == <span class="number">2</span> &amp;&amp; lastIn)</span><br><span class="line">                        crosses += <span class="number">1</span>; <span class="comment">// 两次在不同半区且经过原始路线算作穿越</span></span><br><span class="line">                    lastarea = currArea;</span><br><span class="line">                    <span class="keyword">if</span>(outarea == <span class="number">0</span>)</span><br><span class="line">                        outarea = currArea;</span><br><span class="line">                    lastIn = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span> REACHEDGE;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">set</span>&lt;Point&gt;::iterator it = pts.find(npt);</span><br><span class="line">                    <span class="keyword">if</span>(it != pts.end())</span><br><span class="line">                    &#123;</span><br><span class="line">                        foundNew = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>((!INPATH(it-&gt;x,it-&gt;y)))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">int</span> currArea = AREA(it-&gt;x,it-&gt;y) ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="built_in">abs</span>(currArea - lastarea) == <span class="number">2</span> &amp;&amp; lastIn)</span><br><span class="line">                                crosses += <span class="number">1</span>; <span class="comment">// 两次在不同半区且经过原始路线算作穿越</span></span><br><span class="line">                            lastarea = currArea;  </span><br><span class="line">                            <span class="keyword">if</span>(outarea == <span class="number">0</span>)</span><br><span class="line">                                outarea = currArea;</span><br><span class="line">                            lastIn = <span class="literal">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            lastIn = <span class="literal">true</span>;</span><br><span class="line">                            updateExt(npt);</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        cpt = *it;</span><br><span class="line">                        currmove = oppomove[currmove] + rotate;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!foundNew)</span><br><span class="line">                <span class="keyword">return</span> UNLOCKED; <span class="comment">// 孤点, 不能起到封锁作用</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isEscapePossible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; blocked, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; source, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; target)</span> </span>&#123;</span><br><span class="line">        l = <span class="number">0</span>, r = <span class="number">1e6</span> - <span class="number">1</span>;</span><br><span class="line">        x1 = source[<span class="number">0</span>], y1 = source[<span class="number">1</span>], x2 = target[<span class="number">0</span>], y2 = target[<span class="number">1</span>];</span><br><span class="line">        minx = min(x1,x2), maxx = max(x1,x2), miny = min(y1,y2), maxy = max(y1,y2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(x2 &lt; x1)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 交换 source 和 target</span></span><br><span class="line">            <span class="keyword">int</span> tmp = x1; x1 = x2; x2 = tmp;</span><br><span class="line">            tmp = y1; y1 = y2; y2 = tmp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        extidxx = x1, extidxy = y1;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>-&gt;pts.clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; b :blocked)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(pts.find(Point(b[<span class="number">0</span>],b[<span class="number">1</span>])) == pts.end())</span><br><span class="line">                pts.insert(Point(b[<span class="number">0</span>],b[<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">set</span>&lt;Point&gt;::iterator it = pts.begin();</span><br><span class="line">        <span class="built_in">set</span>&lt;Point&gt;::reverse_iterator rit = pts.rbegin();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(;;)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 在初始路径上找到起始点</span></span><br><span class="line">            <span class="function">Point <span class="title">cpt</span><span class="params">(<span class="number">0</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 当 y2 &lt; y1 且 x 走到 x2 时, y 应当沿着 y减小 的方向走</span></span><br><span class="line">            <span class="keyword">if</span>(extidxx == x2 &amp;&amp; y2 &lt; y1)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(;; ++rit)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(rit == pts.rend())</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span>(INPATH(rit-&gt;x, rit-&gt;y) &amp;&amp; notSearched(*rit))</span><br><span class="line">                    &#123;</span><br><span class="line">                        updateExt(*rit);</span><br><span class="line">                        cpt = *rit;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="comment">// 否则应沿着 x 增大 或 y 增大 的方向走</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(;; ++it)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(it == pts.end())</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span>(INPATH(it-&gt;x, it-&gt;y) &amp;&amp; notSearched(*it))</span><br><span class="line">                    &#123;</span><br><span class="line">                        updateExt(*it);</span><br><span class="line">                        cpt = *it;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> crosses = <span class="number">0</span>, outarea = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 正向搜索</span></span><br><span class="line">            SEARCHRES res = search(cpt,<span class="number">1</span>,<span class="number">0</span>,crosses,outarea);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(res == UNLOCKED)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(res == LOCKED)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//REACHEDGE,则再进行反向搜索</span></span><br><span class="line">            res = search(cpt,<span class="number">-1</span>,outarea,crosses,t);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(res == UNLOCKED)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(res == LOCKED)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(crosses &amp; <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/18/871-Minimum-Number-of-Refueling-Stops/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/18/871-Minimum-Number-of-Refueling-Stops/" itemprop="url">871. Minimum Number of Refueling Stops</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-18T22:01:00+08:00">2020-02-18</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-19T14:30:03+08:00">2020-02-19</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="871-minimum-number-of-refueling-stops"><a class="header-anchor" href="#871-minimum-number-of-refueling-stops">¶</a><a href="https://leetcode.com/problems/minimum-number-of-refueling-stops/" target="_blank" rel="noopener">871. Minimum Number of Refueling Stops</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>A car travels from a starting position to a destination which is <code>target</code> miles east of the starting position.</p>
<p>Along the way, there are gas stations.  Each <code>station[i]</code> represents a gas station that is <code>station[i][0]</code> miles east of the starting position, and has <code>station[i][1]</code> liters of gas.</p>
<p>The car starts with an infinite tank of gas, which initially has <code>startFuel</code> liters of fuel in it.  It uses 1 liter of gas per 1 mile that it drives.</p>
<p>When the car reaches a gas station, it may stop and refuel, transferring all the gas from the station into the car.</p>
<p>What is the least number of refueling stops the car must make in order to reach its destination?  If it cannot reach the destination, return <code>-1</code>.</p>
<p>Note that if the car reaches a gas station with 0 fuel left, the car can still refuel there.  If the car reaches the destination with 0 fuel left, it is still considered to have arrived.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: target = 1, startFuel = 1, stations = []</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: We can reach the target without refueling.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: target = 100, startFuel = 1, stations = [[10,100]]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: We can&apos;t reach the target (or even the first gas station).</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Input: target = 100, startFuel = 10, stations = [[10,60],[20,30],[30,30],[60,40]]</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: </span><br><span class="line">We start with 10 liters of fuel.</span><br><span class="line">We drive to position 10, expending 10 liters of fuel.  We refuel from 0 liters to 60 liters of gas.</span><br><span class="line">Then, we drive from position 10 to position 60 (expending 50 liters of fuel),</span><br><span class="line">and refuel from 10 liters to 50 liters of gas.  We then drive to and reach the target.</span><br><span class="line">We made 2 refueling stops along the way, so we return 2.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= target, startFuel, stations[i][1] &lt;= 10^9</code></li>
<li><code>0 &lt;= stations.length &lt;= 500</code></li>
<li><code>0 &lt; stations[0][0] &lt; stations[1][0] &lt; ... &lt; stations[stations.length-1][0] &lt; target</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-贪心-堆"><a class="header-anchor" href="#法一-贪心-堆">¶</a>法一 贪心 + 堆</h6>
<p>  POJ2431也有这道题，解法很巧妙。下面是书中的解释：“在车开往加油站的途中只有加油站才可以加油，但是如果认为，到达加油站<code>stations[i]</code>就获得一次在以后任何时候都能加油<code>stations[i][1]</code>的机会”，而在之后需要加油，就认为是之前经过的加油站加的油即可。因为加油次数要尽可能少，所以可以当燃料为0时再加油。燃料为0时，显然要用油量最大的那个加油站加油。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minRefuelStops</span><span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> startFuel, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; stations)</span> </span>&#123;</span><br><span class="line">        priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        stations.push_back(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&#123;target, <span class="number">0</span>&#125;);</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, tank = startFuel, ans = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; stations.size())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!q.empty()&amp;&amp;stations[i][<span class="number">0</span>] - pos &gt; tank)&#123; tank += q.top();++ans;q.pop();&#125;</span><br><span class="line">            <span class="keyword">if</span>(stations[i][<span class="number">0</span>] - pos &gt; tank) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            tank -= stations[i][<span class="number">0</span>] - pos;</span><br><span class="line">            q.push(stations[i][<span class="number">1</span>]);</span><br><span class="line">            pos = stations[i][<span class="number">0</span>];</span><br><span class="line">            ++i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-dp"><a class="header-anchor" href="#法二-dp">¶</a>法二 dp</h6>
<p>  <code>dp[i]</code>代表加i次油能行驶的最远距离。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minRefuelStops</span><span class="params">(<span class="keyword">int</span> target, <span class="keyword">int</span> startFuel, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; stations)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> dp[stations.size()+<span class="number">1</span>]&#123;&#125;;</span><br><span class="line">        dp[<span class="number">0</span>] = startFuel;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stations.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &gt;= <span class="number">0</span>; --j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[j] &gt;= stations[i][<span class="number">0</span>])</span><br><span class="line">                    dp[j+<span class="number">1</span>] = max(dp[j+<span class="number">1</span>], dp[j] + (<span class="keyword">long</span>)stations[i][<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;=stations.size(); ++i)</span><br><span class="line">            <span class="keyword">if</span>(dp[i] &gt;= target) <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a class="header-anchor" href="#总结">¶</a>总结</h3>
<p>以后遇到求某个量K的最少次数，可以通过反过来求K（加油次数）固定时K对应的另外的量（距离）的最大值反推。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/18/857-Minimum-Cost-to-Hire-K-Workers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/18/857-Minimum-Cost-to-Hire-K-Workers/" itemprop="url">857. Minimum Cost to Hire K Workers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-18T19:13:00+08:00">2020-02-18</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-18T19:17:16+08:00">2020-02-18</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="857-minimum-cost-to-hire-k-workers"><a class="header-anchor" href="#857-minimum-cost-to-hire-k-workers">¶</a><a href="https://leetcode.com/problems/minimum-cost-to-hire-k-workers/" target="_blank" rel="noopener">857. Minimum Cost to Hire K Workers</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>There are <code>N</code> workers.  The <code>i</code>-th worker has a <code>quality[i]</code> and a minimum wage expectation <code>wage[i]</code>.</p>
<p>Now we want to hire exactly <code>K</code> workers to form a <em>paid group</em>.  When hiring a group of K workers, we must pay them according to the following rules:</p>
<ol>
<li>Every worker in the paid group should be paid in the ratio of their quality compared to other workers in the paid group.</li>
<li>Every worker in the paid group must be paid at least their minimum wage expectation.</li>
</ol>
<p>Return the least amount of money needed to form a paid group satisfying the above conditions.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: quality = [10,20,5], wage = [70,50,30], K = 2</span><br><span class="line">Output: 105.00000</span><br><span class="line">Explanation: We pay 70 to 0-th worker and 35 to 2-th worker.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: quality = [3,1,10,10,1], wage = [4,8,2,2,7], K = 3</span><br><span class="line">Output: 30.66667</span><br><span class="line">Explanation: We pay 4 to 0-th worker, 13.33333 to 2-th and 3-th workers seperately.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= K &lt;= N &lt;= 10000</code>, where <code>N = quality.length = wage.length</code></li>
<li><code>1 &lt;= quality[i] &lt;= 10000</code></li>
<li><code>1 &lt;= wage[i] &lt;= 10000</code></li>
<li>Answers within <code>10^-5</code> of the correct answer will be considered correct.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  按照w/q比值排序，一个组中会按w/q最大的人的这个比例来发工资，所以用堆来维护最小的K个quality的和。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">mincostToHireWorkers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;quality, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;wage, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt;&gt; workers(quality.size());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; workers.size(); ++i)</span><br><span class="line">            workers[i] = make_pair(quality[i], <span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(wage[i]) / quality[i]);</span><br><span class="line">        sort(workers.begin(), workers.end(), [](<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt; &amp;lhs, <span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt; &amp;rhs) &#123;</span><br><span class="line">            <span class="keyword">return</span> lhs.second &lt; rhs.second;</span><br><span class="line">        &#125;);</span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt;&gt; group(less&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt;&gt;(), <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt;&gt;(workers.begin(), workers.begin() + K));</span><br><span class="line">        <span class="keyword">int</span> heapsum = accumulate(workers.begin(), workers.begin() + K, <span class="number">0</span>, [](<span class="keyword">const</span> <span class="keyword">int</span> &amp;lhs, <span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt; &amp;rhs) &#123;</span><br><span class="line">            <span class="keyword">return</span> lhs + rhs.first;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">double</span> current = heapsum * workers[K - <span class="number">1</span>].second;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = K; i &lt; workers.size(); ++i) &#123;</span><br><span class="line">            heapsum += workers[i].first - group.top().first;</span><br><span class="line">            group.pop();</span><br><span class="line">            group.emplace(workers[i]);</span><br><span class="line">            current = min(current, heapsum * workers[i].second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> current;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>第二种代码风格好一些:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">mincostToHireWorkers</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; quality, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; wage, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=quality.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">double</span>,<span class="keyword">int</span>&gt;&gt; vec;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            vec.push_back(make_pair(wage[i]*<span class="number">1.0</span>/quality[i],quality[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        sort(vec.begin(),vec.end(),[](<span class="keyword">auto</span>&amp; a,<span class="keyword">auto</span>&amp; b)&#123;</span><br><span class="line">            <span class="keyword">return</span> a.first&lt;b.first;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">int</span> q_count=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> res;</span><br><span class="line">        priority_queue&lt;<span class="keyword">int</span>&gt; pq;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;K;i++)&#123;</span><br><span class="line">            q_count+=vec[i].second;</span><br><span class="line">            pq.push(vec[i].second);</span><br><span class="line">        &#125;</span><br><span class="line">        res=vec[K<span class="number">-1</span>].first*q_count;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=K;i&lt;n;i++)&#123;</span><br><span class="line">            q_count+=vec[i].second;</span><br><span class="line">            q_count-=pq.top();</span><br><span class="line">            pq.pop();</span><br><span class="line">            pq.push(vec[i].second);</span><br><span class="line">            res=min(res,q_count*vec[i].first);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/18/843-Guess-the-Word/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/18/843-Guess-the-Word/" itemprop="url">843. Guess the Word</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-18T15:26:00+08:00">2020-02-18</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-18T15:31:32+08:00">2020-02-18</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="843-guess-the-word"><a class="header-anchor" href="#843-guess-the-word">¶</a><a href="https://leetcode.com/problems/guess-the-word/" target="_blank" rel="noopener">843. Guess the Word</a></h3>
<p>Difficulty: <strong>Hard</strong></p>
<p>This problem is an <strong><em>interactive problem</em></strong> new to the LeetCode platform.</p>
<p>We are given a word list of unique words, each word is 6 letters long, and one word in this list is chosen as <strong>secret</strong>.</p>
<p>You may call <code>master.guess(word)</code> to guess a word.  The guessed word should have type <code>string</code> and must be from the original list with 6 lowercase letters.</p>
<p>This function returns an <code>integer</code> type, representing the number of exact matches (value and position) of your guess to the <strong>secret word</strong>.  Also, if your guess is not in the given wordlist, it will return <code>-1</code> instead.</p>
<p>For each test case, you have 10 guesses to guess the word. At the end of any number of calls, if you have made 10 or less calls to <code>master.guess</code> and at least one of these guesses was the <strong>secret</strong>, you pass the testcase.</p>
<p>Besides the example test case below, there will be 5 additional test cases, each with 100 words in the word list.  The letters of each word in those testcases were chosen independently at random from <code>'a'</code> to <code>'z'</code>, such that every word in the given word lists is unique.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Example 1:</span><br><span class="line">Input: secret = &quot;acckzz&quot;, wordlist = [&quot;acckzz&quot;,&quot;ccbazz&quot;,&quot;eiowzz&quot;,&quot;abcczz&quot;]</span><br><span class="line"></span><br><span class="line">Explanation:</span><br><span class="line"></span><br><span class="line">master.guess(&quot;aaaaaa&quot;) returns -1, because &quot;aaaaaa&quot; is not in wordlist.</span><br><span class="line">master.guess(&quot;acckzz&quot;) returns 6, because &quot;acckzz&quot; is secret and has all 6 matches.</span><br><span class="line">master.guess(&quot;ccbazz&quot;) returns 3, because &quot;ccbazz&quot; has 3 matches.</span><br><span class="line">master.guess(&quot;eiowzz&quot;) returns 2, because &quot;eiowzz&quot; has 2 matches.</span><br><span class="line">master.guess(&quot;abcczz&quot;) returns 4, because &quot;abcczz&quot; has 4 matches.</span><br><span class="line"></span><br><span class="line">We made 5 calls to master.guess and one of them was the secret, so we pass the test case.</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong>  Any solutions that attempt to circumvent the judge will result in disqualification.</p>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>下面的解法都来自讨论区的帖子:<a href="https://leetcode.com/problems/guess-the-word/discuss/133862/Random-Guess-and-Minimax-Guess-with-Comparison%E3%80%82%E9%87%8C%E9%9D%A2%E7%9A%84%E8%A7%A3%E9%87%8A%E9%9D%9E%E5%B8%B8%E8%AF%A6%E7%BB%86%E3%80%82" target="_blank" rel="noopener">https://leetcode.com/problems/guess-the-word/discuss/133862/Random-Guess-and-Minimax-Guess-with-Comparison。里面的解释非常详细。</a></p>
<h6 id="法一-洗牌"><a class="header-anchor" href="#法一-洗牌">¶</a>法一 洗牌</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findSecretWord</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; wordlist, Master&amp; master)</span> </span>&#123;</span><br><span class="line">        random_shuffle(wordlist.begin(), wordlist.end());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x = <span class="number">0</span>; i &lt; <span class="number">10</span> &amp;&amp; x &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">            <span class="built_in">string</span> guess = wordlist[<span class="number">0</span>];</span><br><span class="line">            x = master.guess(guess);</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; wordlist2;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">if</span> (match(guess, w) == x)</span><br><span class="line">                    wordlist2.push_back(w);</span><br><span class="line">            wordlist = wordlist2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">match</span><span class="params">(<span class="built_in">string</span> a, <span class="built_in">string</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] == b[i])</span><br><span class="line">                matches ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-随机选"><a class="header-anchor" href="#法二-随机选">¶</a>法二 随机选</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findSecretWord</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; wordlist, Master&amp; master)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x = <span class="number">0</span>; i &lt; <span class="number">10</span> &amp;&amp; x &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">            <span class="built_in">string</span> guess = wordlist[rand() % (wordlist.size())];</span><br><span class="line">            x = master.guess(guess);</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; wordlist2;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">if</span> (match(guess, w) == x)</span><br><span class="line">                    wordlist2.push_back(w);</span><br><span class="line">            wordlist = wordlist2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">match</span><span class="params">(<span class="built_in">string</span> a, <span class="built_in">string</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] == b[i])</span><br><span class="line">                matches ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-minimax"><a class="header-anchor" href="#法三-minimax">¶</a>法三 minimax</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findSecretWord</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; wordlist, Master&amp; master)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x = <span class="number">0</span>; i &lt; <span class="number">10</span> &amp;&amp; x &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">            <span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; count;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w1 : wordlist)</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">string</span> w2 : wordlist)</span><br><span class="line">                    <span class="keyword">if</span> (match(w1, w2) == <span class="number">0</span>)</span><br><span class="line">                        count[w1]++;</span><br><span class="line">            pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; minimax = &#123;wordlist[<span class="number">0</span>], <span class="number">1000</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">if</span> (count[w] &lt;= minimax.second)</span><br><span class="line">                    minimax = make_pair(w, count[w]);</span><br><span class="line">            x = master.guess(minimax.first);</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; wordlist2;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">if</span> (match(minimax.first, w) == x)</span><br><span class="line">                    wordlist2.push_back(w);</span><br><span class="line">            wordlist = wordlist2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">match</span><span class="params">(<span class="built_in">string</span> a, <span class="built_in">string</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] == b[i])</span><br><span class="line">                matches ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法四-根据相似性"><a class="header-anchor" href="#法四-根据相似性">¶</a>法四 根据相似性</h6>
<p>  根据每个位置哪个字母的出现次数最多，然后给每个字符串打分，选分最高的那个。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findSecretWord</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; wordlist, Master&amp; master)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count[<span class="number">6</span>][<span class="number">26</span>], x = <span class="number">0</span>, best;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt; <span class="number">10</span> &amp;&amp; x &lt; <span class="number">6</span>; ++t) &#123;</span><br><span class="line">            <span class="built_in">memset</span>(count, <span class="number">0</span>, <span class="number">156</span> * <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">                    count[i][w[i] - <span class="string">'a'</span>]++;</span><br><span class="line">            best = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">string</span> guess = wordlist[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w: wordlist) &#123;</span><br><span class="line">                <span class="keyword">int</span> score = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">                    score += count[i][w[i] - <span class="string">'a'</span>];</span><br><span class="line">                <span class="keyword">if</span> (score &gt; best) &#123;</span><br><span class="line">                    guess = w;</span><br><span class="line">                    best = score;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            x = master.guess(guess);</span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; wordlist2;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">string</span> w : wordlist)</span><br><span class="line">                <span class="keyword">if</span> (match(guess, w) == x)</span><br><span class="line">                    wordlist2.push_back(w);</span><br><span class="line">            wordlist = wordlist2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">match</span><span class="params">(<span class="built_in">string</span> a, <span class="built_in">string</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> matches = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] == b[i])</span><br><span class="line">                matches ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/18/979-Distribute-Coins-in-Binary-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/18/979-Distribute-Coins-in-Binary-Tree/" itemprop="url">979. Distribute Coins in Binary Tree</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-18T01:02:44+08:00">2020-02-18</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-18T01:15:29+08:00">2020-02-18</time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="979-distribute-coins-in-binary-tree"><a class="header-anchor" href="#979-distribute-coins-in-binary-tree">¶</a><a href="https://leetcode.com/problems/distribute-coins-in-binary-tree/" target="_blank" rel="noopener">979. Distribute Coins in Binary Tree</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given the <code>root</code> of a binary tree with <code>N</code> nodes, each <code>node</code> in the tree has <code>node.val</code> coins, and there are <code>N</code> coins total.</p>
<p>In one move, we may choose two adjacent nodes and move one coin from one node to another.  (The move may be from parent to child, or from child to parent.)</p>
<p>Return the number of moves required to make every node have exactly one coin.</p>
<p><strong>Example 1:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/01/18/tree1.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [3,0,0]</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: From the root of the tree, we move one coin to its left child, and one coin to its right child.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/01/18/tree2.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [0,3,0]</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: From the left child of the root, we move two coins to the root [taking two moves].  Then, we move one coin from the root of the tree to the right child.</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/01/18/tree3.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,0,2]</span><br><span class="line">Output: 2</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2019/01/18/tree4.png" alt></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,0,0,null,3]</span><br><span class="line">Output: 4</span><br></pre></td></tr></table></figure>
<p><strong><span style="display: inline;">Note:</span></strong></p>
<ol>
<li><code>1&lt;= N &lt;= 100</code></li>
<li><code>0 &lt;= node.val &lt;= N</code></li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  这道题的思路十分巧妙。因为有的子树会有超过它容量的硬币，而有的子树又会有少于它容量的硬币，超过的硬币需要传到根节点，而不够的硬币需要从根节点传下来。而dfs的特点是从根到叶子，是单向的，这就有点难办了。联想到盈亏和正负的关系，如果可以用负硬币来表示硬币的话就好办了，那么所有子树都可以看做拥有超过容量的硬币，把多余的硬币上传，这个多余的硬币可以是负数（比如叶子结点没有硬币时，往上传递-1个硬币，对应1次移动）。负数既可以解释成向上传递负数个硬币，也可以解释成需要向下传递正数个硬币（这个传递的硬币数即对应移动次数）。就好像接力，当正负抵消的时候即是接力完成的时候。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(TreeNode *root, <span class="keyword">int</span> &amp;ans)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> l = dfs(root-&gt;left, ans), r = dfs(root-&gt;right, ans), ret = (l+r+root-&gt;val) - <span class="number">1</span>;</span><br><span class="line">        ans += <span class="built_in">abs</span>(ret);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">distributeCoins</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        dfs(root, ans);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>官方标解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">distributeCoins</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        dfs(root);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dfs</span><span class="params">(TreeNode node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> L = dfs(node.left);</span><br><span class="line">        <span class="keyword">int</span> R = dfs(node.right);</span><br><span class="line">        ans += Math.abs(L) + Math.abs(R);</span><br><span class="line">        <span class="keyword">return</span> node.val + L + R - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自己做出来就是舒畅啊，虽然花了不少时间，但是思考的乐趣就在于问题解决的那一刻。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/18/939-Minimum-Area-Rectangle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/18/939-Minimum-Area-Rectangle/" itemprop="url">939. Minimum Area Rectangle</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-18T00:13:00+08:00">2020-02-18</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-18T00:20:18+08:00">2020-02-18</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="939-minimum-area-rectangle"><a class="header-anchor" href="#939-minimum-area-rectangle">¶</a><a href="https://leetcode.com/problems/minimum-area-rectangle/" target="_blank" rel="noopener">939. Minimum Area Rectangle</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Given a set of points in the xy-plane, determine the minimum area of a rectangle formed from these points, with sides parallel to the x and y axes.</p>
<p>If there isn’t any rectangle, return 0.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [[1,1],[1,3],[3,1],[3,3],[2,2]]</span><br><span class="line">Output: 4</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: [[1,1],[1,3],[3,1],[3,3],[4,1],[4,3]]</span><br><span class="line">Output: 2</span><br></pre></td></tr></table></figure>
<p><strong>Note</strong>:</p>
<ol>
<li><code>1 &lt;= points.length &lt;= 500</code></li>
<li><code>0 &lt;= points[i][0] &lt;= 40000</code></li>
<li><code>0 &lt;= points[i][1] &lt;= 40000</code></li>
<li>All points are distinct.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<h6 id="法一-按列收集"><a class="header-anchor" href="#法一-按列收集">¶</a>法一 按列收集</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minAreaRect</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; points)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : points) s.insert(x[<span class="number">0</span>]*<span class="number">40001</span>+x[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">int</span> ans = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; points.size(); ++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = points[i][<span class="number">0</span>], b = points[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; points.size(); ++j)&#123;</span><br><span class="line">                <span class="keyword">int</span> c = points[j][<span class="number">0</span>], d = points[j][<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span>(a != c &amp;&amp; b != d &amp;&amp; s.count(a*<span class="number">40001</span>+d) &amp;&amp; s.count(c*<span class="number">40001</span>+b))&#123;</span><br><span class="line">                    ans = min(ans, <span class="built_in">abs</span>((a-c)*(d-b)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans  == INT_MAX ? <span class="number">0</span>: ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法二-遍历对角线"><a class="header-anchor" href="#法二-遍历对角线">¶</a>法二 遍历对角线</h6>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minAreaRect</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; points)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; m1;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; m2;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : points) m1[x[<span class="number">1</span>]].push_back(x[<span class="number">0</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> ans = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;p : m1)&#123;</span><br><span class="line">            <span class="keyword">int</span> y = p.first;</span><br><span class="line">            <span class="keyword">auto</span> &amp;r = p.second;</span><br><span class="line">            sort(r.begin(), r.end());</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.size(); ++i)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; r.size(); ++j)&#123;</span><br><span class="line">                    <span class="keyword">int</span> code = r[i]*<span class="number">40001</span>+r[j];</span><br><span class="line">                    <span class="keyword">if</span>(m2.count(code)) ans = min(ans, (y - m2[code]) * (r[j] - r[i]));</span><br><span class="line">                    m2[code] = y;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans == INT_MAX?<span class="number">0</span>:ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h6 id="法三-双指针"><a class="header-anchor" href="#法三-双指针">¶</a>法三 双指针</h6>
<p>  按列收集然后把每列上的的点排好序后，对两个列计算最小的矩形。因为要求矩形最小，所以两个公共的y应该尽可能的靠近，又因为每个列中的y都是有序的，所以可以把所有相同的y用双指针法按顺序一个个找出来，而且都是最靠近的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minAreaRect</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; points)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;p : points) m[p[<span class="number">0</span>]].push_back(p[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : m) sort(x.second.begin(), x.second.end());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> result = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> x=m.begin(); x != m.end(); x++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x-&gt;second.size()==<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> y=next(x); y != m.end(); y++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (y-&gt;second.size() == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">int</span> i=<span class="number">0</span>, j=<span class="number">0</span>, last=<span class="number">-1</span>, len1=x-&gt;second.size(), len2=y-&gt;second.size();</span><br><span class="line">                <span class="keyword">while</span> (i&lt;len1 &amp;&amp; j&lt;len2) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (x-&gt;second[i] &lt; y-&gt;second[j]) i++;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (x-&gt;second[i] &gt; y-&gt;second[j]) j++;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (last&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">int</span> t = <span class="built_in">abs</span>(y-&gt;first - x-&gt;first) * (x-&gt;second[i]-last);</span><br><span class="line">                            result = min(result, t);</span><br><span class="line">                        &#125;</span><br><span class="line">                        last = x-&gt;second[i++], j++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result == INT_MAX ? <span class="number">0</span> : result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>详细注释版:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="comment">// Find two diagonal points:  time O(n^2)</span></span><br><span class="line">    <span class="comment">//      1) pair all points with each other</span></span><br><span class="line">    <span class="comment">//      2) skip all vertical (x1 == x2) and horizatal lines (y1 == y2)</span></span><br><span class="line">    <span class="comment">//      3) skip if these diagonal points do not have other points to form a rectangle. for diagonal points (x1, y1) and (x2, y2), there shall be another points (x1, y2) and (x2, y1)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Hashmap and search vertical or horizatal lines:  time O(different x ^ 2 * different y sharing same x)</span></span><br><span class="line">    <span class="comment">//      1) store all points that share the same x together in sorted order</span></span><br><span class="line">    <span class="comment">//      2) pair all x coordinidates, x1 and x2.  for each x1 and x2 pair</span></span><br><span class="line">    <span class="comment">//          a) skip the x coordinates if the count of points sharing this x coordinates &lt; 2</span></span><br><span class="line">    <span class="comment">//          b) find a common y coordinate of both x1 and x2 with two pointers, mark it a poissble candidate</span></span><br><span class="line">    <span class="comment">//          c) if we have too candidates, check min area</span></span><br><span class="line">    <span class="comment">//          d) since y is sorted, the min area shall be the common y closest to each other</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minAreaRect</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; points)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Hashmap and search horizatal lines</span></span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; y_share_x;</span><br><span class="line">        <span class="keyword">int</span> min_area = INT_MAX;</span><br><span class="line">        <span class="comment">// 1)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;point:points)</span><br><span class="line">            y_share_x[point[<span class="number">0</span>]].push_back(point[<span class="number">1</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// sort the y coordinates</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;ys:y_share_x)</span><br><span class="line">            sort(ys.second.begin(), ys.second.end());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> it1 = y_share_x.begin(); it1 != y_share_x.end(); ++it1)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 2a)</span></span><br><span class="line">            <span class="keyword">if</span> (it1-&gt;second.size() &lt; <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">// try to find another x2 that share the two y coordinates with x1</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> it2 = next(it1); it2 != y_share_x.end(); ++it2)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 2a)</span></span><br><span class="line">                <span class="keyword">if</span> (it2-&gt;second.size() &lt; <span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="comment">// record the previously found y1</span></span><br><span class="line">                <span class="keyword">int</span> prev_found_y = <span class="number">-1</span>;</span><br><span class="line">                <span class="comment">// search common y with two pointers</span></span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span>(i &lt; it1-&gt;second.size() &amp;&amp; j &lt; it2-&gt;second.size())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// if found a common y</span></span><br><span class="line">                    <span class="keyword">if</span> (it1-&gt;second[i] == it2-&gt;second[j])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// check if this is the 2nd common y, if so a rectangel is formed</span></span><br><span class="line">                        <span class="keyword">if</span> (prev_found_y != <span class="number">-1</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            min_area = min(min_area, <span class="built_in">abs</span>(it1-&gt;first - it2-&gt;first) * <span class="built_in">abs</span>(it1-&gt;second[i] - prev_found_y));</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// update prev found y for the next common y</span></span><br><span class="line">                        prev_found_y = it1-&gt;second[i];</span><br><span class="line">                        <span class="comment">// advance two pointer since the min difference shall be the two ys close to each other</span></span><br><span class="line">                        ++i;</span><br><span class="line">                        ++j;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (it1-&gt;second[i] &lt; it2-&gt;second[j])</span><br><span class="line">                        ++i;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (it1-&gt;second[i] &gt; it2-&gt;second[j])</span><br><span class="line">                        ++j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> min_area == INT_MAX ? <span class="number">0</span> : min_area;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/17/1079-Letter-Tile-Possibilities/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/17/1079-Letter-Tile-Possibilities/" itemprop="url">1079. Letter Tile Possibilities</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-17T23:44:00+08:00">2020-02-17</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-17T23:54:56+08:00">2020-02-17</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1079-letter-tile-possibilities"><a class="header-anchor" href="#1079-letter-tile-possibilities">¶</a><a href="https://leetcode.com/problems/letter-tile-possibilities/" target="_blank" rel="noopener">1079. Letter Tile Possibilities</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>You have a set of <code>tiles</code>, where each tile has one letter <code>tiles[i]</code> printed on it.  Return the number of possible non-empty sequences of letters you can make.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;AAB&quot;</span><br><span class="line">Output: 8</span><br><span class="line">Explanation: The possible sequences are &quot;A&quot;, &quot;B&quot;, &quot;AA&quot;, &quot;AB&quot;, &quot;BA&quot;, &quot;AAB&quot;, &quot;ABA&quot;, &quot;BAA&quot;.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;AAABBC&quot;</span><br><span class="line">Output: 188</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= tiles.length &lt;= 7</code></li>
<li><code>tiles</code> consists of uppercase English letters.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>回溯法。回溯的时候可以不用把每个字符串都记录到一个unordered_set里，因为回溯的过程可以保证不会出现重复的字符串。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(<span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; &amp; m, <span class="keyword">int</span> &amp; cnt)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp; p : m) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="number">0</span> == p.second)<span class="keyword">continue</span>;</span><br><span class="line">            cnt ++;</span><br><span class="line">            p.second --;</span><br><span class="line">            visit(m, cnt);</span><br><span class="line">            p.second ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTilePossibilities</span><span class="params">(<span class="built_in">string</span> tiles)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; tile_map;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp; tile : tiles) &#123;</span><br><span class="line">            tile_map[tile] ++;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        visit(tile_map, count);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>另一种写法:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTilePossibilities</span><span class="params">(<span class="built_in">string</span> tiles)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; M;</span><br><span class="line">        <span class="keyword">int</span> n = tiles.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> ch : tiles)</span><br><span class="line">            M[ch]++;</span><br><span class="line">        <span class="keyword">return</span> dfs(M,n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt;&amp; M, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; p:M)&#123;</span><br><span class="line">            <span class="keyword">if</span> (p.second)&#123;</span><br><span class="line">                p.second--;</span><br><span class="line">                sum += (<span class="number">1</span>+dfs(M,n<span class="number">-1</span>));</span><br><span class="line">                p.second++; <span class="comment">//backtrack</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  我自己的解法如下。刚开始还用了一个set把所有形成的字符串插入进去，其实没必要。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> cnt ;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backtrack</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span> &amp;s, <span class="keyword">int</span> bm)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bm1=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; s.size(); ++i) <span class="keyword">if</span>(!(<span class="number">1</span>&lt;&lt;i&amp;bm) &amp;&amp; !(<span class="number">1</span>&lt;&lt;s[i]-<span class="string">'A'</span>&amp;bm1))&#123;</span><br><span class="line">            bm1 |= <span class="number">1</span>&lt;&lt;s[i]-<span class="string">'A'</span>;</span><br><span class="line">            cnt++;</span><br><span class="line">            backtrack(s, bm|<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTilePossibilities</span><span class="params">(<span class="built_in">string</span> tiles)</span> </span>&#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        backtrack(tiles, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/17/1081-Smallest-Subsequence-of-Distinct-Characters/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lidanyang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Just a blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/17/1081-Smallest-Subsequence-of-Distinct-Characters/" itemprop="url">1081. Smallest Subsequence of Distinct Characters</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-17T15:33:00+08:00">2020-02-17</time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-02-17T17:53:53+08:00">2020-02-17</time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/leetcode/" itemprop="url" rel="index">
                    <span itemprop="name">leetcode</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1081-smallest-subsequence-of-distinct-characters"><a class="header-anchor" href="#1081-smallest-subsequence-of-distinct-characters">¶</a><a href="https://leetcode.com/problems/smallest-subsequence-of-distinct-characters/" target="_blank" rel="noopener">1081. Smallest Subsequence of Distinct Characters</a></h3>
<p>Difficulty: <strong>Medium</strong></p>
<p>Return the lexicographically smallest subsequence of <code>text</code> that contains all the distinct characters of <code>text</code> exactly once.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;cdadabcc&quot;</span><br><span class="line">Output: &quot;adbc&quot;</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;abcd&quot;</span><br><span class="line">Output: &quot;abcd&quot;</span><br></pre></td></tr></table></figure>
<p><strong>Example 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;ecbacba&quot;</span><br><span class="line">Output: &quot;eacb&quot;</span><br></pre></td></tr></table></figure>
<p><strong>Example 4:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;leetcode&quot;</span><br><span class="line">Output: &quot;letcod&quot;</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong></p>
<ol>
<li><code>1 &lt;= text.length &lt;= 1000</code></li>
<li><code>text</code> consists of lowercase English letters.</li>
</ol>
<h4 id="solution"><a class="header-anchor" href="#solution">¶</a>Solution</h4>
<p>  官方给的提示:<code>Greedily try to add one missing character. How to check if adding some character will not cause problems ? Use bit-masks to check whether you will be able to complete the sub-sequence if you add the character at some index i.</code></p>
<p>  这道题要从前往后依次找能放的最小的字母，放完一个字母要保证剩下的还没放的字母后面还有。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countbits</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(n&amp;<span class="number">1</span>&lt;&lt;i) ++b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">smallestSubsequence</span><span class="params">(<span class="built_in">string</span> text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bm[text.size()]&#123;&#125;;</span><br><span class="line">        bm[text.size() - <span class="number">1</span>] = <span class="number">1</span>&lt;&lt;text.back()-<span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = text.size() <span class="number">-2</span>; i &gt;= <span class="number">0</span>; --i) bm[i] = bm[i+<span class="number">1</span>] | (<span class="number">1</span>&lt;&lt;text[i] - <span class="string">'a'</span>);</span><br><span class="line">        <span class="keyword">int</span> cnt = countbits(bm[<span class="number">0</span>]), cur = <span class="number">0</span>, ncur, b = bm[<span class="number">0</span>];<span class="comment">//b代表还需要哪些字母,cur代表搜索的起点</span></span><br><span class="line">        <span class="built_in">string</span> ans = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">char</span> c;</span><br><span class="line">        <span class="keyword">while</span>(cnt--)&#123;</span><br><span class="line">            c = <span class="string">'z'</span>+<span class="number">1</span>, ncur = <span class="number">-1</span>;<span class="comment">//ncur记录当前最小的字母</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = cur; i &lt; text.size(); ++i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(b&amp;<span class="number">1</span> &lt;&lt; text[i] - <span class="string">'a'</span>&amp;&amp;text[i]&lt;c&amp;&amp;!(~bm[i]&amp;b))&#123;<span class="comment">//!(~bm[i]&amp;b)检查剩下的字母是否能包含所有所需的字母，b&amp;1 &lt;&lt; text[i] - 'a'检查当前字母是否是所需要的</span></span><br><span class="line">                    c = text[i]; ncur = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += c;</span><br><span class="line">            b ^= (<span class="number">1</span>&lt;&lt;(c-<span class="string">'a'</span>));<span class="comment">//更新所需字母位图</span></span><br><span class="line">            cur = ncur+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lidanyang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">441</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lidanyang" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1261727840@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lidanyang</span>

  

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.0</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.0"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=6.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=6.0.0"></script>


  

</body>
</html>
